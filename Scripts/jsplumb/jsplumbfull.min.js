(function(){typeof Math.sgn=="undefined"&&(Math.sgn=function(n){return n==0?0:n>0?1:-1});var n={subtract:function(n,t){return{x:n.x-t.x,y:n.y-t.y}},dotProduct:function(n,t){return n.x*t.x+n.y*t.y},square:function(n){return Math.sqrt(n.x*n.x+n.y*n.y)},scale:function(n,t){return{x:n.x*t,y:n.y*t}}},e=64,l=Math.pow(2,-e-1),o=function(t,i){for(var f,h=[],a=v(t,i),c=i.length-1,y=2*c-1,p=r(a,y,h,0),e=n.subtract(t,i[0]),o=n.square(e),l=0,s=0;s<p;s++)e=n.subtract(t,u(i,c,h[s],null,null)),f=n.square(e),f<o&&(o=f,l=h[s]);return e=n.subtract(t,i[c]),f=n.square(e),f<o&&(o=f,l=1),{location:l,distance:o}},a=function(n,t){var i=o(n,t);return{point:u(t,t.length-1,i.location,null,null),location:i.location}},v=function(t,i){for(var f,s,l,a,o,p,w,u=i.length-1,v=2*u-1,y=[],h=[],c=[],e=[],b=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],r=0;r<=u;r++)y[r]=n.subtract(i[r],t);for(r=0;r<=u-1;r++)h[r]=n.subtract(i[r+1],i[r]),h[r]=n.scale(h[r],3);for(f=0;f<=u-1;f++)for(s=0;s<=u;s++)c[f]||(c[f]=[]),c[f][s]=n.dotProduct(h[f],y[s]);for(r=0;r<=v;r++)e[r]||(e[r]=[]),e[r].y=0,e[r].x=parseFloat(r)/v;for(l=u,a=u-1,o=0;o<=l+a;o++)for(p=Math.max(0,o-a),w=Math.min(o,l),r=p;r<=w;r++)j=o-r,e[r+j].y+=c[j][r]*b[j][r];return e},r=function(n,t,i,f){var c=[],l=[],s,h,a=[],v=[],o;switch(y(n,t)){case 0:return 0;case 1:if(f>=e)return i[0]=(n[0].x+n[t].x)/2,1;if(p(n,t))return i[0]=w(n,t),1}for(u(n,t,.5,c,l),s=r(c,t,a,f+1),h=r(l,t,v,f+1),o=0;o<s;o++)i[o]=a[o];for(o=0;o<h;o++)i[o+s]=v[o];return s+h},y=function(n,t){for(var f=0,u,i=u=Math.sgn(n[0].y),r=1;r<=t;r++)i=Math.sgn(n[r].y),i!=u&&f++,u=i;return f},p=function(n,t){var d,p,w,g,nt,e,o,s,h,c,b,r,k,a,i,v,y,u,f;for(e=n[0].y-n[t].y,o=n[t].x-n[0].x,s=n[0].x*n[t].y-n[t].x*n[0].y,y=max_distance_below=0,u=1;u<t;u++)f=e*n[u].x+o*n[u].y+s,f>y?y=f:f<max_distance_below&&(max_distance_below=f);return b=0,r=1,k=0,a=e,i=o,v=s-y,h=b*i-a*r,c=1/h,p=(r*v-i*k)*c,a=e,i=o,v=s-max_distance_below,h=b*i-a*r,c=1/h,w=(r*v-i*k)*c,g=Math.min(p,w),nt=Math.max(p,w),d=nt-g,d<l?1:0},w=function(n,t){var i=1,r=n[t].x-n[0].x,u=n[t].y-n[0].y,f=n[0].x-0,e=n[0].y-0,o=r*0-u*i,s=1/o,h=(r*e-u*f)*s;return 0+i*h},u=function(n,t,i,r,u){for(var o,e=[[]],f=0;f<=t;f++)e[0][f]=n[f];for(o=1;o<=t;o++)for(f=0;f<=t-o;f++)e[o]||(e[o]=[]),e[o][f]||(e[o][f]={}),e[o][f].x=(1-i)*e[o-1][f].x+i*e[o-1][f+1].x,e[o][f].y=(1-i)*e[o-1][f].y+i*e[o-1][f+1].y;if(r!=null)for(f=0;f<=t;f++)r[f]=e[f][0];if(u!=null)for(f=0;f<=t;f++)u[f]=e[t-f][f];return e[t][0]},s={},b=function(n){var t=s[n],r,u,i;if(!t){t=[];var f=function(){return function(t){return Math.pow(t,n)}},e=function(){return function(t){return Math.pow(1-t,n)}},o=function(n){return function(){return n}},h=function(){return function(n){return n}},c=function(){return function(n){return 1-n}},l=function(n){return function(t){for(var i=1,r=0;r<n.length;r++)i=i*n[r](t);return i}};for(t.push(new f),r=1;r<n;r++){for(u=[new o(n)],i=0;i<n-r;i++)u.push(new h);for(i=0;i<r;i++)u.push(new c);t.push(new l(u))}t.push(new e);s[n]=t}return t},t=function(n,t){for(var f=b(n.length-1),r=0,u=0,i=0;i<n.length;i++)r=r+n[i].x*f[i](t),u=u+n[i].y*f[i](t);return{x:r,y:u}},h=function(n,t){return Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2))},c=function(n){return n[0].x==n[1].x&&n[0].y==n[1].y},i=function(n,i,r){if(c(n))return{point:n[0],location:i};for(var e=t(n,i),o=0,f=i,s=r>0?1:-1,u=null;o<Math.abs(r);)f+=.005*s,u=t(n,f),o+=h(u,e),e=u;return{point:u,location:f}},k=function(n){if(c(n))return 0;for(var u=t(n,0),f=0,i=0,r=null;i<1;)i+=.005*1,r=t(n,i),f+=h(r,u),u=r;return f},d=function(n,t,r){return i(n,t,r).point},g=function(n,t,r){return i(n,t,r).location},f=function(n,i){var r=t(n,i),u=t(n.slice(0,n.length-1),i),f=u.y-r.y,e=u.x-r.x;return f==0?Infinity:Math.atan(f/e)},nt=function(n,t,r){var u=i(n,t,r);return u.location>1&&(u.location=1),u.location<0&&(u.location=0),f(n,u.location)},tt=function(n,t,r,u){u=u==null?0:u;var e=i(n,t,u),c=f(n,e.location),o=Math.atan(-1/c),s=r/2*Math.sin(o),h=r/2*Math.cos(o);return[{x:e.point.x+h,y:e.point.y+s},{x:e.point.x-h,y:e.point.y-s}]},it=window.jsBezier={distanceFromCurve:o,gradientAtPoint:f,gradientAtPointAlongCurveFrom:nt,nearestPointOnCurve:a,pointOnCurve:t,pointAlongCurveFrom:d,perpendicularToCurveAt:tt,locationAlongCurveFrom:g,getLength:k}})(),function(){"use strict";var a={android:navigator.userAgent.toLowerCase().indexOf("android")>-1},i=function(n,t,i){var u,r;for(i=i||n.parentNode,u=i.querySelectorAll(t),r=0;r<u.length;r++)if(u[r]===n)return!0;return!1},u=function(n){return typeof n=="string"?document.getElementById(n):n},r=function(n){return n.srcElement||n.target},v=function(n,t){for(var i=0,r=n.length;i<r;i++)if(n[i]==t)break;i<n.length&&n.splice(i,1)},d=1,y=function(n,t,i){var r=d++;return n.__ta=n.__ta||{},n.__ta[t]=n.__ta[t]||{},n.__ta[t][r]=i,i.__tauid=r,r},g=function(n,t,i){if(n.__ta&&n.__ta[t]&&delete n.__ta[t][i.__tauid],i.__taExtra){for(var r=0;r<i.__taExtra.length;r++)l(n,i.__taExtra[r][0],i.__taExtra[r][1]);i.__taExtra.length=0}i.__taUnstore&&i.__taUnstore()},f=function(n,t,u,f){if(n==null)return u;var o=n.split(","),e=function(n){var s,f;for(e.__tauid=u.__tauid,s=r(n),f=0;f<o.length;f++)i(s,o[f],t)&&u.apply(s,arguments)};return nt(u,f,e),e},nt=function(n,t,i){n.__taExtra=n.__taExtra||[];n.__taExtra.push([t,i])},n=function(n,i,r,u){h&&t[i]?o(n,t[i],f(u,n,r,t[i]),r):o(n,i,f(u,n,r,i),r)},tt=function(t,i,u,f){if(t.__taSmartClicks==null){var o=function(n){t.__tad=e(n)},s=function(n){t.__tau=e(n)},h=function(n){if(t.__tad&&t.__tau&&t.__tad[0]===t.__tau[0]&&t.__tad[1]===t.__tau[1])for(var i=0;i<t.__taSmartClicks.length;i++)t.__taSmartClicks[i].apply(r(n),[n])};n(t,"mousedown",o,f);n(t,"mouseup",s,f);n(t,"click",h,f);t.__taSmartClicks=[]}t.__taSmartClicks.push(u);u.__taUnstore=function(){v(t.__taSmartClicks,u)}},p={tap:{touches:1,taps:1},dbltap:{touches:1,taps:2},contextmenu:{touches:2,taps:1}},it=function(t,u){return function(f,e,o,s){if(e=="contextmenu"&&ut)n(f,e,o,s);else{if(f.__taTapHandler==null){var h=f.__taTapHandler={tap:[],dbltap:[],contextmenu:[],down:!1,taps:0,downSelectors:[]},c=function(n){for(var e=n.srcElement||n.target,r=0;r<h.downSelectors.length;r++)if(h.downSelectors[r]==null||i(e,h.downSelectors[r],f)){h.down=!0;setTimeout(a,t);setTimeout(y,u);break}},l=function(n){var o,s,t,e,u;if(h.down){o=n.srcElement||n.target;h.taps++;s=ht(n);for(t in p)if(e=p[t],e.touches===s&&(e.taps===1||e.taps===h.taps))for(u=0;u<h[t].length;u++)(h[t][u][1]==null||i(o,h[t][u][1],f))&&h[t][u][0].apply(r(n),[n])}},a=function(){h.down=!1},y=function(){h.taps=0};n(f,"mousedown",c);n(f,"mouseup",l)}f.__taTapHandler.downSelectors.push(s);f.__taTapHandler[e].push([o,s]);o.__taUnstore=function(){v(f.__taTapHandler[e],o)}}}},w=function(n,t,i,r){for(var u in i.__tamee[n])i.__tamee[n][u].apply(r,[t])},rt=function(){var n=[];return function(t,u,e,s){if(!t.__tamee){t.__tamee={over:!1,mouseenter:[],mouseexit:[]};var h=function(u){var f=r(u);(s!=null||f!=t||t.__tamee.over)&&(!i(f,s,t)||f.__tamee!=null&&f.__tamee.over)||(w("mouseenter",u,t,f),f.__tamee=f.__tamee||{},f.__tamee.over=!0,n.push(f))},c=function(u){for(var f=r(u),e=0;e<n.length;e++)f!=n[e]||i(u.relatedTarget||u.toElement,"*",f)||(f.__tamee.over=!1,n.splice(e,1),w("mouseexit",u,t,f))};o(t,"mouseover",f(s,t,h,"mouseover"),h);o(t,"mouseout",f(s,t,c,"mouseout"),c)}e.__taUnstore=function(){delete t.__tamee[u][e.__tauid]};y(t,u,e);t.__tamee[u][e.__tauid]=e}},h="ontouchstart"in document.documentElement,ut="onmousedown"in document.documentElement,t={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},b=function(){var n=-1,t,i;return navigator.appName=="Microsoft Internet Explorer"&&(t=navigator.userAgent,i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),i.exec(t)!=null&&(n=parseFloat(RegExp.$1))),n}(),ft=b>-1&&b<9,c=function(n,t){if(n==null)return[0,0];var r=k(n),i=st(r,0);return[i[t+"X"],i[t+"Y"]]},e=function(n){return n==null?[0,0]:ft?[n.clientX+document.documentElement.scrollLeft,n.clientY+document.documentElement.scrollTop]:c(n,"page")},et=function(n){return c(n,"screen")},ot=function(n){return c(n,"client")},st=function(n,t){return n.item?n.item(t):n[t]},k=function(n){return n.touches&&n.touches.length>0?n.touches:n.changedTouches&&n.changedTouches.length>0?n.changedTouches:n.targetTouches&&n.targetTouches.length>0?n.targetTouches:[n]},ht=function(n){return k(n).length},o=function(n,t,i,r){if(y(n,t,i),r.__tauid=i.__tauid,n.addEventListener)n.addEventListener(t,i,!1);else if(n.attachEvent){var u=t+i.__tauid;n["e"+u]=i;n[u]=function(){n["e"+u]&&n["e"+u](window.event)};n.attachEvent("on"+t,n[u])}},l=function(n,t,i){i!=null&&s(n,function(){var n=u(this),r;g(n,t,i);i.__tauid!=null&&(n.removeEventListener?n.removeEventListener(t,i,!1):this.detachEvent&&(r=t+i.__tauid,n[r]&&n.detachEvent("on"+t,n[r]),n[r]=null,n["e"+r]=null))})},ct=function(){},s=function(n,t){if(n!=null){n=typeof n!="string"&&n.tagName==null&&n.length!=null?n:typeof n=="string"?document.querySelectorAll(n):[n];for(var i=0;i<n.length;i++)t.apply(n[i])}};this.Mottle=function(i){i=i||{};var p=this,r=i.clickThreshold||150,f=i.dblClickThreshold||350,o=new rt,c=new it(r,f),v=i.smartClicks,y=function(t,i,r,f){r!=null&&s(t,function(){var t=u(this);v&&i==="click"?tt(t,i,r,f):i==="tap"||i==="dbltap"||i==="contextmenu"?c(t,i,r,f):i==="mouseenter"||i=="mouseexit"?o(t,i,r,f):n(t,i,r,f)})};this.remove=function(n){return s(n,function(){var n=u(this),t,i;if(n.__ta)for(t in n.__ta)for(i in n.__ta[t])l(n,t,n.__ta[t][i]);n.parentNode&&n.parentNode.removeChild(n)}),this};this.on=function(){var n=arguments[0],t=arguments.length==4?arguments[2]:null,i=arguments[1],r=arguments[arguments.length-1];return y(n,i,r,t),this};this.off=function(n,t,i){return l(n,t,i),this};this.trigger=function(n,i,r,f){var l=h&&t[i]?t[i]:i,v=e(r),o=et(r),c=ot(r);return s(n,function(){var e=u(this),n,s,p,w,y;r=r||{screenX:o[0],screenY:o[1],clientX:c[0],clientY:c[1]};s=function(n){f&&(n.payload=f)};p={TouchEvent:function(n){var t=document.createTouch(window,e,0,v[0],v[1],o[0],o[1],c[0],c[1],0,0,0,0);n.initTouchEvent(l,!0,!0,window,0,o[0],o[1],c[0],c[1],!1,!1,!1,!1,document.createTouchList(t))},MouseEvents:function(n){if(n.initMouseEvent(l,!0,!0,window,0,o[0],o[1],c[0],c[1],!1,!1,!1,!1,1,e),a.android){var t=document.createTouch(window,e,0,v[0],v[1],o[0],o[1],c[0],c[1],0,0,0,0);n.touches=n.targetTouches=n.changedTouches=document.createTouchList(t)}}};document.createEvent?(w=h&&t[i]&&!a.android,y=w?"TouchEvent":"MouseEvents",n=document.createEvent(y),p[y](n),s(n),e.dispatchEvent(n)):document.createEventObject&&(n=document.createEventObject(),n.eventType=n.eventName=l,n.screenX=o[0],n.screenY=o[1],n.clientX=c[0],n.clientY=c[1],s(n),e.fireEvent("on"+l,n))}),this}};Mottle.consume=function(n,t){n.stopPropagation?n.stopPropagation():n.returnValue=!1;!t&&n.preventDefault&&n.preventDefault()};Mottle.pageLocation=e}.call(this),function(){"use strict";var n=this.Biltong={},r=function(n){return Object.prototype.toString.call(n)==="[object Array]"},t=function(n,t,i){return n=r(n)?n:[n.x,n.y],t=r(t)?t:[t.x,t.y],i(n,t)},i=n.gradient=function(n,i){return t(n,i,function(n,t){return t[0]==n[0]?t[1]>n[1]?Infinity:-Infinity:t[1]==n[1]?t[0]>n[0]?0:-0:(t[1]-n[1])/(t[0]-n[0])})},o=n.normal=function(n,t){return-1/i(n,t)},s=n.lineLength=function(n,i){return t(n,i,function(n,t){return Math.sqrt(Math.pow(t[1]-n[1],2)+Math.pow(t[0]-n[0],2))})},u=n.quadrant=function(n,i){return t(n,i,function(n,t){return t[0]>n[0]?t[1]>n[1]?2:1:t[0]==n[0]?t[1]>n[1]?2:1:t[1]>n[1]?3:4})},h=n.theta=function(n,r){return t(n,r,function(n,t){var e=i(n,t),r=Math.atan(e),f=u(n,t);return(f==4||f==3)&&(r+=Math.PI),r<0&&(r+=2*Math.PI),r})},c=n.intersects=function(n,t){var i=n.x,s=n.x+n.w,u=n.y,f=n.y+n.h,r=t.x,h=t.x+t.w,e=t.y,o=t.y+t.h;return i<=r&&r<=s&&u<=e&&e<=f||i<=h&&h<=s&&u<=e&&e<=f||i<=r&&r<=s&&u<=o&&o<=f||i<=h&&r<=s&&u<=o&&o<=f||r<=i&&i<=h&&e<=u&&u<=o||r<=s&&s<=h&&e<=u&&u<=o||r<=i&&i<=h&&e<=f&&f<=o||r<=s&&i<=h&&e<=f&&f<=o},l=n.encloses=function(n,t,i){var u=n.x,f=n.x+n.w,e=n.y,o=n.y+n.h,s=t.x,h=t.x+t.w,c=t.y,l=t.y+t.h,r=function(n,t,r,u){return i?n<=t&&r>=u:n<t&&r>u};return r(u,s,f,h)&&r(e,c,o,l)},f=[null,[1,-1],[1,1],[-1,1],[-1,-1]],e=[null,[-1,-1],[-1,1],[1,1],[1,-1]],a=n.pointOnLine=function(n,t,r){var c=i(n,t),o=u(n,t),s=r>0?f[o]:e[o],h=Math.atan(c),l=Math.abs(r*Math.sin(h))*s[1],a=Math.abs(r*Math.cos(h))*s[0];return{x:n.x+a,y:n.y+l}},v=n.perpendicularLineTo=function(n,t,r){var o=i(n,t),u=Math.atan(-1/o),f=r/2*Math.sin(u),e=r/2*Math.cos(u);return[{x:t.x+e,y:t.y+f},{x:t.x-e,y:t.y-f}]}}.call(this),function(){"use strict";var a=function(n){var r=n.getBoundingClientRect(),t=document.body,i=document.documentElement,u=window.pageYOffset||i.scrollTop||t.scrollTop,f=window.pageXOffset||i.scrollLeft||t.scrollLeft,e=i.clientTop||t.clientTop||0,o=i.clientLeft||t.clientLeft||0,s=r.top+u-e,h=r.left+f-o;return{top:Math.round(s),left:Math.round(h)}},u=function(n,t,i){var u,r;for(i=i||n.parentNode,u=i.querySelectorAll(t),r=0;r<u.length;r++)if(u[r]===n)return!0;return!1},f=function(){var n=-1,t,i;return navigator.appName=="Microsoft Internet Explorer"&&(t=navigator.userAgent,i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),i.exec(t)!=null&&(n=parseFloat(RegExp.$1))),n}(),v=f>-1&&f<9,e=function(n){if(v)return[n.clientX+document.documentElement.scrollLeft,n.clientY+document.documentElement.scrollTop];var i=p(n),t=y(i,0);return[t.pageX,t.pageY]},y=function(n,t){return n.item?n.item(t):n[t]},p=function(n){return n.touches&&n.touches.length>0?n.touches:n.changedTouches&&n.changedTouches.length>0?n.changedTouches:n.targetTouches&&n.targetTouches.length>0?n.targetTouches:[n]},o={draggable:"katavorio-draggable",droppable:"katavorio-droppable",drag:"katavorio-drag",selected:"katavorio-drag-selected",active:"katavorio-drag-active",hover:"katavorio-drag-hover",noSelect:"katavorio-drag-no-select"},w="katavorio-drag-scope",r=["stop","start","drag","drop","over","out"],b=function(){},s=function(){return!0},t=function(n,t,i){for(var r=0;r<n.length;r++)n[r]!=i&&t(n[r])},h=function(n,i,r,u){t(n,function(n){n.setActive(i);i&&n.updatePosition();r&&n.setHover(u,i)})},n=function(n,t){if(n!=null){n=typeof n!="string"&&n.tagName==null&&n.length!=null?n:[n];for(var i=0;i<n.length;i++)t.apply(n[i],[n[i]])}},c=function(n){n.stopPropagation?(n.stopPropagation(),n.preventDefault()):n.returnValue=!1},k="input,textarea,select,button",d=function(n,t,i){var r=n.srcElement||n.target;return!u(r,i.getInputFilterSelector(),t)},l=function(t,i,r,u){this.params=i||{};this.el=t;this.params.addClass(this.el,this._class);var f=!0;return this.setEnabled=function(n){f=n},this.isEnabled=function(){return f},this.toggleEnabled=function(){f=!f},this.setScope=function(n){this.scopes=n?n.split(/\s+/):[u]},this.addScope=function(t){var i={},r;n(this.scopes,function(n){i[n]=!0});n(t?t.split(/\s+/):[],function(n){i[n]=!0});this.scopes=[];for(r in i)this.scopes.push(r)},this.removeScope=function(t){var i={},r;n(this.scopes,function(n){i[n]=!0});n(t?t.split(/\s+/):[],function(n){delete i[n]});this.scopes=[];for(r in i)this.scopes.push(r)},this.toggleScope=function(t){var i={},r;n(this.scopes,function(n){i[n]=!0});n(t?t.split(/\s+/):[],function(n){i[n]?delete i[n]:i[n]=!0});this.scopes=[];for(r in i)this.scopes.push(r)},this.setScope(i.scope),this.k=i.katavorio,i.katavorio},g=function(n,t,i){var o,k,f,y;this._class=i.draggable;o=l.apply(this,arguments);this.rightButtonCanDrag=this.params.rightButtonCanDrag;var v=[0,0],p=null,w=!1,rt=this.params.consumeStartEvent!==!1,r=this.el,g=this.params.clone;this.toGrid=function(n){return this.params.grid==null?n:[this.params.grid[0]*Math.floor(n[0]/this.params.grid[0]),this.params.grid[1]*Math.floor(n[1]/this.params.grid[1])]};this.constrain=typeof this.params.constrain=="function"?this.params.constrain:this.params.constrain||this.params.containment?function(n){return[Math.max(0,Math.min(k.w-this.size[0],n[0])),Math.max(0,Math.min(k.h-this.size[1],n[1]))]}:function(n){return n};var nt=s,tt="",b=this.params.filterExclude!==!1,it=this.setFilter=function(t,i){t&&(tt=t,b=i!==!1,nt=function(i){var f=i.srcElement||i.target,r=u(f,t,n);return b?!r:r})};this.canDrag=this.params.canDrag||s;f=[];y=[];this.downListener=function(n){var f=this.rightButtonCanDrag||n.which!==3&&n.button!==2,u,t;f&&this.isEnabled()&&this.canDrag()&&(u=nt(n)&&d(n,this.el,this.k),u?(g?(r=this.el.cloneNode(!0),r.setAttribute("id",null),r.style.position="absolute",t=a(this.el),r.style.left=t.left+"px",r.style.top=t.top+"px",document.body.appendChild(r)):r=this.el,rt&&c(n),v=e(n),this.params.bind(document,"mousemove",this.moveListener),this.params.bind(document,"mouseup",this.upListener),o.markSelection(this),this.params.addClass(document.body,i.noSelect)):this.params.consumeFilteredEvents&&c(n))}.bind(this);this.moveListener=function(n){if(v){w||(this.params.events.start({el:this.el,pos:p,e:n,drag:this}),this.mark(),w=!0);y.length=0;var r=e(n),t=r[0]-v[0],i=r[1]-v[1],u=this.params.ignoreZoom?1:o.getZoom();t/=u;i/=u;this.moveBy(t,i,n);o.updateSelection(t,i,this)}}.bind(this);this.upListener=function(n){v=null;w=!1;this.params.unbind(document,"mousemove",this.moveListener);this.params.unbind(document,"mouseup",this.upListener);this.params.removeClass(document.body,i.noSelect);this.unmark(n);o.unmarkSelection(this,n);this.stop(n);o.notifySelectionDragStop(this,n);g&&(r&&r.parentNode&&r.parentNode.removeChild(r),r=null)}.bind(this);this.getFilter=function(){return tt};this.isFilterExclude=function(){return b};this.abort=function(){v!=null&&this.upListener()};this.getDragElement=function(){return r||this.el};this.stop=function(n){this.params.events.stop({el:r,pos:this.params.getPosition(r),e:n,drag:this})};this.mark=function(){if(p=this.params.getPosition(r),this.size=this.params.getSize(r),f=o.getMatchingDroppables(this),h(f,!0,!1,this),this.params.addClass(r,this.params.dragClass||i.drag),this.params.constrain||this.params.containment){var n=this.params.getSize(r.parentNode);k={w:n[0],h:n[1]}}};this.unmark=function(n){h(f,!1,!0,this);f.length=0;for(var t=0;t<y.length;t++)y[t].drop(this,n)};this.moveBy=function(n,t,i){var e,o,u,s;for(y.length=0,e=this.constrain(this.toGrid([p[0]+n,p[1]+t]),r),o={x:e[0],y:e[1],w:this.size[0],h:this.size[1]},this.params.setPosition(r,e),u=0;u<f.length;u++)s={x:f[u].position[0],y:f[u].position[1],w:f[u].size[0],h:f[u].size[1]},this.params.intersects(o,s)&&f[u].canDrop(this)?(y.push(f[u]),f[u].setHover(this,!0,i)):f[u].el._katavorioDragHover&&f[u].setHover(this,!1,i);this.params.events.drag({el:this.el,pos:e,e:i,drag:this})};this.destroy=function(){this.params.unbind(this.el,"mousedown",this.downListener);this.params.unbind(document,"mousemove",this.moveListener);this.params.unbind(document,"mouseup",this.upListener);this.downListener=null;this.upListener=null;this.moveListener=null};this.params.bind(this.el,"mousedown",this.downListener);this.params.handle?it(this.params.handle,!1):it(this.params.filter,this.params.filterExclude)},nt=function(n,t,i){this._class=i.droppable;this.params=t||{};this._activeClass=t.activeClass||i.active;this._hoverClass=t.hoverClass||i.hover;l.apply(this,arguments);var r=!1;this.setActive=function(n){this.params[n?"addClass":"removeClass"](this.el,this._activeClass)};this.updatePosition=function(){this.position=this.params.getPosition(this.el);this.size=this.params.getSize(this.el)};this.canDrop=this.params.canDrop||function(){return!0};this.setHover=function(n,t,i){(t||this.el._katavorioDragHover==null||this.el._katavorioDragHover==n.el._katavorio)&&(this.params[t?"addClass":"removeClass"](this.el,this._hoverClass),this.el._katavorioDragHover=t?n.el._katavorio:null,r!==t&&this.params.events[t?"over":"out"]({el:this.el,e:i,drag:n,drop:this}),r=t)};this.drop=function(n,t){this.params.events.drop({drag:n,e:t,drop:this})};this.destroy=function(){this._class=null;this._activeClass=null;this._hoverClass=null;r=null}},tt=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)})},i=function(n){return n==null?null:(n=typeof n=="string"?document.getElementById(n):n,n==null)?null:(n._katavorio=n._katavorio||tt(),n)};this.Katavorio=function(u){var f=[],s={},h,a,c,v;this._dragsByScope={};this._dropsByScope={};var y=1,l=function(n,t){for(var i=0;i<n.scopes.length;i++)t[n.scopes[i]]=t[n.scopes[i]]||[],t[n.scopes[i]].push(n)},p=function(n,t){for(var r,f=0,i=0;i<n.scopes.length;i++)t[n.scopes[i]]&&(r=u.indexOf(t[n.scopes[i]],n),r!=-1&&(t[n.scopes[i]].splice(r,1),f++));return f>0},rt=this.getMatchingDroppables=function(n){for(var t,i,u=[],f={},r=0;r<n.scopes.length;r++)if(t=this._dropsByScope[n.scopes[r]],t)for(i=0;i<t.length;i++)t[i].canDrop(n)&&!f[t[i].el._katavorio]&&t[i].el!==n.el&&(f[t[i].el._katavorio]=!0,u.push(t[i]));return u},d=function(n){var i,t;n=n||{};i={events:{}};for(t in u)i[t]=u[t];for(t in n)i[t]=n[t];for(t=0;t<r.length;t++)i.events[r[t]]=n[r[t]]||b;return i.katavorio=this,i}.bind(this),e={},tt=u.css||{},it=u.scope||w;for(h in o)e[h]=o[h];for(h in tt)e[h]=tt[h];a=u.inputFilterSelector||k;this.getInputFilterSelector=function(){return a};this.setInputFilterSelector=function(n){return a=n,this};this.draggable=function(t,r){var f=[];return n(t,function(n){if(n=i(n),n!=null){var t=d(r);n._katavorioDrag=new g(n,t,e,it);l(n._katavorioDrag,this._dragsByScope);f.push(n._katavorioDrag);u.addClass(n,e.draggable)}}.bind(this)),f};this.droppable=function(t,r){var f=[];return n(t,function(n){n=i(n);n!=null&&(n._katavorioDrop=new nt(n,d(r),e,it),l(n._katavorioDrop,this._dropsByScope),f.push(n._katavorioDrop),u.addClass(n,e.droppable))}.bind(this)),f};this.select=function(t){return n(t,function(){var n=i(this);n&&n._katavorioDrag&&(s[n._katavorio]||(f.push(n._katavorioDrag),s[n._katavorio]=[n,f.length-1],u.addClass(n,e.selected)))}),this};this.deselect=function(t){return n(t,function(){var n=i(this),o,r,t;if(n&&n._katavorio&&(o=s[n._katavorio],o)){for(r=[],t=0;t<f.length;t++)f[t].el!==n&&r.push(f[t]);f=r;delete s[n._katavorio];u.removeClass(n,e.selected)}}),this};this.deselectAll=function(){var n,t;for(n in s)t=s[n],u.removeClass(t[0],e.selected);f.length=0;s={}};this.markSelection=function(n){t(f,function(n){n.mark()},n)};this.unmarkSelection=function(n,i){t(f,function(n){n.unmark(i)},n)};this.getSelection=function(){return f.slice(0)};this.updateSelection=function(n,i,r){t(f,function(t){t.moveBy(n,i)},r)};this.notifySelectionDragStop=function(n,i){t(f,function(n){n.stop(i)},n)};this.setZoom=function(n){y=n};this.getZoom=function(){return y};c=function(n,t,i,r){n!=null&&(p(n,i),n[r](t),l(n,i))};n(["set","add","remove","toggle"],function(n){this[n+"Scope"]=function(t,i){c(t._katavorioDrag,i,this._dragsByScope,n+"Scope");c(t._katavorioDrop,i,this._dropsByScope,n+"Scope")}.bind(this);this[n+"DragScope"]=function(t,i){c(t._katavorioDrag,i,this._dragsByScope,n+"Scope")}.bind(this);this[n+"DropScope"]=function(t,i){c(t._katavorioDrop,i,this._dropsByScope,n+"Scope")}.bind(this)}.bind(this));this.getDragsForScope=function(n){return this._dragsByScope[n]};this.getDropsForScope=function(n){return this._dropsByScope[n]};v=function(n,t,r){n=i(n);n[t]&&(p(n[t],r)&&n[t].destroy(),n[t]=null)};this.elementRemoved=function(n){this.destroyDraggable(n);this.destroyDroppable(n)};this.destroyDraggable=function(n){v(n,"_katavorioDrag",this._dragsByScope)};this.destroyDroppable=function(n){v(n,"_katavorioDrop",this._dropsByScope)}}}.call(this),function(){var t=function(n){return Object.prototype.toString.call(n)==="[object Array]"},o=function(n){return Object.prototype.toString.call(n)==="[object Number]"},r=function(n){return typeof n=="string"},u=function(n){return typeof n=="boolean"},s=function(n){return n==null},i=function(n){return n==null?!1:Object.prototype.toString.call(n)==="[object Object]"},f=function(n){return Object.prototype.toString.call(n)==="[object Date]"},e=function(n){return Object.prototype.toString.call(n)==="[object Function]"},h=function(n){for(var t in n)if(n.hasOwnProperty(t))return!1;return!0},l=function(n,i,r){return n=t(n)?n:[n.x,n.y],i=t(i)?i:[i.x,i.y],r(n,i)},c=this,n=c.jsPlumbUtil={isArray:t,isString:r,isBoolean:u,isNull:s,isObject:i,isDate:f,isFunction:e,isEmpty:h,isNumber:o,clone:function(n){var s,o,h,c;if(r(n))return""+n;if(u(n))return!!n;if(f(n))return new Date(n.getTime());if(e(n))return n;if(t(n)){for(s=[],o=0;o<n.length;o++)s.push(this.clone(n[o]));return s}if(i(n)){h={};for(c in n)h[c]=this.clone(n[c]);return h}return n},merge:function(n,f,e){var l={},h,o,s,c;for(e=e||[],o=0;o<e.length;o++)l[e[o]]=!0;s=this.clone(n);for(o in f)if(s[o]==null)s[o]=f[o];else if(r(f[o])||u(f[o]))l[o]?(h=[],h.push.apply(h,t(s[o])?s[o]:[s[o]]),h.push.apply(h,t(f[o])?f[o]:[f[o]]),s[o]=h):s[o]=f[o];else if(t(f[o]))h=[],t(s[o])&&h.push.apply(h,s[o]),h.push.apply(h,f[o]),s[o]=h;else if(i(f[o])){i(s[o])||(s[o]={});for(c in f[o])s[o][c]=f[o][c]}return s},replace:function(n,t,i){if(n!=null){var u=n,r=u;return t.replace(/([^\.])+/g,function(n,t,u,f){var e=n.match(/([^\[0-9]+){1}(\[)([0-9+])/),h=u+n.length>=f.length,s=function(){return r[e[1]]||function(){return r[e[1]]=[],r[e[1]]}()},o;h?e?s()[e[3]]=i:r[n]=i:e?(o=s(),r=o[e[3]]||function(){return o[e[3]]={},o[e[3]]}()):r=r[n]||function(){return r[n]={},r[n]}()}),n}},functionChain:function(n,t,i){for(var u,r=0;r<i.length;r++)if(u=i[r][0][i[r][1]].apply(i[r][0],i[r][2]),u===t)return u;return n},populate:function(n,u){var e=function(n){var i=n.match(/(\${.*?})/g),t,r;if(i!=null)for(t=0;t<i.length;t++)r=u[i[t].substring(2,i[t].length-1)]||"",r!=null&&(n=n.replace(i[t],r));return n},f=function(n){var o,u,s,h;if(n!=null){if(r(n))return e(n);if(t(n)){for(o=[],u=0;u<n.length;u++)o.push(f(n[u]));return o}if(i(n)){s={};for(h in n)s[h]=f(n[h]);return s}return n}};return f(n)},convertStyle:function(n,t){var i;if("transparent"===n)return n;var r=n,e=function(n){return n.length==1?"0"+n:n},u=function(n){return e(Number(n).toString(16))},f=/(rgb[a]?\()(.*)(\))/;return n.match(f)&&(i=n.match(f)[2].split(","),r="#"+u(i[0])+u(i[1])+u(i[2]),t||i.length!=4||(r=r+u(i[3]))),r},findWithFunction:function(n,t){if(n)for(var i=0;i<n.length;i++)if(t(n[i]))return i;return-1},indexOf:function(t,i){return t.indexOf?t.indexOf(i):n.findWithFunction(t,function(n){return n==i})},removeWithFunction:function(t,i){var r=n.findWithFunction(t,i);return r>-1&&t.splice(r,1),r!=-1},remove:function(t,i){var r=n.indexOf(t,i);return r>-1&&t.splice(r,1),r!=-1},addWithFunction:function(t,i,r){n.findWithFunction(t,r)==-1&&t.push(i)},addToList:function(n,t,i,r){var u=n[t];return u==null&&(u=[],n[t]=u),u[r?"unshift":"push"](i),u},extend:function(n,i){var r,u,f,e;for(i=t(i)?i:[i],r=0;r<i.length;r++)for(u in i[r].prototype)i[r].prototype.hasOwnProperty(u)&&(n.prototype[u]=i[r].prototype[u]);if(f=function(n,t){return function(){for(r=0;r<i.length;r++)i[r].prototype[n]&&i[r].prototype[n].apply(this,arguments);return t.apply(this,arguments)}},e=function(t){for(var i in t)n.prototype[i]=f(i,t[i])},arguments.length>2)for(r=2;r<arguments.length;r++)e(arguments[r]);return n},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)})},logEnabled:!0,log:function(){if(n.logEnabled&&typeof console!="undefined")try{var t=arguments[arguments.length-1];console.log(t)}catch(i){}},wrap:function(t,i,r){return t=t||function(){},i=i||function(){},function(){var u=null;try{u=i.apply(this,arguments)}catch(f){n.log("jsPlumb function failed : "+f)}if(r==null||u!==r)try{u=t.apply(this,arguments)}catch(f){n.log("wrapped function failed : "+f)}return u}}};n.EventGenerator=function(){var t={},i=!1,r={ready:!0};this.bind=function(i,r,u){return n.addToList(t,i,r,u),this};this.fire=function(u,f,e){if(!i&&t[u]){var c=t[u].length,o=0,s=!1,h=null;if(!this.shouldFireEvent||this.shouldFireEvent(u,f,e))while(!s&&o<c&&h!==!1){if(r[u])t[u][o].apply(this,[f,e]);else try{h=t[u][o].apply(this,[f,e])}catch(l){n.log("jsPlumb: fire failed for event "+u+" : "+l)}o++;(t==null||t[u]==null)&&(s=!0)}}return this};this.unbind=function(n){return n?delete t[n]:t={},this};this.getListener=function(n){return t[n]};this.setSuspendEvents=function(n){i=n};this.isSuspendEvents=function(){return i};this.cleanupListeners=function(){for(var n in t)t[n]=null}};n.EventGenerator.prototype={cleanup:function(){this.cleanupListeners()}};Function.prototype.bind||(Function.prototype.bind=function(n){if(typeof this!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var r=Array.prototype.slice.call(arguments,1),u=this,t=function(){},i=function(){return u.apply(this instanceof t&&n?this:n,r.concat(Array.prototype.slice.call(arguments)))};return t.prototype=this.prototype,i.prototype=new t,i})}.call(this),function(){"use strict";var t=this,n=t.jsPlumbUtil;n.ieVersion=/MSIE\s([\d.]+)/.test(navigator.userAgent)?new Number(RegExp.$1):-1;n.oldIE=n.ieVersion>-1&&n.ieVersion<9;n.matchesSelector=function(n,t,i){var u,r;for(i=i||n.parentNode,u=i.querySelectorAll(t),r=0;r<u.length;r++)if(u[r]===n)return!0;return!1};n.consume=function(n,t){n.stopPropagation?n.stopPropagation():n.returnValue=!1;!t&&n.preventDefault&&n.preventDefault()};n.sizeElement=function(n,t,i,r,u){n&&(n.style.height=u+"px",n.height=u,n.style.width=r+"px",n.width=r,n.style.left=t+"px",n.style.top=i+"px")}}.call(this),function(){var o=this,s=!!window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),n=function(){var i,t;return n.vml===undefined&&(i=document.body.appendChild(document.createElement("div")),i.innerHTML='<v:shape id="vml_flag1" adj="1" />',t=i.firstChild,t!=null&&t.style!=null?(t.style.behavior="url(#default#VML)",n.vml=t?typeof t.adj=="object":!0):n.vml=!1,i.parentNode.removeChild(i)),n.vml},e=function(){var n=-1,t,i;return navigator.appName=="Microsoft Internet Explorer"&&(t=navigator.userAgent,i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),i.exec(t)!=null&&(n=parseFloat(RegExp.$1))),n}(),h=e>-1&&e<9,i=function(n,t){if(n==null)return[0,0];var r=y(n),i=v(r,0);return[i[t+"X"],i[t+"Y"]]},c=function(n){return n==null?[0,0]:h?[n.clientX+document.documentElement.scrollLeft,n.clientY+document.documentElement.scrollTop]:i(n,"page")},l=function(n){return i(n,"screen")},a=function(n){return i(n,"client")},v=function(n,t){return n.item?n.item(t):n[t]},y=function(n){return n.touches&&n.touches.length>0?n.touches:n.changedTouches&&n.changedTouches.length>0?n.changedTouches:n.targetTouches&&n.targetTouches.length>0?n.targetTouches:[n]},p=function(n){var u={},f=[],t={},r={},i={};this.register=function(e){var o=n.getId(e),h=jsPlumbAdapter.getOffset(e,n),s;u[o]||(u[o]=e,f.push(e),t[o]={});s=function(u){var f,l,e,c;if(u)for(f=0;f<u.childNodes.length;f++)u.childNodes[f].nodeType!=3&&u.childNodes[f].nodeType!=8&&(l=jsPlumb.getElementObject(u.childNodes[f]),e=n.getId(u.childNodes[f],null,!0),e&&r[e]&&r[e]>0&&(c=jsPlumbAdapter.getOffset(l,n),t[o][e]={id:e,offset:{left:c.left-h.left,top:c.top-h.top}},i[e]=o),s(u.childNodes[f]))};s(e)};this.updateOffsets=function(r){var u,c,e;if(r!=null){var o=jsPlumb.getDOMElement(r),f=n.getId(o),s=t[f],h=jsPlumbAdapter.getOffset(o,n);if(s)for(u in s)c=jsPlumb.getElementObject(u),e=jsPlumbAdapter.getOffset(c,n),t[f][u]={id:u,offset:{left:e.left-h.left,top:e.top-h.top}},i[u]=f}};this.endpointAdded=function(f,e){var l,o,s,h,c;for(e=e||n.getId(f),l=document.body,o=f.parentNode,r[e]=r[e]?r[e]+1:1;o!=null&&o!=l;){if(s=n.getId(o,null,!0),s&&u[s]){h=jsPlumbAdapter.getOffset(o,n);t[s][e]==null&&(c=jsPlumbAdapter.getOffset(f,n),t[s][e]={id:e,offset:{left:c.left-h.left,top:c.top-h.top}},i[e]=s);break}o=o.parentNode}};this.endpointDeleted=function(n){if(r[n.elementId]&&(r[n.elementId]--,r[n.elementId]<=0))for(var u in t)t[u]&&(delete t[u][n.elementId],delete i[n.elementId])};this.changeId=function(n,r){t[r]=t[n];t[n]={};i[r]=i[n];i[n]=null};this.getElementsForDraggable=function(n){return t[n]};this.elementRemoved=function(n){var r=i[n];r&&(delete t[r][n],delete i[n])};this.reset=function(){u={};f=[];t={};r={}};this.dragEnded=function(t){var u=n.getId(t),r=i[u];r&&this.updateOffsets(r)};this.setParent=function(r,u,f,e){var o=i[u],s,h;o&&(t[e]||(t[e]={}),t[e][u]=t[o][u],delete t[o][u],s=jsPlumbAdapter.getOffset(f,n),h=jsPlumbAdapter.getOffset(r,n),t[e][u].offset={left:h.left-s.left,top:h.top-s.top},i[u]=e)};this.getDragAncestor=function(t){var u=jsPlumb.getDOMElement(t),f=n.getId(u),r=i[f];return r?jsPlumb.getDOMElement(r):null}};window.console||(window.console={time:function(){},timeEnd:function(){},group:function(){},groupEnd:function(){},log:function(){}});var w=function(n){return n==null?null:n.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},r=function(n,t){t=w(t);typeof n.className.baseVal!="undefined"?n.className.baseVal=t:n.className=t},u=function(n){return typeof n.className.baseVal=="undefined"?n.className:n.className.baseVal},b=function(n,t,i){for(var s,o=jsPlumbUtil.isArray(i)?i:i.split(/\s+/),h=u(n),f=h.split(/\s+/),e=0;e<o.length;e++)t?jsPlumbUtil.indexOf(f,o[e])==-1&&f.push(o[e]):(s=jsPlumbUtil.indexOf(f,o[e]),s!=-1&&f.splice(s,1));r(n,f.join(" "))},f=function(n,t,i){t=t==null?[]:jsPlumbUtil.isArray(t)?t:t.split(/\s+/);i=i==null?[]:jsPlumbUtil.isArray(i)?i:i.split(/\s+/);var o=u(n),f=o.split(/\s+/),e=function(n,t){for(var r,i=0;i<t.length;i++)n?jsPlumbUtil.indexOf(f,t[i])==-1&&f.push(t[i]):(r=jsPlumbUtil.indexOf(f,t[i]),r!=-1&&f.splice(r,1))};e(!0,t);e(!1,i);r(n,f.join(" "))},t=function(n,t){if(n!=null)if(typeof n=="string")t(jsPlumb.getDOMElement(n));else if(n.length!=null)for(var i=0;i<n.length;i++)t(jsPlumb.getDOMElement(n[i]));else t(n)};window.jsPlumbAdapter={headless:!1,pageLocation:c,screenLocation:l,clientLocation:a,getAttribute:function(n,t){return n.getAttribute(t)},setAttribute:function(n,t,i){n.setAttribute(t,i)},appendToRoot:function(n){document.body.appendChild(n)},getRenderModes:function(){return["svg","vml"]},isRenderModeAvailable:function(t){return{svg:s,vml:n()}[t]},getDragManager:function(n){return new p(n)},setRenderMode:function(n){var t,r,i;return n&&(n=n.toLowerCase(),r=this.isRenderModeAvailable("svg"),i=this.isRenderModeAvailable("vml"),n==="svg"?r?t="svg":i&&(t="vml"):i&&(t="vml")),t},addClass:function(n,i){t(n,function(n){f(n,i)})},hasClass:function(n,t){return n=jsPlumb.getDOMElement(n),n.classList?n.classList.contains(t):u(n).indexOf(t)!=-1},removeClass:function(n,i){t(n,function(n){f(n,null,i)})},updateClasses:function(n,i,r){t(n,function(n){f(n,i,r)})},setClass:function(n,i){t(n,function(n){r(n,i)})},setPosition:function(n,t){n.style.left=t.left+"px";n.style.top=t.top+"px"},getPosition:function(n){var t=function(t){var i=n.style[t];return i?i.substring(0,i.length-2):0};return{left:t("left"),top:t("top")}},getOffset:function(n,t,i){n=jsPlumb.getDOMElement(n);for(var u=t.getContainer(),f=n.offsetLeft,e=n.offsetTop,r=i||u!=null&&n.offsetParent!=u?n.offsetParent:null;r!=null;)f+=r.offsetLeft,e+=r.offsetTop,r=i?r.offsetParent:r.offsetParent==u?null:r.offsetParent;return{left:f,top:e}},getPositionOnElement:function(n,t,i){var r=typeof t.getBoundingClientRect!="undefined"?t.getBoundingClientRect():{left:0,top:0,width:0,height:0},u=document.body,f=document.documentElement,b=t.offsetParent,o=window.pageYOffset||f.scrollTop||u.scrollTop,s=window.pageXOffset||f.scrollLeft||u.scrollLeft,h=f.clientTop||u.clientTop||0,c=f.clientLeft||u.clientLeft||0,l=r.top+o-h+0*i,a=r.left+s-c+0*i,e=jsPlumbAdapter.pageLocation(n),v=r.width||t.offsetWidth*i,y=r.height||t.offsetHeight*i,p=(e[0]-a)/v,w=(e[1]-l)/y;return[p,w]},getAbsolutePosition:function(n){var t=function(t){var i=n.style[t];if(i)return parseFloat(i.substring(0,i.length-2))};return[t("left"),t("top")]},setAbsolutePosition:function(n,t,i,r){i?o.jsPlumb.animate(n,{left:"+="+(t[0]-i[0]),top:"+="+(t[1]-i[1])},r):(n.style.left=t[0]+"px",n.style.top=t[1]+"px")}}}.call(this),function(){"use strict";var t=jsPlumbUtil,o=function(n,t,i){return jsPlumbAdapter.getOffset(n,t,i)},r=function(){return""+(new Date).getTime()},c=function(t){if(t._jsPlumb.paintStyle&&t._jsPlumb.hoverPaintStyle){var i={};n.extend(i,t._jsPlumb.paintStyle);n.extend(i,t._jsPlumb.hoverPaintStyle);delete t._jsPlumb.hoverPaintStyle;i.gradient&&t._jsPlumb.paintStyle.fillStyle&&delete i.gradient;t._jsPlumb.hoverPaintStyle=i}},l=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu"],w=function(n,t,i,r){var f=n.getAttachedElements(),u,e;if(f)for(u=0,e=f.length;u<e;u++)r&&r==f[u]||f[u].setHover(t,!0,i)},f=function(n){return n==null?null:n.split(" ")},i=function(n,i,r){var e,u,f,o;if(n.getDefaultType){for(e=n.getTypeDescriptor(),u=t.merge({},n.getDefaultType()),f=0,o=n._jsPlumb.types.length;f<o;f++)u=t.merge(u,n._jsPlumb.instance.getType(n._jsPlumb.types[f],e),["cssClass"]);i&&(u=t.populate(u,i));n.applyType(u,r);r||n.repaint()}},u=window.jsPlumbUIComponent=function(n){var i;jsPlumbUtil.EventGenerator.apply(this,arguments);var r=this,f=arguments,e=r.idPrefix,o=e+(new Date).getTime();if(this._jsPlumb={instance:n._jsPlumb,parameters:n.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:n.beforeDetach,beforeDrop:n.beforeDrop,overlayPlacements:[],hoverClass:n.hoverClass||n._jsPlumb.Defaults.HoverClass,types:[]},this.getId=function(){return o},n.events)for(i in n.events)r.bind(i,n.events[i]);this.clone=function(){var n={};return this.constructor.apply(n,f),n}.bind(this);this.isDetachAllowed=function(n){var i=!0;if(this._jsPlumb.beforeDetach)try{i=this._jsPlumb.beforeDetach(n)}catch(r){t.log("jsPlumb: beforeDetach callback failed",r)}return i};this.isDropAllowed=function(n,i,r,u,f,e,o){var s=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:n,targetId:i,scope:r,connection:u,dropEndpoint:f,source:e,target:o});if(this._jsPlumb.beforeDrop)try{s=this._jsPlumb.beforeDrop({sourceId:n,targetId:i,scope:r,connection:u,dropEndpoint:f,source:e,target:o})}catch(h){t.log("jsPlumb: beforeDrop callback failed",h)}return s};var s=[],h=function(n,t,i){s.push([n,t,i]);n.bind(t,i)},u=[];this.setListenerComponent=function(n){for(var t=0;t<u.length;t++)u[t][3]=n}},s=function(n,t){var r=n._jsPlumb.types[t],i=n._jsPlumb.instance.getType(r,n.getTypeDescriptor());i!=null&&i.cssClass&&n.canvas&&n._jsPlumb.instance.removeClass(n.canvas,i.cssClass)},n;jsPlumbUtil.extend(u,jsPlumbUtil.EventGenerator,{getParameter:function(n){return this._jsPlumb.parameters[n]},setParameter:function(n,t){this._jsPlumb.parameters[n]=t},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(n){this._jsPlumb.parameters=n},addClass:function(n){jsPlumbAdapter.addClass(this.canvas,n)},removeClass:function(n){jsPlumbAdapter.removeClass(this.canvas,n)},updateClasses:function(n,t){jsPlumbAdapter.updateClasses(this.canvas,n,t)},setType:function(n,t,r){this.clearTypes();this._jsPlumb.types=f(n)||[];i(this,t,r)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(n,t){i(this,n,t)},hasType:function(n){return jsPlumbUtil.indexOf(this._jsPlumb.types,n)!=-1},addType:function(n,t,r){var e=f(n),o=!1,u,s;if(e!=null){for(u=0,s=e.length;u<s;u++)this.hasType(e[u])||(this._jsPlumb.types.push(e[u]),o=!0);o&&i(this,t,r)}},removeType:function(n,r){var e=f(n),o=!1,c=function(n){var i=t.indexOf(this._jsPlumb.types,n);return i!=-1?(s(this,i),this._jsPlumb.types.splice(i,1),!0):!1}.bind(this),u,h;if(e!=null){for(u=0,h=e.length;u<h;u++)o=c(e[u])||o;o&&i(this,null,r)}},clearTypes:function(n){for(var r=this._jsPlumb.types.length,t=0;t<r;t++)s(this,0),this._jsPlumb.types.splice(0,1);i(this,{},n)},toggleType:function(n,t,r){var e=f(n),u,h,o;if(e!=null){for(u=0,h=e.length;u<h;u++)o=jsPlumbUtil.indexOf(this._jsPlumb.types,e[u]),o!=-1?(s(this,o),this._jsPlumb.types.splice(o,1)):this._jsPlumb.types.push(e[u]);i(this,t,r)}},applyType:function(n,t){if(this.setPaintStyle(n.paintStyle,t),this.setHoverPaintStyle(n.hoverPaintStyle,t),n.parameters)for(var i in n.parameters)this.setParameter(i,n.parameters[i])},setPaintStyle:function(n,t){this._jsPlumb.paintStyle=n;this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle;c(this);t||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(n,t){this._jsPlumb.hoverPaintStyle=n;c(this);t||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},destroy:function(){this.cleanupListeners();this.clone=null;this._jsPlumb=null},isHover:function(){return this._jsPlumb.hover},setHover:function(n,t,i){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){if(this._jsPlumb.hover=n,this.canvas!=null){if(this._jsPlumb.instance.hoverClass!=null){var u=n?"addClass":"removeClass";this._jsPlumb.instance[u](this.canvas,this._jsPlumb.instance.hoverClass)}this._jsPlumb.hoverClass!=null&&this._jsPlumb.instance[u](this.canvas,this._jsPlumb.hoverClass)}this._jsPlumb.hoverPaintStyle!=null&&(this._jsPlumb.paintStyleInUse=n?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(i=i||r(),this.repaint({timestamp:i,recalc:!1})));this.getAttachedElements&&!t&&w(this,n,r(),this)}}});var e="__label",a=function(n,t){for(var r=-1,i=0,u=n._jsPlumb.overlays.length;i<u;i++)if(t===n._jsPlumb.overlays[i].id){r=i;break}return r},v=function(t,i){var r={cssClass:i.cssClass,labelStyle:t.labelStyle,id:e,component:t,_jsPlumb:t._jsPlumb.instance},u=n.extend(r,i);return new n.Overlays[t._jsPlumb.instance.getRenderMode()].Label(u)},y=function(i,r){var u=null,e,f;t.isArray(r)?(e=r[0],f=n.extend({component:i,_jsPlumb:i._jsPlumb.instance},r[1]),r.length==3&&n.extend(f,r[2]),u=new n.Overlays[i._jsPlumb.instance.getRenderMode()][e](f)):u=r.constructor==String?new n.Overlays[i._jsPlumb.instance.getRenderMode()][r]({component:i,_jsPlumb:i._jsPlumb.instance}):r;i._jsPlumb.overlays.push(u)},b=function(t,i){var f=t.defaultOverlayKeys||[],r=i.overlays,o=function(i){return t._jsPlumb.instance.Defaults[i]||n.Defaults[i]||[]},u,e;for(r||(r=[]),u=0,e=f.length;u<e;u++)r.unshift.apply(r,o(f[u]));return r},k=window.OverlayCapableJsPlumbUIComponent=function(n){var t,i,r,f,e;if(u.apply(this,arguments),this._jsPlumb.overlays=[],t=b(this,n),t)for(i=0,r=t.length;i<r;i++)y(this,t[i]);n.label&&(f=n.labelLocation||this.defaultLabelLocation||.5,e=n.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle,this._jsPlumb.overlays.push(v(this,{label:n.label,location:f,labelStyle:e})));this.setListenerComponent=function(n){if(this._jsPlumb)for(var t=0;t<this._jsPlumb.overlays.length;t++)this._jsPlumb.overlays[t].setListenerComponent(n)}};jsPlumbUtil.extend(k,u,{applyType:function(n,t){if(this.removeAllOverlays(t),n.overlays)for(var i=0,r=n.overlays.length;i<r;i++)this.addOverlay(n.overlays[i],!0)},setHover:function(n){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged())for(var t=0,i=this._jsPlumb.overlays.length;t<i;t++)this._jsPlumb.overlays[t][n?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)},addOverlay:function(n,t){y(this,n);t||this.repaint()},getOverlay:function(n){var t=a(this,n);return t>=0?this._jsPlumb.overlays[t]:null},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(n){var t=this.getOverlay(n);t&&t.hide()},hideOverlays:function(){for(var n=0,t=this._jsPlumb.overlays.length;n<t;n++)this._jsPlumb.overlays[n].hide()},showOverlay:function(n){var t=this.getOverlay(n);t&&t.show()},showOverlays:function(){for(var n=0,t=this._jsPlumb.overlays.length;n<t;n++)this._jsPlumb.overlays[n].show()},removeAllOverlays:function(n){for(var t=0,i=this._jsPlumb.overlays.length;t<i;t++)this._jsPlumb.overlays[t].cleanup&&this._jsPlumb.overlays[t].cleanup();this._jsPlumb.overlays.splice(0,this._jsPlumb.overlays.length);this._jsPlumb.overlayPositions=null;n||this.repaint()},removeOverlay:function(n){var t=a(this,n),i;t!=-1&&(i=this._jsPlumb.overlays[t],i.cleanup&&i.cleanup(),this._jsPlumb.overlays.splice(t,1),this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[n])},removeOverlays:function(){for(var n=0,t=arguments.length;n<t;n++)this.removeOverlay(arguments[n])},moveParent:function(n){this.bgCanvas&&(this.bgCanvas.parentNode.removeChild(this.bgCanvas),n.appendChild(this.bgCanvas));this.canvas.parentNode.removeChild(this.canvas);n.appendChild(this.canvas);for(var t=0;t<this._jsPlumb.overlays.length;t++)this._jsPlumb.overlays[t].isAppendedAtTopLevel&&(this._jsPlumb.overlays[t].canvas.parentNode.removeChild(this._jsPlumb.overlays[t].canvas),n.appendChild(this._jsPlumb.overlays[t].canvas))},getLabel:function(){var n=this.getOverlay(e);return n!=null?n.getLabel():null},getLabelOverlay:function(){return this.getOverlay(e)},setLabel:function(n){var t=this.getOverlay(e),i;t?n.constructor==String||n.constructor==Function?t.setLabel(n):(n.label&&t.setLabel(n.label),n.location&&t.setLocation(n.location)):(i=n.constructor==String||n.constructor==Function?{label:n}:n,t=v(this,i),this._jsPlumb.overlays.push(t));this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(){for(var n=0;n<this._jsPlumb.overlays.length;n++)this._jsPlumb.overlays[n].cleanup(),this._jsPlumb.overlays[n].destroy();this._jsPlumb.overlays.length=0;this._jsPlumb.overlayPositions=null},setVisible:function(n){this[n?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(n,t){this._jsPlumb.overlayPositions=this._jsPlumb.overlayPositions||{};this._jsPlumb.overlayPositions[n.id]=t},getAbsoluteOverlayPosition:function(n){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[n.id]:null}});var p=0,d=function(){var n=p+1;return p++,n},h=window.jsPlumbInstance=function(i){var bt,y,gi,ri,ui,nr,fi,ei,ot,oi,hi,ir,pt,wt,ht,ct,rr,ci;this.Defaults={Anchor:"Bottom",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fillStyle:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{lineWidth:4,strokeStyle:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"};i&&n.extend(this.Defaults,i);this.logEnabled=this.Defaults.LogEnabled;this._connectionTypes={};this._endpointTypes={};jsPlumbUtil.EventGenerator.apply(this);var f=this,li=d(),ur=f.bind,ai={},lt=1,h=function(n){var t=f.getDOMElement(n);return{el:t,id:jsPlumbUtil.isString(n)&&t==null?n:c(t)}};this.getInstanceIndex=function(){return li};this.setZoom=function(n,t){return jsPlumbUtil.oldIE||(lt=n,f.fire("zoom",lt),t&&f.repaintEverything()),!jsPlumbUtil.oldIE};this.getZoom=function(){return lt};for(bt in this.Defaults)ai[bt]=this.Defaults[bt];this.setContainer=function(n){var t,r,i;for(n=this.getDOMElement(n),this.select().each(function(t){t.moveParent(n)}),this.selectEndpoints().each(function(t){t.moveParent(n)}),y=n,t=function(n,t){var i=t.srcElement||t.target,r=(i&&i.parentNode?i.parentNode._jsPlumb:null)||(i?i._jsPlumb:null)||(i&&i.parentNode&&i.parentNode.parentNode?i.parentNode.parentNode._jsPlumb:null);r&&(r.fire(n,r,t),f.fire(n,r,t))},r=function(n){f.on(y,n,"._jsPlumb_connector, ._jsPlumb_connector > *",function(i){t(n,i)});f.on(y,n,"._jsPlumb_endpoint, ._jsPlumb_endpoint > *, ._jsPlumb_endpoint svg *",function(i){t(n,i)});f.on(y,n,"._jsPlumb_overlay, ._jsPlumb_overlay *",function(i){t(n,i)})},i=0;i<l.length;i++)r(l[i])};this.getContainer=function(){return y};this.bind=function(n,t){"ready"===n&&kt?t():ur.apply(f,[n,t])};f.importDefaults=function(n){for(var t in n)f.Defaults[t]=n[t];return n.Container&&f.setContainer(n.Container),f};f.restoreDefaults=function(){return f.Defaults=n.extend({},ai),f};var vi=null,kt=!1,p=[],e={},w={},a={},s={},dt={},nt={},yi=!1,v=[],tt=!1,b=null,pi=this.Defaults.Scope,gt=null,fr=1,ut=function(){return""+fr++},er=function(n,t){y?y.appendChild(n):t?this.getDOMElement(t).appendChild(n):this.appendToRoot(n)}.bind(this),it=function(n,t,i,u){var o,e,h,s,l;if(!jsPlumbAdapter.headless&&!tt){if(o=c(n),e=f.dragManager.getElementsForDraggable(o),i==null&&(i=r()),h=st({elId:o,offset:t,recalc:!1,timestamp:i}),e)for(s in e)st({elId:e[s].id,offset:{left:h.o.left+e[s].offset.left,top:h.o.top+e[s].offset.top},recalc:!1,timestamp:i});if(f.anchorManager.redraw(o,t,i,null,u),e)for(l in e)f.anchorManager.redraw(e[l].id,t,i,e[l].offset,u,!0)}},wi=function(n,i){var u=null,r,e,s,o,h;if(t.isArray(n))for(u=[],o=0,h=n.length;o<h;o++)r=f.getElementObject(n[o]),s=f.getDOMElement(r),e=f.getAttribute(s,"id"),u.push(i.apply(f,[s,e]));else r=f.getDOMElement(n),e=f.getId(r),u=i.apply(f,[r,e]);return u},ft=function(n){return w[n]},bi=function(i,r,u,e){var v,o,l,a;if(!jsPlumbAdapter.headless&&(v=r==null?!1:r,v&&n.isDragSupported(i,f)&&!n.isAlreadyDraggable(i,f))){o=u||f.Defaults.DragOptions;o=n.extend({},o);var y=n.dragEvents.drag,p=n.dragEvents.stop,w=n.dragEvents.start,d=f.getDOMElement(i),b=f.dragManager.getDragAncestor(d),k={left:0,top:0},s=k,h=!1;si(e,i);o[w]=t.wrap(o[w],function(){return s=b!=null?jsPlumbAdapter.getOffset(b,f):k,f.setHoverSuspended(!0),f.select({source:i}).addClass(f.elementDraggingClass+" "+f.sourceElementDraggingClass,!0),f.select({target:i}).addClass(f.elementDraggingClass+" "+f.targetElementDraggingClass,!0),f.setConnectionBeingDragged(!0),o.canDrag?u.canDrag():void 0},!1);o[y]=t.wrap(o[y],function(){var n=f.getUIPosition(arguments,f.getZoom());n.left+=s.left;n.top+=s.top;it(i,n,null,!0);h&&f.addClass(i,"jsPlumb_dragged");h=!0});o[p]=t.wrap(o[p],function(){var n=f.getUIPosition(arguments,f.getZoom(),!0);it(i,n);h=!1;f.removeClass(i,"jsPlumb_dragged");f.setHoverSuspended(!1);f.select({source:i}).removeClass(f.elementDraggingClass+" "+f.sourceElementDraggingClass,!0);f.select({target:i}).removeClass(f.elementDraggingClass+" "+f.targetElementDraggingClass,!0);f.setConnectionBeingDragged(!1);f.dragManager.dragEnded(i)});l=c(i);nt[l]=!0;a=nt[l];o.disabled=a==null?!1:!a;f.initDraggable(i,o);f.dragManager.register(i)}},or=function(n,t){for(var i,u=n.scope.split(/\s/),f=t.scope.split(/\s/),r=0;r<u.length;r++)for(i=0;i<f.length;i++)if(f[i]==u[r])return!0;return!1},sr=function(i,r){var u=n.extend({},i),e,o;if(r&&n.extend(u,r),u.source&&(u.source.endpoint?u.sourceEndpoint=u.source:u.source=f.getDOMElement(u.source)),u.target&&(u.target.endpoint?u.targetEndpoint=u.target:u.target=f.getDOMElement(u.target)),i.uuids&&(u.sourceEndpoint=ft(i.uuids[0]),u.targetEndpoint=ft(i.uuids[1])),u.sourceEndpoint&&u.sourceEndpoint.isFull()){t.log(f,"could not add connection; source endpoint is full");return}if(u.targetEndpoint&&u.targetEndpoint.isFull()){t.log(f,"could not add connection; target endpoint is full");return}if(!u.type&&u.sourceEndpoint&&(u.type=u.sourceEndpoint.connectionType),u.sourceEndpoint&&u.sourceEndpoint.connectorOverlays)for(u.overlays=u.overlays||[],e=0,o=u.sourceEndpoint.connectorOverlays.length;e<o;e++)u.overlays.push(u.sourceEndpoint.connectorOverlays[e]);!u["pointer-events"]&&u.sourceEndpoint&&u.sourceEndpoint.connectorPointerEvents&&(u["pointer-events"]=u.sourceEndpoint.connectorPointerEvents);var h=function(t,i){var u=n.extend({},t);for(var r in i)i[r]&&(u[r]=i[r]);return u},l=function(n,t,i){return f.addEndpoint(n,h(t,{anchor:u.anchors?u.anchors[i]:u.anchor,endpoint:u.endpoints?u.endpoints[i]:u.endpoint,paintStyle:u.endpointStyles?u.endpointStyles[i]:u.endpointStyle,hoverPaintStyle:u.endpointHoverStyles?u.endpointHoverStyles[i]:u.endpointHoverStyle}))},s=function(n,t,i){var e,r,f;if(u[n]&&!u[n].endpoint&&!u[n+"Endpoint"]&&!u.newConnection&&(e=c(u[n]),r=i[e],r)){if(!r.enabled||(f=r.endpoint!=null&&r.endpoint._jsPlumb?r.endpoint:l(u[n],r.def,t),r.uniqueEndpoint&&(r.endpoint=f),f.isFull()))return!1;u[n+"Endpoint"]=f;f._doNotDeleteOnDetach=!1;f._deleteOnDetach=!0}};if(s("source",0,this.sourceEndpointDefinitions)!==!1)return s("target",1,this.targetEndpointDefinitions)===!1?void 0:(u.sourceEndpoint&&u.targetEndpoint&&(or(u.sourceEndpoint,u.targetEndpoint)||(u=null)),u)}.bind(f),ni=function(n){var i=f.Defaults.ConnectionType||f.getDefaultConnectionType(),t;return n._jsPlumb=f,n.newConnection=ni,n.newEndpoint=ti,n.endpointsByUUID=w,n.endpointsByElement=e,n.finaliseConnection=ki,t=new i(n),t.id="con_"+ut(),t.isDetachable()&&(t.endpoints[0].initDraggable(),t.endpoints[1].initDraggable()),t},ki=f.finaliseConnection=function(n,t,i,r){if(t=t||{},n.suspendedEndpoint||p.push(n),n.endpoints[0].isTemporarySource=!1,(n.suspendedEndpoint==null||r)&&f.anchorManager.newConnection(n),it(n.source),!t.doNotFireConnectionEvent&&t.fireEvent!==!1){var u={connection:n,source:n.source,target:n.target,sourceId:n.sourceId,targetId:n.targetId,sourceEndpoint:n.endpoints[0],targetEndpoint:n.endpoints[1]};f.fire("connection",u,i)}},ti=function(t,i){var o=f.Defaults.EndpointType||n.Endpoint,r=n.extend({},t),u;return r._jsPlumb=f,r.newConnection=ni,r.newEndpoint=ti,r.endpointsByUUID=w,r.endpointsByElement=e,r.fireDetachEvent=ui,r.elementId=i||c(r.source),u=new o(r),u.id="ep_"+ut(),si(r.elementId,r.source),jsPlumbAdapter.headless||f.dragManager.endpointAdded(r.source,i),u},ii=function(n,t,i){var r=e[n],u,o,f,s,h;if(r&&r.length)for(u=0,o=r.length;u<o;u++){for(f=0,s=r[u].connections.length;f<s;f++)if(h=t(r[u].connections[f]),h)return;i&&i(r[u])}},hr=function(n,t){return wi(n,function(n,i){nt[i]=t;this.isDragSupported(n)&&this.setElementDraggable(n,t)})},di=function(n,t,i){var r,u;t=t==="block";r=null;i&&(r=t?function(n){n.setVisible(!0,!0,!0)}:function(n){n.setVisible(!1,!0,!0)});u=h(n);ii(u.id,function(n){if(t&&i){var r=n.sourceId===u.id?1:0;n.endpoints[r].isVisible()&&n.setVisible(!0)}else n.setVisible(t)},r)},cr=function(n){return wi(n,function(n,t){var i=nt[t]==null?!1:nt[t];return i=!i,nt[t]=i,this.setDraggable(n,i),i}.bind(this))},lr=function(n,t){var i=null;t&&(i=function(n){var t=n.isVisible();n.setVisible(!t)});ii(n,function(n){var t=n.isVisible();n.setVisible(!t)},i)},ar=function(n){var t=s[n];return t?{o:t,s:v[n]}:st({elId:n})},c=function(n,t,i){if(jsPlumbUtil.isString(n))return n;if(n==null)return null;var r=f.getAttribute(n,"id");return r&&r!=="undefined"||(arguments.length==2&&arguments[1]!==undefined?r=t:arguments.length!=1&&(arguments.length!=3||arguments[2])||(r="jsPlumb_"+li+"_"+ut()),i||f.setAttribute(n,"id",r)),r};this.setConnectionBeingDragged=function(n){yi=n};this.isConnectionBeingDragged=function(){return yi};this.connectorClass="_jsPlumb_connector";this.hoverClass="_jsPlumb_hover";this.endpointClass="_jsPlumb_endpoint";this.endpointConnectedClass="_jsPlumb_endpoint_connected";this.endpointFullClass="_jsPlumb_endpoint_full";this.endpointDropAllowedClass="_jsPlumb_endpoint_drop_allowed";this.endpointDropForbiddenClass="_jsPlumb_endpoint_drop_forbidden";this.overlayClass="_jsPlumb_overlay";this.draggingClass="_jsPlumb_dragging";this.elementDraggingClass="_jsPlumb_element_dragging";this.sourceElementDraggingClass="_jsPlumb_source_element_dragging";this.targetElementDraggingClass="_jsPlumb_target_element_dragging";this.endpointAnchorClassPrefix="_jsPlumb_endpoint_anchor";this.hoverSourceClass="_jsPlumb_source_hover";this.hoverTargetClass="_jsPlumb_target_hover";this.dragSelectClass="_jsPlumb_drag_select";this.Anchors={};this.Connectors={svg:{},vml:{}};this.Endpoints={svg:{},vml:{}};this.Overlays={svg:{},vml:{}};this.ConnectorRenderers={};this.SVG="svg";this.VML="vml";this.addEndpoint=function(i,r,u){var o,h,y,l,p;for(u=u||{},o=n.extend({},u),n.extend(o,r),o.endpoint=o.endpoint||f.Defaults.Endpoint,o.paintStyle=o.paintStyle||f.Defaults.EndpointStyle,h=[],y=t.isArray(i)||i.length!=null&&!t.isString(i)?i:[i],l=0,p=y.length;l<p;l++){o.source=f.getDOMElement(y[l]);yt(o.source);var a=c(o.source),s=ti(o,a),w=si(a,o.source).info.o;t.addToList(e,a,s);tt||s.paint({anchorLoc:s.anchor.compute({xy:[w.left,w.top],wh:v[a],element:s,timestamp:b}),timestamp:b});h.push(s);s._doNotDeleteOnDetach=!0}return h.length==1?h[0]:h};this.addEndpoints=function(n,i,r){for(var u,e=[],o=0,s=i.length;o<s;o++)u=f.addEndpoint(n,i[o],r),t.isArray(u)?Array.prototype.push.apply(e,u):e.push(u);return e};this.animate=function(i,r,u){u=u||{};var h=f.getElementObject(i),l=f.getDOMElement(i),e=c(l),o=n.animEvents.step,s=n.animEvents.complete;u[o]=t.wrap(u[o],function(){f.revalidate(e)});u[s]=t.wrap(u[s],function(){f.revalidate(e)});f.doAnimate(h,r,u)};this.checkCondition=function(n,i){var r=f.getListener(n),e=!0,u,o;if(r&&r.length>0)try{for(u=0,o=r.length;u<o;u++)e=e&&r[u](i)}catch(s){t.log(f,"cannot check condition ["+n+"]"+s)}return e};this.connect=function(n,t){var i=sr(n,t),r;if(i){if(i.source==null&&i.sourceEndpoint==null){jsPlumbUtil.log("Cannot establish connection - source does not exist");return}if(i.target==null&&i.targetEndpoint==null){jsPlumbUtil.log("Cannot establish connection - target does not exist");return}yt(i.source);r=ni(i);ki(r,i)}return r};gi=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}];ri=function(t,i,r,u){var f,o=gi[r],l=t[o.elId],v=t[o.el],s,e,a=t.endpoints[r],h={index:r,originalSourceId:r===0?l:t.sourceId,newSourceId:t.sourceId,originalTargetId:r==1?l:t.targetId,newTargetId:t.targetId,connection:t};if(i.constructor==n.Endpoint)f=i,f.addConnection(t);else if(s=c(i),e=this[o.epDefs][s],s===t[o.elId])f=null;else if(e){if(!e.enabled)return;f=e.endpoint!=null&&e.endpoint._jsPlumb?e.endpoint:this.addEndpoint(i,e.def);e.uniqueEndpoint&&(e.endpoint=f);f._doNotDeleteOnDetach=!1;f._deleteOnDetach=!0;f.addConnection(t)}else f=t.makeEndpoint(r===0,i,s),f._doNotDeleteOnDetach=!1,f._deleteOnDetach=!0;return f!=null&&(a.detachFromConnection(t),t.endpoints[r]=f,t[o.el]=f.element,t[o.elId]=f.elementId,h[r===0?"newSourceId":"newTargetId"]=f.elementId,nr(h),u||t.repaint()),h}.bind(this);this.setSource=function(n,t,i){var r=ri(n,t,0,i);this.anchorManager.sourceChanged(r.originalSourceId,r.newSourceId,n)};this.setTarget=function(n,t,i){var r=ri(n,t,1,i);this.anchorManager.updateOtherEndpoint(r.originalSourceId,r.originalTargetId,r.newTargetId,n)};this.deleteEndpoint=function(n,t){var i=typeof n=="string"?w[n]:n;return i&&f.deleteObject({endpoint:i,dontUpdateHover:t}),f};this.deleteEveryEndpoint=function(){var u=f.setSuspendDrawing(!0),i,n,t,r;for(i in e)if(n=e[i],n&&n.length)for(t=0,r=n.length;t<r;t++)f.deleteEndpoint(n[t],!0);return e={},a={},w={},f.anchorManager.reset(),f.dragManager.reset(),u||f.setSuspendDrawing(!1),f};ui=function(n,t,i){var u=f.Defaults.ConnectionType||f.getDefaultConnectionType(),e=n.constructor==u,r=e?{connection:n,source:n.source,target:n.target,sourceId:n.sourceId,targetId:n.targetId,sourceEndpoint:n.endpoints[0],targetEndpoint:n.endpoints[1]}:n;t&&f.fire("connectionDetached",r,i);f.anchorManager.connectionDetached(r)};nr=f.fireMoveEvent=function(n,t){f.fire("connectionMoved",n,t)};this.unregisterEndpoint=function(n){var t,i,u,r,o;n._jsPlumb.uuid&&(w[n._jsPlumb.uuid]=null);f.anchorManager.deleteEndpoint(n);for(t in e){if(i=e[t],i){for(u=[],r=0,o=i.length;r<o;r++)i[r]!=n&&u.push(i[r]);e[t]=u}e[t].length<1&&delete e[t]}};this.detach=function(){var i,u,o;if(arguments.length!==0){var h=f.Defaults.ConnectionType||f.getDefaultConnectionType(),s=arguments[0].constructor==h,r=arguments.length==2?s?arguments[1]||{}:arguments[0]:arguments[0],e=r.fireEvent!==!1,l=r.forceDetach,t=s?arguments[0]:r.connection;t?(l||jsPlumbUtil.functionChain(!0,!1,[[t.endpoints[0],"isDetachAllowed",[t]],[t.endpoints[1],"isDetachAllowed",[t]],[t,"isDetachAllowed",[t]],[f,"checkCondition",["beforeDetach",t]]]))&&t.endpoints[0].detach(t,!1,!0,e):(i=n.extend({},r),i.uuids?ft(i.uuids[0]).detachFrom(ft(i.uuids[1]),e):i.sourceEndpoint&&i.targetEndpoint?i.sourceEndpoint.detachFrom(i.targetEndpoint):(u=c(f.getDOMElement(i.source)),o=c(f.getDOMElement(i.target)),ii(u,function(n){(n.sourceId==u&&n.targetId==o||n.targetId==u&&n.sourceId==o)&&f.checkCondition("beforeDetach",n)&&n.endpoints[0].detach(n,!1,!0,e)})))}};this.detachAllConnections=function(n,t){var u,i,r,o;if(t=t||{},n=f.getDOMElement(n),u=c(n),i=e[u],i&&i.length)for(r=0,o=i.length;r<o;r++)i[r].detachAll(t.fireEvent!==!1);return f};this.detachEveryConnection=function(n){return n=n||{},f.doWhileSuspended(function(){var r,t,i,u;for(r in e)if(t=e[r],t&&t.length)for(i=0,u=t.length;i<u;i++)t[i].detachAll(n.fireEvent!==!1);p.length=0}),f};this.deleteObject=function(n){var t={endpoints:{},connections:{},endpointCount:0,connectionCount:0},c=n.fireEvent!==!1,u=n.deleteAttachedObjects!==!1,e=function(i){if(i!=null&&t.connections[i.id]==null&&(n.dontUpdateHover||i._jsPlumb==null||i.setHover(!1),t.connections[i.id]=i,t.connectionCount++,u))for(var r=0;r<i.endpoints.length;r++)i.endpoints[r]._deleteOnDetach&&o(i.endpoints[r])},o=function(i){var r,f;if(i!=null&&t.endpoints[i.id]==null&&(n.dontUpdateHover||i._jsPlumb==null||i.setHover(!1),t.endpoints[i.id]=i,t.endpointCount++,u))for(r=0;r<i.connections.length;r++)f=i.connections[r],e(f)},s,i,h,r;n.connection?e(n.connection):o(n.endpoint);for(s in t.connections)i=t.connections[s],i._jsPlumb&&(jsPlumbUtil.removeWithFunction(p,function(n){return i.id==n.id}),ui(i,c,n.originalEvent),i.endpoints[0].detachFromConnection(i),i.endpoints[1].detachFromConnection(i),i.cleanup(),i.destroy());for(h in t.endpoints)r=t.endpoints[h],r._jsPlumb&&(f.unregisterEndpoint(r),r.cleanup(),r.destroy());return t};this.draggable=function(n,t){var r,u,i;if(typeof n=="object"&&n.length)for(r=0,u=n.length;r<u;r++)i=h(n[r]),i.el&&bi(i.el,!0,t,i.id);else i=h(n),i.el&&bi(i.el,!0,t,i.id);return f};var vr=function(n,t,i,r){for(var u=0,f=n.length;u<f;u++)n[u][t].apply(n[u],i);return r(n)},yr=function(n,t,i){for(var u=[],r=0,f=n.length;r<f;r++)u.push([n[r][t].apply(n[r],i),n[r]]);return u},rt=function(n,t,i){return function(){return vr(n,t,arguments,i)}},at=function(n,t){return function(){return yr(n,t,arguments)}},k=function(n,t){var i=[],r,u;if(n)if(typeof n=="string"){if(n==="*")return n;i.push(n)}else if(t)i=n;else if(n.length)for(r=0,u=n.length;r<u;r++)i.push(h(n[r]).id);else i.push(h(n).id);return i},g=function(n,t,i){return n==="*"?!0:n.length>0?jsPlumbUtil.indexOf(n,t)!=-1:!i};this.getConnections=function(n,t){var u,o,i;n?n.constructor==String&&(n={scope:n}):n={};var s=n.scope||f.getDefaultScope(),e=k(s,!0),h=k(n.source),c=k(n.target),r=!t&&e.length>1?{}:[],l=function(n,i){if(!t&&e.length>1){var u=r[n];u==null&&(u=r[n]=[]);u.push(i)}else r.push(i)};for(u=0,o=p.length;u<o;u++)i=p[u],g(e,i.scope)&&g(h,i.sourceId)&&g(c,i.targetId)&&l(i.scope,i);return r};var pr=function(n,t){return function(i){for(var r=0,u=n.length;r<u;r++)i(n[r]);return t(n)}},wr=function(n){return function(t){return n[t]}},tr=function(n,t){for(var u={length:n.length,each:pr(n,t),get:wr(n)},f=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],e=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"],i=0,r=f.length;i<r;i++)u[f[i]]=rt(n,f[i],t);for(i=0,r=e.length;i<r;i++)u[e[i]]=at(n,e[i]);return u},et=function(t){var i=tr(t,et);return n.extend(i,{setDetachable:rt(t,"setDetachable",et),setReattach:rt(t,"setReattach",et),setConnector:rt(t,"setConnector",et),detach:function(){for(var n=0,i=t.length;n<i;n++)f.detach(t[n])},isDetachable:at(t,"isDetachable"),isReattach:at(t,"isReattach")})},vt=function(t){var i=tr(t,vt);return n.extend(i,{setEnabled:rt(t,"setEnabled",vt),setAnchor:rt(t,"setAnchor",vt),isEnabled:at(t,"isEnabled"),detachAll:function(){for(var n=0,i=t.length;n<i;n++)t[n].detachAll()},remove:function(){for(var n=0,i=t.length;n<i;n++)f.deleteObject({endpoint:t[n]})}})};this.select=function(n){return n=n||{},n.scope=n.scope||"*",et(n.connections||f.getConnections(n,!0))};this.selectEndpoints=function(n){var t,r,h,i,c,l;n=n||{};n.scope=n.scope||"*";var u=!n.element&&!n.source&&!n.target,a=u?"*":k(n.element),f=u?"*":k(n.source),o=u?"*":k(n.target),v=k(n.scope,!0),s=[];for(t in e){var y=g(a,t,!0),p=g(f,t,!0),w=f!="*",b=g(o,t,!0),d=o!="*";if(y||p||b)n:for(r=0,h=e[t].length;r<h;r++)if(i=e[t][r],g(v,i.scope,!0)){if(c=w&&f.length>0&&!i.isSource,l=d&&o.length>0&&!i.isTarget,c||l)continue n;s.push(i)}}return vt(s)};this.getAllConnections=function(){return p};this.getDefaultScope=function(){return pi};this.getEndpoint=ft;this.getEndpoints=function(n){return e[h(n).id]};this.getDefaultEndpointType=function(){return n.Endpoint};this.getDefaultConnectionType=function(){return n.Connection};this.getId=c;this.getOffset=function(n){return st({elId:n}).o};this.appendElement=er;fi=!1;this.isHoverSuspended=function(){return fi};this.setHoverSuspended=function(n){fi=n};ei=function(n){return function(){return jsPlumbAdapter.isRenderModeAvailable(n)}};this.isSVGAvailable=ei("svg");this.isVMLAvailable=ei("vml");this.hide=function(n,t){return di(n,"none",t),f};this.idstamp=ut;this.connectorsInitialized=!1;ot=[];oi=["svg","vml"];this.registerConnectorType=function(n,t){ot.push([n,t])};var yt=function(n){if(!y&&n){var t=f.getDOMElement(n);t.offsetParent&&f.setContainer(t.offsetParent)}},br=function(){f.Defaults.Container&&f.setContainer(f.Defaults.Container)},si=f.manage=function(n,t){return a[n]||(a[n]={el:t,endpoints:[],connections:[]},a[n].info=st({elId:n,timestamp:b})),a[n]},kr=function(n){delete a[n]},st=this.updateOffset=function(n){var r=n.timestamp,u=n.recalc,e=n.offset,t=n.elId,i;return(tt&&!r&&(r=b),!u&&r&&r===dt[t])?{o:n.offset||s[t],s:v[t]}:(u||!e&&s[t]==null?(i=a[t]?a[t].el:null,i!=null&&(v[t]=f.getSize(i),s[t]=o(i,f),dt[t]=r)):(s[t]=e||s[t],v[t]==null&&(i=a[t].el,i!=null&&(v[t]=f.getSize(i))),dt[t]=r),s[t]&&!s[t].right&&(s[t].right=s[t].left+v[t][0],s[t].bottom=s[t].top+v[t][1],s[t].width=v[t][0],s[t].height=v[t][1],s[t].centerx=s[t].left+s[t].width/2,s[t].centery=s[t].top+s[t].height/2),{o:s[t],s:v[t]})};this.init=function(){var r=function(t,i,r){n.Connectors[t][i]=function(){r.apply(this,arguments);n.ConnectorRenderers[t].apply(this,arguments)};jsPlumbUtil.extend(n.Connectors[t][i],[r,n.ConnectorRenderers[t]])},t,i;if(!n.connectorsInitialized){for(t=0;t<ot.length;t++)for(i=0;i<oi.length;i++)r(oi[i],ot[t][1],ot[t][0]);n.connectorsInitialized=!0}kt||(br(),f.anchorManager=new n.AnchorManager({jsPlumbInstance:f}),f.setRenderMode(f.Defaults.RenderMode),kt=!0,f.fire("ready",f))}.bind(this);this.log=vi;this.jsPlumbUIComponent=u;this.makeAnchor=function(){var e,s=function(t,i){if(n.Anchors[t])return new n.Anchors[t](i);if(!f.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+t+"'"};},o;if(arguments.length===0)return null;var i=arguments[0],u=arguments[1],h=arguments[2],r=null;return i.compute&&i.getOrientation?i:(typeof i=="string"?r=s(arguments[0],{elementId:u,jsPlumbInstance:f}):t.isArray(i)&&(t.isArray(i[0])||t.isString(i[0])?i.length==2&&t.isObject(i[1])?t.isString(i[0])?(e=n.extend({elementId:u,jsPlumbInstance:f},i[1]),r=s(i[0],e)):(e=n.extend({elementId:u,jsPlumbInstance:f,anchors:i[0]},i[1]),r=new n.DynamicAnchor(e)):r=new n.DynamicAnchor({anchors:i,selector:null,elementId:u,jsPlumbInstance:f}):(o={x:i[0],y:i[1],orientation:i.length>=4?[i[2],i[3]]:[0,0],offsets:i.length>=6?[i[4],i[5]]:[0,0],elementId:u,jsPlumbInstance:f,cssClass:i.length==7?i[6]:null},r=new n.Anchor(o),r.clone=function(){return new n.Anchor(o)})),r.id||(r.id="anchor_"+ut()),r)};this.makeAnchors=function(i,r,u){for(var o=[],e=0,s=i.length;e<s;e++)typeof i[e]=="string"?o.push(n.Anchors[i[e]]({elementId:r,jsPlumbInstance:u})):t.isArray(i[e])&&o.push(f.makeAnchor(i[e],r,u));return o};this.makeDynamicAnchor=function(t,i){return new n.DynamicAnchor({anchors:t,selector:i,elementId:null,jsPlumbInstance:f})};this.targetEndpointDefinitions={};hi=function(n,t,i){n.paintStyle=n.paintStyle||i.Defaults.EndpointStyles[t]||i.Defaults.EndpointStyle;n.hoverPaintStyle=n.hoverPaintStyle||i.Defaults.EndpointHoverStyles[t]||i.Defaults.EndpointHoverStyle;n.anchor=n.anchor||i.Defaults.Anchors[t]||i.Defaults.Anchor;n.endpoint=n.endpoint||i.Defaults.Endpoints[t]||i.Defaults.Endpoint};this.sourceEndpointDefinitions={};ir=function(n,t,i,r,u){for(var s=n.target||n.srcElement,f=!1,o=r.getSelector(t,i),e=0;e<o.length;e++)if(o[e]==s){f=!0;break}return u?!f:f};this.makeTarget=function(i,r,e){var s=n.extend({_jsPlumb:this},e),c,v;n.extend(s,r);hi(s,1,this);var y=s.scope||f.Defaults.Scope,b=!(s.deleteEndpointsOnDetach===!1),p=s.maxConnections||-1,l=s.onMaxConnections,w=function(i){var r=h(i),c=r.id,w=new u(s),e=n.extend({},s.dropOptions||{}),a,b,v;yt(c);a={def:s,uniqueEndpoint:s.uniqueEndpoint,maxConnections:p,enabled:!0};r.el._jsPlumbTarget=a;this.targetEndpointDefinitions[c]=a;b=s._jsPlumb.EndpointDropHandler({jsPlumb:f,enabled:function(){return r.el._jsPlumbTarget.enabled},isFull:function(n){var u=f.select({target:c}).length,t=r.el._jsPlumbTarget,i=t.maxConnections>0&&u>=t.maxConnections;return i&&l&&l({element:r.el,connection:jpc},n),i},element:r.el,elementId:c,isSource:!1,isTarget:!0,addClass:function(n){f.addClass(r.el,n)},removeClass:function(n){f.removeClass(r.el,n)},onDrop:function(n){var t=n.endpoints[0];t.anchor.locked=!1},isDropAllowed:function(){return w.isDropAllowed.apply(w,arguments)},getEndpoint:function(n){var i=f.getElementObject(r.el),u=r.el._jsPlumbTarget,t=u.endpoint;if((t==null||t._jsPlumb==null)&&(t=f.addEndpoint(i,s)),s.uniqueEndpoint&&(u.endpoint=t),t._doNotDeleteOnDetach=!1,t._deleteOnDetach=!0,n.isDetachable()&&t.initDraggable(),t.anchor.positionFinder!=null){var h=f.getUIPosition(arguments,this.getZoom()),c=o(i,this),l=f.getSize(i),e=t.anchor.positionFinder(h,c,l,t.anchor.constructorParams);t.anchor.x=e[0];t.anchor.y=e[1]}return t}});v=n.dragEvents.drop;e.scope=e.scope||y;e[v]=t.wrap(e[v],b);s.allowLoopback===!1&&(e.canDrop=function(n){var t=n.getDragElement()._jsPlumbRelatedElement;return t!=r.el});this.initDroppable(this.getElementObject(r.el),e,"internal")}.bind(this),a=i.length&&i.constructor!=String?i:[i];for(c=0,v=a.length;c<v;c++)w(a[c]);return this};this.unmakeTarget=function(t,i){var r=h(t);return n.destroyDroppable(r.el),i||delete this.targetEndpointDefinitions[r.id],this};this.makeSource=function(i,r,u){var e=n.extend({},u),s,v;n.extend(e,r);hi(e,0,this);var c=e.maxConnections||1,l=e.onMaxConnections,p=function(i){var a=i.id,u=this.getElementObject(i.el),nt=this.getDOMElement(u),p=function(){return e.parent==null?null:e.parent==="parent"?i.el.parentNode:f.getDOMElement(e.parent)},h=e.parent!=null?this.getId(p()):a,w;yt(h);this.sourceEndpointDefinitions[h]={def:e,uniqueEndpoint:e.uniqueEndpoint,maxConnections:c,enabled:!0};var b=n.dragEvents.stop,k=n.dragEvents.drag,s=n.extend({},e.dragOptions||{}),d=s.drag,g=s.stop,r=null,v=!1;s.scope=s.scope||e.scope;s[k]=t.wrap(s[k],function(){d&&d.apply(this,arguments);v=!1});s[b]=t.wrap(s[b],function(){var u,c;if(g&&g.apply(this,arguments),this.currentlyDragging=!1,r._jsPlumb!=null){var l=e.anchor||this.Defaults.Anchor,f=r.anchor,v=r.connections[0],n=this.makeAnchor(l,a,this),s=r.element;if(n.positionFinder!=null){var t=o(s,this),i=this.getSize(s),w={left:t.left+f.x*i[0],top:t.top+f.y*i[1]},h=n.positionFinder(w,t,i,n.constructorParams);n.x=h[0];n.y=h[1]}r.setAnchor(n,!0);e.parent&&(u=p(),u&&(c=e.container||y,r.setElement(u,c)));r.repaint();this.repaint(r.elementId);this.repaint(v.targetId)}}.bind(this));w=function(t){var w=this.getOriginalEvent(t),i,k,d,y;if(t.which!==3&&t.button!==2&&(i=this.sourceEndpointDefinitions[h],a=this.getId(this.getDOMElement(u)),i.enabled)&&(!e.filter||(k=jsPlumbUtil.isString(e.filter)?ir(w,u,e.filter,this,e.filterExclude):e.filter(w,u),k!==!1))){if(d=this.select({source:h}).length,i.maxConnections>=0&&i.uniqueEndpoint&&d>=i.maxConnections)return l&&l({element:u,maxConnections:c},t),!1;var b=jsPlumbAdapter.getPositionOnElement(w,nt,lt),g=b,o={};n.extend(o,e);o.isTemporarySource=!0;o.anchor=[b[0],b[1],0,0];o.dragOptions=s;r=this.addEndpoint(a,o);v=!0;r.endpointWillMoveTo=e.parent?p():null;i.uniqueEndpoint&&(i.endpoint?r.finalEndpoint=i.endpoint:i.endpoint=r);r._doNotDeleteOnDetach=!1;r._deleteOnDetach=!0;y=function(){f.off(r.canvas,"mouseup",y);f.off(u,"mouseup",y);v&&(v=!1,f.deleteEndpoint(r))};f.on(r.canvas,"mouseup",y);f.on(u,"mouseup",y);f.trigger(r.canvas,"mousedown",t);jsPlumbUtil.consume(t)}}.bind(this);this.on(u,"mousedown",w);this.sourceEndpointDefinitions[h].trigger=w;e.filter&&jsPlumbUtil.isString(e.filter)&&f.setDragFilter(u,e.filter)}.bind(this),a=i.length&&i.constructor!=String?i:[i];for(s=0,v=a.length;s<v;s++)p(h(a[s]));return this};this.unmakeSource=function(n,t){var i=h(n),r=this.sourceEndpointDefinitions[i.id].trigger;return r&&f.off(i.el,"mousedown",r),t||delete this.sourceEndpointDefinitions[i.id],this};this.unmakeEverySource=function(){for(var n in this.sourceEndpointDefinitions)f.unmakeSource(n,!0);return this.sourceEndpointDefinitions={},this};pt=function(n,t){var u,i,r;for(t=jsPlumbUtil.isArray(t)?t:[t],u=c(n),i=0;i<t.length;i++)if(r=this[t[i]][u],r)return r.def.scope||this.Defaults.Scope}.bind(this);wt=function(n,t,i){var u,r,f;for(i=jsPlumbUtil.isArray(i)?i:[i],u=c(n),r=0;r<i.length;r++)f=this[i[r]][u],f&&(f.def.scope=t,this.scopeChange!=null&&this.scopeChange(n,u,e[u],t,i[r]))}.bind(this);this.getScope=function(n){return pt(n,["sourceEndpointDefinitions","targetEndpointDefinitions"])};this.getSourceScope=function(n){return pt(n,"sourceEndpointDefinitions")};this.getTargetScope=function(n){return pt(n,"targetEndpointDefinitions")};this.setScope=function(n,t){wt(n,t,["sourceEndpointDefinitions","targetEndpointDefinitions"])};this.setSourceScope=function(n,t){wt(n,t,"sourceEndpointDefinitions")};this.setTargetScope=function(n,t){wt(n,t,"targetEndpointDefinitions")};this.unmakeEveryTarget=function(){for(var n in this.targetEndpointDefinitions)f.unmakeTarget(n,!0);return this.targetEndpointDefinitions={},this};ht=function(n,i,r,u){var f=n=="source"?this.sourceEndpointDefinitions:this.targetEndpointDefinitions,e,c,o,s;if(t.isString(i))f[i].enabled=u?!f[i].enabled:r;else if(i.length)for(e=0,c=i.length;e<c;e++)o=h(i[e]),f[o.id]&&(f[o.id].enabled=u?!f[o.id].enabled:r);else s=h(i).id,f[s].enabled=u?!f[s].enabled:r;return this}.bind(this);ct=function(n,i){return t.isString(n)||!n.length?i.apply(this,[n]):n.length?i.apply(this,[n[0]]):void 0}.bind(this);this.toggleSourceEnabled=function(n){return ht("source",n,null,!0),this.isSourceEnabled(n)};this.setSourceEnabled=function(n,t){return ht("source",n,t)};this.isSource=function(n){return ct(n,function(n){return this.sourceEndpointDefinitions[h(n).id]!=null}.bind(this))};this.isSourceEnabled=function(n){return ct(n,function(n){var t=this.sourceEndpointDefinitions[h(n).id];return t&&t.enabled===!0}.bind(this))};this.toggleTargetEnabled=function(n){return ht("target",n,null,!0),this.isTargetEnabled(n)};this.isTarget=function(n){return ct(n,function(n){return this.targetEndpointDefinitions[h(n).id]!=null}.bind(this))};this.isTargetEnabled=function(n){return ct(n,function(n){var t=this.targetEndpointDefinitions[h(n).id];return t&&t.enabled===!0}.bind(this))};this.setTargetEnabled=function(n,t){return ht("target",n,t)};this.ready=function(n){f.bind("ready",n)};this.repaint=function(n,t,i){if(typeof n=="object"&&n.length)for(var r=0,u=n.length;r<u;r++)it(n[r],t,i);else it(n,t,i);return f};this.revalidate=function(n){var t=f.getId(n);return f.updateOffset({elId:t,recalc:!0}),f.repaint(n)};this.repaintEverything=function(n){var i=r();for(var t in e)f.updateOffset({elId:t,recalc:!0,timestamp:i});for(t in e)it(t,null,i,n);return this};this.removeAllEndpoints=function(n,t){var i=function(n){var u=h(n),s=e[u.id],r,o;if(s)for(r=0,o=s.length;r<o;r++)f.deleteEndpoint(s[r]);if(delete e[u.id],t&&u.el&&u.el.nodeType!=3&&u.el.nodeType!=8)for(r=0,o=u.el.childNodes.length;r<o;r++)i(u.el.childNodes[r])};return i(n),this};this.remove=function(n,t){var i=h(n);return f.doWhileSuspended(function(){f.removeAllEndpoints(i.id,!0);f.dragManager.elementRemoved(i.id);delete f.floatingConnections[i.id];f.anchorManager.clearFor(i.id);f.anchorManager.removeFloatingConnection(i.id)},t===!1),kr(i.id),i.el&&(f.removeElement(i.el),i.el._jsPlumb=null),f};this.reset=function(){f.setSuspendEvents(!0);f.deleteEveryEndpoint();f.unbind();this.targetEndpointDefinitions={};this.sourceEndpointDefinitions={};p.length=0;f.setSuspendEvents(!1)};rr=function(n){n.canvas&&n.canvas.parentNode&&n.canvas.parentNode.removeChild(n.canvas);n.cleanup();n.destroy()};ci=function(n){rr(n)};this.clear=function(){f.select().each(ci);f.selectEndpoints().each(ci);e={};w={}};this.setDefaultScope=function(n){return pi=n,f};this.setDraggable=hr;this.setId=function(n,t,i){var r,o,s,u,h,f;for(jsPlumbUtil.isString(n)?r=n:(n=this.getDOMElement(n),r=this.getId(n)),o=this.getConnections({source:r,scope:"*"},!0),s=this.getConnections({target:r,scope:"*"},!0),t=""+t,i?n=this.getDOMElement(t):(n=this.getDOMElement(r),this.setAttribute(n,"id",t)),e[t]=e[r]||[],u=0,h=e[t].length;u<h;u++)e[t][u].setElementId(t),e[t][u].setReferenceElement(n);delete e[r];this.anchorManager.changeId(r,t);this.dragManager&&this.dragManager.changeId(r,t);a[t]=a[r];delete a[r];f=function(i,r,u){for(var f=0,e=i.length;f<e;f++)i[f].endpoints[r].setElementId(t),i[f].endpoints[r].setReferenceElement(n),i[f][u+"Id"]=t,i[f][u]=n};f(o,0,"source");f(s,1,"target");this.repaint(t)};this.setDebugLog=function(n){vi=n};this.setSuspendDrawing=function(n,t){var i=tt;return tt=n,b=n?(new Date).getTime():null,t&&this.repaintEverything(),i};this.isSuspendDrawing=function(){return tt};this.getSuspendedAt=function(){return b};this.doWhileSuspended=function(n,i){var r=this.isSuspendDrawing();r||this.setSuspendDrawing(!0);try{n()}catch(u){t.log("Function run while suspended failed",u)}r||this.setSuspendDrawing(!1,!i)};this.getOffset=function(n){return s[n]};this.getCachedData=ar;this.timestamp=r;this.setRenderMode=function(t){if(t!==n.SVG&&t!==n.VML)throw new TypeError("Render mode ["+t+"] not supported");return gt=jsPlumbAdapter.setRenderMode(t)};this.getRenderMode=function(){return gt};this.show=function(n,t){return di(n,"block",t),f};this.toggleVisible=lr;this.toggleDraggable=cr;this.addListener=this.bind;jsPlumbAdapter.headless||(f.dragManager=jsPlumbAdapter.getDragManager(f),f.recalculateOffsets=f.dragManager.updateOffsets)};jsPlumbUtil.extend(h,jsPlumbUtil.EventGenerator,{setAttribute:function(n,t,i){this.setAttribute(n,t,i)},getAttribute:function(t,i){return this.getAttribute(n.getDOMElement(t),i)},registerConnectionType:function(t,i){this._connectionTypes[t]=n.extend({},i)},registerConnectionTypes:function(t){for(var i in t)this._connectionTypes[i]=n.extend({},t[i])},registerEndpointType:function(t,i){this._endpointTypes[t]=n.extend({},i)},registerEndpointTypes:function(t){for(var i in t)this._endpointTypes[i]=n.extend({},t[i])},getType:function(n,t){return t==="connection"?this._connectionTypes[n]:this._endpointTypes[n]},setIdChanged:function(n,t){this.setId(n,t,!0)},setParent:function(n,t){var r=this.getElementObject(n),i=this.getDOMElement(r),e=this.getId(i),u=this.getElementObject(t),f=this.getDOMElement(u),o=this.getId(f);i.parentNode.removeChild(i);f.appendChild(i);this.dragManager.setParent(r,e,u,o)},getSize:function(n){return[n.offsetWidth,n.offsetHeight]},getWidth:function(n){return n.offsetWidth},getHeight:function(n){return n.offsetHeight},extend:function(n,t,i){var r;if(i)for(r=0;r<i.length;r++)n[i[r]]=t[i[r]];else for(r in t)n[r]=t[r];return n},floatingConnections:{},getFloatingAnchorIndex:function(n){return n.endpoints[0].isFloating()?0:1}},jsPlumbAdapter);n=new h;typeof window!="undefined"&&(window.jsPlumb=n);n.getInstance=function(n){var t=new h(n);return t.init(),t};typeof define=="function"&&(define("jsplumb",[],function(){return n}),define("jsplumbinstance",[],function(){return n.getInstance()}));typeof exports!="undefined"&&(exports.jsPlumb=n)}(),function(){"use strict";var i=function(n,t){var i=!1;return{drag:function(){if(i)return i=!1,!0;var r=jsPlumb.getUIPosition(arguments,t.getZoom());n.element&&(jsPlumbAdapter.setPosition(n.element,r),t.repaint(n.element,r))},stopDrag:function(){i=!0}}},r=function(n,t){var i=document.createElement("div"),u,r;i.style.position="absolute";u=t.getContainer()||document.body;u.appendChild(i);r=t.getId(i);t.manage(r,i);n.id=r;n.element=i},u=function(n,t,i,r,u,f,e,o){var s=new jsPlumb.FloatingAnchor({reference:t,referenceCanvas:r,jsPlumbInstance:f});return e({paintStyle:n,endpoint:i,anchor:s,source:u,scope:o})},n=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],f=function(n,t){var r=0,i;if(t!=null)for(i=0;i<n.connections.length;i++)if(n.connections[i].sourceId==t||n.connections[i].targetId==t){r=i;break}return n.connections[r]},t=function(n,t){return jsPlumbUtil.findWithFunction(t.connections,function(t){return t.id==n.id})};jsPlumb.Endpoint=function(e){var o=e._jsPlumb,c=jsPlumb.getElementObject,s=jsPlumbUtil,b=e.newConnection,y=e.newEndpoint,k=e.finaliseConnection,d=e.fireMoveEvent,h,l,p,a,v,w;return this.idPrefix="_jsplumb_e_",this.defaultLabelLocation=[.5,.5],this.defaultOverlayKeys=["Overlays","EndpointOverlays"],OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.getDefaultType=function(){return{parameters:{},scope:null,maxConnections:this._jsPlumb.instance.Defaults.MaxConnections,paintStyle:this._jsPlumb.instance.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle,endpoint:this._jsPlumb.instance.Defaults.Endpoint||jsPlumb.Defaults.Endpoint,hoverPaintStyle:this._jsPlumb.instance.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle,overlays:this._jsPlumb.instance.Defaults.EndpointOverlays||jsPlumb.Defaults.EndpointOverlays,connectorStyle:e.connectorStyle,connectorHoverStyle:e.connectorHoverStyle,connectorClass:e.connectorClass,connectorHoverClass:e.connectorHoverClass,connectorOverlays:e.connectorOverlays,connector:e.connector,connectorTooltip:e.connectorTooltip}},this._jsPlumb.enabled=!(e.enabled===!1),this._jsPlumb.visible=!0,this.element=jsPlumb.getDOMElement(e.source),this._jsPlumb.uuid=e.uuid,this._jsPlumb.floatingEndpoint=null,h=null,this._jsPlumb.uuid&&(e.endpointsByUUID[this._jsPlumb.uuid]=this),this.elementId=e.elementId,this._jsPlumb.connectionCost=e.connectionCost,this._jsPlumb.connectionsDirected=e.connectionsDirected,this._jsPlumb.currentAnchorClass="",this._jsPlumb.events={},l=function(){var n=this._jsPlumb.currentAnchorClass;this._jsPlumb.currentAnchorClass=this.anchor.getCssClass();jsPlumbAdapter.updateClasses(this.element,o.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass,o.endpointAnchorClassPrefix+"_"+n);this.updateClasses(o.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass,o.endpointAnchorClassPrefix+"_"+n)}.bind(this),this.setAnchor=function(n,t){return this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId),this.anchor=this._jsPlumb.instance.makeAnchor(n,this.elementId,o),l(),this.anchor.bind("anchorChanged",function(n){this.fire("anchorChanged",{endpoint:this,anchor:n});l()}.bind(this)),t||this._jsPlumb.instance.repaint(this.elementId),this},p=e.anchor?e.anchor:e.anchors?e.anchors:o.Defaults.Anchor||"Top",this.setAnchor(p,!0),a=function(n){if(this.connections.length>0)for(var t=0;t<this.connections.length;t++)this.connections[t].setHover(n,!1);else this.setHover(n)}.bind(this),this.bind("mouseover",function(){a(!0)}),this.bind("mouseout",function(){a(!1)}),e._transient||this._jsPlumb.instance.anchorManager.add(this,this.elementId),this.setEndpoint=function(n){this.endpoint!=null&&(this.endpoint.cleanup(),this.endpoint.destroy());var i=function(n,t){var i=o.getRenderMode();if(jsPlumb.Endpoints[i][n])return new jsPlumb.Endpoints[i][n](t);if(!o.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown endpoint type '"+n+"'"};},t={_jsPlumb:this._jsPlumb.instance,cssClass:e.cssClass,container:e.container,tooltip:e.tooltip,connectorTooltip:e.connectorTooltip,endpoint:this};s.isString(n)?this.endpoint=i(n,t):s.isArray(n)?(t=s.merge(n[1],t),this.endpoint=i(n[0],t)):this.endpoint=n.clone();this.endpoint.clone=function(){return s.isString(n)?i(n,t):s.isArray(n)?(t=s.merge(n[1],t),i(n[0],t)):void 0}.bind(this);this.type=this.endpoint.type},this.setEndpoint(e.endpoint||o.Defaults.Endpoint||jsPlumb.Defaults.Endpoint||"Dot"),this.setPaintStyle(e.endpointStyle||e.paintStyle||e.style||o.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle,!0),this.setHoverPaintStyle(e.endpointHoverStyle||e.hoverPaintStyle||o.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle,!0),this._jsPlumb.paintStyleInUse=this.getPaintStyle(),jsPlumb.extend(this,e,n),this.isSource=e.isSource||!1,this.isTemporarySource=e.isTemporarySource||!1,this.isTarget=e.isTarget||!1,this._jsPlumb.maxConnections=e.maxConnections||o.Defaults.MaxConnections,this.canvas=this.endpoint.canvas,this.canvas._jsPlumb=this,this.addClass(o.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),jsPlumbAdapter.addClass(this.element,o.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),this.connections=e.connections||[],this.connectorPointerEvents=e["connector-pointer-events"],this.scope=e.scope||o.getDefaultScope(),this.timestamp=null,this.reattachConnections=e.reattach||o.Defaults.ReattachConnections,this.connectionsDetachable=o.Defaults.ConnectionsDetachable,(e.connectionsDetachable===!1||e.detachable===!1)&&(this.connectionsDetachable=!1),this.dragAllowedWhenFull=e.dragAllowedWhenFull!==!1,e.onMaxConnections&&this.bind("maxConnections",e.onMaxConnections),this.addConnection=function(n){this.connections.push(n);this[(this.connections.length>0?"add":"remove")+"Class"](o.endpointConnectedClass);this[(this.isFull()?"add":"remove")+"Class"](o.endpointFullClass)},this.detachFromConnection=function(n,i,r){i=i==null?t(n,this):i;i>=0&&(this.connections.splice(i,1),this[(this.connections.length>0?"add":"remove")+"Class"](o.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](o.endpointFullClass));!r&&this._deleteOnDetach&&this.connections.length===0&&o.deleteObject({endpoint:this,fireEvent:!1,deleteAttachedObjects:!1})},this.detach=function(n,i,r,u,f,e,s){var c=s==null?t(n,this):s,h=!1;return u=u!==!1,c>=0&&(r||n._forceDetach||n.isDetachable()&&n.isDetachAllowed(n)&&this.isDetachAllowed(n)&&o.checkCondition("beforeDetach",n))&&(o.deleteObject({connection:n,fireEvent:!i&&u,originalEvent:f,deleteAttachedObjects:!1}),h=!0),h},this.detachAll=function(n,t){while(this.connections.length>0)this.detach(this.connections[0],!1,!0,n!==!1,t,this,0);return this},this.detachFrom=function(n,t,i){for(var u,f=[],r=0;r<this.connections.length;r++)(this.connections[r].endpoints[1]==n||this.connections[r].endpoints[0]==n)&&f.push(this.connections[r]);for(u=0;u<f.length;u++)this.detach(f[u],!1,!0,t,i);return this},this.getElement=function(){return this.element},this.setElement=function(n){var t=this._jsPlumb.instance.getId(n),i=this.elementId;return s.removeWithFunction(e.endpointsByElement[this.elementId],function(n){return n.id==this.id}.bind(this)),this.element=jsPlumb.getDOMElement(n),this.elementId=o.getId(this.element),o.anchorManager.rehomeEndpoint(this,i,this.element),o.dragManager.endpointAdded(this.element),s.addToList(e.endpointsByElement,t,this),this},this.makeInPlaceCopy=function(){var n=this.anchor.getCurrentLocation({element:this}),t=this.anchor.getOrientation(this),i=this.anchor.getCssClass(),r={bind:function(){},compute:function(){return[n[0],n[1]]},getCurrentLocation:function(){return[n[0],n[1]]},getOrientation:function(){return t},getCssClass:function(){return i}};return y({dropOptions:e.dropOptions,anchor:r,source:this.element,paintStyle:this.getPaintStyle(),endpoint:e.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope})},this.connectorSelector=function(){var n=this.connections[0];return this.isTarget&&n?n:this.connections.length<this._jsPlumb.maxConnections||this._jsPlumb.maxConnections==-1?null:n},this.setStyle=this.setPaintStyle,this.paint=function(n){var t,l,c,u,e,a,v,r,i,h;if(n=n||{},t=n.timestamp,l=!(n.recalc===!1),(!t||this.timestamp!==t)&&(c=o.updateOffset({elId:this.elementId,timestamp:t}),u=n.offset?n.offset.o:c.o,u!=null)){if(e=n.anchorPoint,a=n.connectorPaintStyle,e==null){if(v=n.dimensions||c.s,r={xy:[u.left,u.top],wh:v,element:this,timestamp:t},l&&this.anchor.isDynamic&&this.connections.length>0){var s=f(this,n.elementWithPrecedence),y=s.endpoints[0]==this?1:0,b=y===0?s.sourceId:s.targetId,p=o.getCachedData(b),w=p.o,k=p.s;r.txy=[w.left,w.top];r.twh=k;r.tElement=s.endpoints[y]}e=this.anchor.compute(r)}for(this.endpoint.compute(e,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,a||this.paintStyleInUse),this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor),this.timestamp=t,i=0;i<this._jsPlumb.overlays.length;i++)h=this._jsPlumb.overlays[i],h.isVisible()&&(this._jsPlumb.overlayPlacements[i]=h.draw(this.endpoint,this._jsPlumb.paintStyleInUse),h.paint(this._jsPlumb.overlayPlacements[i]))}},this.repaint=this.paint,v=!1,this.initDraggable=function(){if(!v&&jsPlumb.isDragSupported(this.element)){var t={id:null,element:null},n=null,a=!1,l=null,p=i(t,o),f=e.dragOptions||{},w=jsPlumb.dragEvents.start,k=jsPlumb.dragEvents.stop,d=jsPlumb.dragEvents.drag,g=function(){var f,w,i,k,d;if(n=this.connectorSelector(),f=!0,this.isEnabled()||(f=!1),n!=null||this.isSource||this.isTemporarySource||(f=!1),this.isSource&&this.isFull()&&!this.dragAllowedWhenFull&&(f=!1),n==null||n.isDetachable()||(f=!1),f===!1)return o.stopDrag&&o.stopDrag(this.canvas),p.stopDrag(),!1;for(w=0;w<this.connections.length;w++)this.connections[w].setHover(!1);this.addClass("endpointDrag");o.setConnectionBeingDragged(!0);n&&!this.isFull()&&this.isSource&&(n=null);o.updateOffset({elId:this.elementId});h=this.makeInPlaceCopy();h.referenceEndpoint=this;h.paint();r(t,o);var g=c(h.canvas),nt=jsPlumbAdapter.getOffset(g,this._jsPlumb.instance),v=c(this.canvas);jsPlumbAdapter.setPosition(t.element,nt);this.parentAnchor&&(this.anchor=o.makeAnchor(this.parentAnchor,this.elementId,o));o.setAttribute(this.canvas,"dragId",t.id);o.setAttribute(this.canvas,"elId",this.elementId);this._jsPlumb.floatingEndpoint=u(this.getPaintStyle(),this.anchor,this.endpoint,this.canvas,t.element,o,y,this.scope);this.canvas.style.visibility="hidden";n==null?(this.anchor.locked=!0,this.setHover(!1,!1),n=b({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.endpointWillMoveTo||this.element,target:t.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:e.connectorStyle,hoverPaintStyle:e.connectorHoverStyle,connector:e.connector,overlays:e.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass}),n.addClass(o.draggingClass),this._jsPlumb.floatingEndpoint.addClass(o.draggingClass),o.fire("connectionDrag",n)):(a=!0,n.setHover(!1),i=n.endpoints[0].id==this.id?0:1,this.detachFromConnection(n,null,!0),k=o.getDragScope(v),o.setAttribute(this.canvas,"originalScope",k),d=o.getDropScope(v),o.setDragScope(v,d),o.fire("connectionDrag",n),i===0?(l=[n.source,n.sourceId,v,k],n.source=t.element,n.sourceId=t.id):(l=[n.target,n.targetId,v,k],n.target=t.element,n.targetId=t.id),n.endpoints[i===0?1:0].anchor.locked=!0,n.suspendedEndpoint=n.endpoints[i],n.suspendedElement=n.endpoints[i].getElement(),n.suspendedElementId=n.endpoints[i].elementId,n.suspendedElementType=i===0?"source":"target",n.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=n.suspendedEndpoint,n.endpoints[i]=this._jsPlumb.floatingEndpoint,n.addClass(o.draggingClass),this._jsPlumb.floatingEndpoint.addClass(o.draggingClass));o.floatingConnections[t.id]=n;o.anchorManager.addFloatingConnection(t.id,n);s.addToList(e.endpointsByElement,t.id,this._jsPlumb.floatingEndpoint);o.currentlyDragging=!0}.bind(this),nt=function(){var r,i,u;o.setConnectionBeingDragged(!1);n&&n.endpoints!=null&&(r=o.getDropEvent(arguments),i=o.getFloatingAnchorIndex(n),n.endpoints[i===0?1:0].anchor.locked=!1,n.removeClass(o.draggingClass),this._jsPlumb&&(n.deleteConnectionNow||n.endpoints[i]==this._jsPlumb.floatingEndpoint)&&a&&n.suspendedEndpoint&&(i===0?(n.source=l[0],n.sourceId=l[1]):(n.target=l[0],n.targetId=l[1]),u=this._jsPlumb.floatingEndpoint,o.setDragScope(l[2],l[3]),n.endpoints[i]=n.suspendedEndpoint,n.isReattach()||n._forceReattach||n._forceDetach||!n.endpoints[i===0?1:0].detach(n,!1,!1,!0,r)?(n.setHover(!1),n._forceDetach=null,n._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(n),n.suspendedEndpoint.addConnection(n),o.repaint(l[1])):o.deleteObject({endpoint:u})),o.remove(t.element,!1),o.deleteObject({endpoint:h}),this.deleteAfterDragStop?o.deleteObject({endpoint:this}):this._jsPlumb&&(this._jsPlumb.floatingEndpoint=null,this.canvas.style.visibility="visible",this.anchor.locked=!1,this.paint({recalc:!1})),o.fire("connectionDragStop",n,r),o.currentlyDragging=!1,n=null)}.bind(this);f=jsPlumb.extend({},f);f.scope=this.scope||f.scope;f[w]=s.wrap(f[w],g,!1);f[d]=s.wrap(f[d],p.drag);f[k]=s.wrap(f[k],nt);f.canDrag=function(){return this.isSource||this.isTemporarySource||this.isTarget&&this.connections.length>0}.bind(this);o.initDraggable(this.canvas,f,"internal");this.canvas._jsPlumbRelatedElement=this.element;v=!0}},(this.isSource||this.isTarget||this.isTemporarySource)&&this.initDraggable(),w=function(n,t,i,r){var u;if((this.isTarget||t)&&jsPlumb.isDropSupported(this.element)){u=e.dropOptions||o.Defaults.DropOptions||jsPlumb.Defaults.DropOptions;u=jsPlumb.extend({},u);u.scope=u.scope||this.scope;var h=jsPlumb.dragEvents.drop,c=jsPlumb.dragEvents.over,l=jsPlumb.dragEvents.out,f=this,a=o.EndpointDropHandler({getEndpoint:function(){return f},jsPlumb:o,enabled:function(){return r!=null?r.isEnabled():!0},isFull:function(){return r.isFull()},element:this.element,elementId:this.elementId,isSource:this.isSource,isTarget:this.isTarget,addClass:function(n){f.addClass(n)},removeClass:function(n){f.removeClass(n)},isDropAllowed:function(){return f.isDropAllowed.apply(f,arguments)}});u[h]=s.wrap(u[h],a);u[c]=s.wrap(u[c],function(){var u=jsPlumb.getDragObject(arguments),f=o.getAttribute(jsPlumb.getDOMElement(u),"dragId"),n=o.floatingConnections[f],t,r,i;n!=null&&(t=o.getFloatingAnchorIndex(n),r=this.isTarget&&t!==0||n.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==n.suspendedEndpoint.id,r&&(i=o.checkCondition("checkDropAllowed",{sourceEndpoint:n.endpoints[t],targetEndpoint:this,connection:n}),this[(i?"add":"remove")+"Class"](o.endpointDropAllowedClass),this[(i?"remove":"add")+"Class"](o.endpointDropForbiddenClass),n.endpoints[t].anchor.over(this.anchor,this)))}.bind(this));u[l]=s.wrap(u[l],function(){var i=jsPlumb.getDragObject(arguments),r=i==null?null:o.getAttribute(jsPlumb.getDOMElement(i),"dragId"),n=r?o.floatingConnections[r]:null,t,u;n!=null&&(t=o.getFloatingAnchorIndex(n),u=this.isTarget&&t!==0||n.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==n.suspendedEndpoint.id,u&&(this.removeClass(o.endpointDropAllowedClass),this.removeClass(o.endpointDropForbiddenClass),n.endpoints[t].anchor.out()))}.bind(this));o.initDroppable(n,u,"internal",i)}}.bind(this),this.anchor.isFloating||w(c(this.canvas),!0,!(e._transient||this.anchor.isFloating),this),e.type&&this.addType(e.type,e.data,o.isSuspendDrawing()),this};jsPlumbUtil.extend(jsPlumb.Endpoint,OverlayCapableJsPlumbUIComponent,{getTypeDescriptor:function(){return"endpoint"},isVisible:function(){return this._jsPlumb.visible},setVisible:function(n,t,i){var r,u;if(this._jsPlumb.visible=n,this.canvas&&(this.canvas.style.display=n?"block":"none"),this[n?"showOverlays":"hideOverlays"](),!t)for(r=0;r<this.connections.length;r++)this.connections[r].setVisible(n),i||(u=this===this.connections[r].endpoints[0]?1:0,this.connections[r].endpoints[u].connections.length==1&&this.connections[r].endpoints[u].setVisible(n,!0,!0))},getAttachedElements:function(){return this.connections},applyType:function(t){this.setPaintStyle(t.endpointStyle||t.paintStyle);this.setHoverPaintStyle(t.endpointHoverStyle||t.hoverPaintStyle);t.maxConnections!=null&&(this._jsPlumb.maxConnections=t.maxConnections);t.scope&&(this.scope=t.scope);jsPlumb.extend(this,t,n);t.anchor&&(this.anchor=this._jsPlumb.instance.makeAnchor(t.anchor));t.cssClass!=null&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,t.cssClass)},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(n){this._jsPlumb.enabled=n},cleanup:function(){jsPlumbAdapter.removeClass(this.element,this._jsPlumb.instance.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass);this.anchor=null;this.endpoint.cleanup();this.endpoint.destroy();this.endpoint=null;var n=jsPlumb.getElementObject(this.canvas);this._jsPlumb.instance.destroyDraggable(n,"internal");this._jsPlumb.instance.destroyDroppable(n,"internal")},setHover:function(n){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&this.endpoint.setHover(n)},isFull:function(){return!(this.isFloating()||this._jsPlumb.maxConnections<1||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return this.anchor!=null&&this.anchor.isFloating},isConnectedTo:function(n){var i=!1,t;if(n)for(t=0;t<this.connections.length;t++)if(this.connections[t].endpoints[1]==n||this.connections[t].endpoints[0]==n){i=!0;break}return i},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(n){this._jsPlumb.connectionCost=n},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(n){this._jsPlumb.connectionsDirected=n},setElementId:function(n){this.elementId=n;this.anchor.elementId=n},setReferenceElement:function(n){this.element=jsPlumb.getDOMElement(n)},setDragAllowedWhenFull:function(n){this.dragAllowedWhenFull=n},equals:function(n){return this.anchor.equals(n.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(n){return this.anchor.compute(n)}});jsPlumbInstance.prototype.EndpointDropHandler=function(n){return function(t){var r=n.jsPlumb,f,c,u,e,l,a;n.removeClass(r.endpointDropAllowedClass);n.removeClass(r.endpointDropForbiddenClass);var s=r.getDropEvent(arguments),o=r.getDOMElement(r.getDragObject(arguments)),v=r.getAttribute(o,"dragId"),y=r.getAttribute(o,"elId"),h=r.getAttribute(o,"originalScope"),i=r.floatingConnections[v];if(i!=null){if(f=n.getEndpoint(i),n.onDrop)n.onDrop(i);if(c=i.suspendedEndpoint&&(i.suspendedEndpoint.id==f.id||f.referenceEndpoint&&i.suspendedEndpoint.id==f.referenceEndpoint.id),c){i._forceReattach=!0;i.setHover(!1);return}u=r.getFloatingAnchorIndex(i);h&&r.setDragScope(o,h);n.isFull(t)&&f.fire("maxConnections",{endpoint:this,connection:i,maxConnections:f._jsPlumb.maxConnections},s);n.isFull()||u===0&&!n.isSource||u==1&&!n.isTarget||!n.enabled()||(e=!0,i.suspendedEndpoint&&i.suspendedEndpoint.id!=f.id&&(i.isDetachAllowed(i)&&i.endpoints[u].isDetachAllowed(i)&&i.suspendedEndpoint.isDetachAllowed(i)&&r.checkCondition("beforeDetach",i)||(e=!1)),u===0?(i.source=n.element,i.sourceId=n.elementId):(i.target=n.element,i.targetId=n.elementId),l=function(){var n,t,e,o;i.endpoints[u].detachFromConnection(i);i.suspendedEndpoint&&i.suspendedEndpoint.detachFromConnection(i);i.endpoints[u]=f;f.addConnection(i);n=f.getParameters();for(t in n)i.setParameter(t,n[t]);i.suspendedEndpoint?(e=i.suspendedEndpoint.elementId,r.fireMoveEvent({index:u,originalSourceId:u===0?e:i.sourceId,newSourceId:u===0?f.elementId:i.sourceId,originalTargetId:u==1?e:i.targetId,newTargetId:u==1?f.elementId:i.targetId,originalSourceEndpoint:u===0?i.suspendedEndpoint:i.endpoints[0],newSourceEndpoint:u===0?f:i.endpoints[0],originalTargetEndpoint:u==1?i.suspendedEndpoint:i.endpoints[1],newTargetEndpoint:u==1?f:i.endpoints[1],connection:i},s)):n.draggable&&r.initDraggable(this.element,dragOptions,"internal",r);u==1?r.anchorManager.updateOtherEndpoint(i.sourceId,i.suspendedElementId,i.targetId,i):r.anchorManager.sourceChanged(i.suspendedEndpoint.elementId,i.sourceId,i);i.endpoints[0].finalEndpoint&&(o=i.endpoints[0],o.detachFromConnection(i),i.endpoints[0]=i.endpoints[0].finalEndpoint,i.endpoints[0].addConnection(i));r.finaliseConnection(i,null,s);i.setHover(!1)}.bind(this),a=function(){i.suspendedEndpoint&&(i.endpoints[u]=i.suspendedEndpoint,i.setHover(!1),i._forceDetach=!0,u===0?(i.source=i.suspendedEndpoint.element,i.sourceId=i.suspendedEndpoint.elementId):(i.target=i.suspendedEndpoint.element,i.targetId=i.suspendedEndpoint.elementId),i.suspendedEndpoint.addConnection(i),r.repaint(i.sourceId),i._forceDetach=!1)},e=e&&n.isDropAllowed(i.sourceId,i.targetId,i.scope,i,f),e?l():a());r.currentlyDragging=!1}}}}(),function(){"use strict";var t=function(n,t,i,r,u){if(!n.Defaults.DoNotThrowErrors&&jsPlumb.Connectors[t][i]==null)throw{msg:"jsPlumb: unknown connector type '"+i+"'"};return new jsPlumb.Connectors[t][i](r,u)},n=function(n,t,i){return n?i.makeAnchor(n,t,i):null};jsPlumb.Connection=function(n){var w=n.newEndpoint,c=jsPlumbUtil,t,e,o,l,f,h;if(this.connector=null,this.idPrefix="_jsplumb_c_",this.defaultLabelLocation=.5,this.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.previousConnection=n.previousConnection,this.source=jsPlumb.getDOMElement(n.source),this.target=jsPlumb.getDOMElement(n.target),n.sourceEndpoint&&(this.source=n.sourceEndpoint.endpointWillMoveTo||n.sourceEndpoint.getElement()),n.targetEndpoint&&(this.target=n.targetEndpoint.getElement()),OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.sourceId=this._jsPlumb.instance.getId(this.source),this.targetId=this._jsPlumb.instance.getId(this.target),this.scope=n.scope,this.endpoints=[],this.endpointStyles=[],t=this._jsPlumb.instance,t.manage(this.sourceId,this.source),t.manage(this.targetId,this.target),this._jsPlumb.visible=!0,this._jsPlumb.editable=n.editable===!0,this._jsPlumb.params={cssClass:n.cssClass,container:n.container,"pointer-events":n["pointer-events"],editorParams:n.editorParams},this._jsPlumb.lastPaintedAt=null,this.getDefaultType=function(){return{parameters:{},scope:null,detachable:this._jsPlumb.instance.Defaults.ConnectionsDetachable,rettach:this._jsPlumb.instance.Defaults.ReattachConnections,paintStyle:this._jsPlumb.instance.Defaults.PaintStyle||jsPlumb.Defaults.PaintStyle,connector:this._jsPlumb.instance.Defaults.Connector||jsPlumb.Defaults.Connector,hoverPaintStyle:this._jsPlumb.instance.Defaults.HoverPaintStyle||jsPlumb.Defaults.HoverPaintStyle,overlays:this._jsPlumb.instance.Defaults.ConnectorOverlays||jsPlumb.Defaults.ConnectorOverlays}},this.bind("mouseover",function(){this.setHover(!0)}.bind(this)),this.bind("mouseout",function(){this.setHover(!1)}.bind(this)),this.makeEndpoint=function(i,r,u,f){return u=u||this._jsPlumb.instance.getId(r),this.prepareEndpoint(t,w,this,f,i?0:1,n,r,u)},e=this.makeEndpoint(!0,this.source,this.sourceId,n.sourceEndpoint),o=this.makeEndpoint(!1,this.target,this.targetId,n.targetEndpoint),e&&c.addToList(n.endpointsByElement,this.sourceId,e),o&&c.addToList(n.endpointsByElement,this.targetId,o),this.scope||(this.scope=this.endpoints[0].scope),n.deleteEndpointsOnDetach!=null?(this.endpoints[0]._deleteOnDetach=n.deleteEndpointsOnDetach,this.endpoints[1]._deleteOnDetach=n.deleteEndpointsOnDetach):(this.endpoints[0]._doNotDeleteOnDetach||(this.endpoints[0]._deleteOnDetach=!0),this.endpoints[1]._doNotDeleteOnDetach||(this.endpoints[1]._deleteOnDetach=!0)),this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||n.connector||t.Defaults.Connector||jsPlumb.Defaults.Connector,!0,!0),n.path&&this.connector.setPath(n.path),this.setPaintStyle(this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||n.paintStyle||t.Defaults.PaintStyle||jsPlumb.Defaults.PaintStyle,!0),this.setHoverPaintStyle(this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||n.hoverPaintStyle||t.Defaults.HoverPaintStyle||jsPlumb.Defaults.HoverPaintStyle,!0),this._jsPlumb.paintStyleInUse=this.getPaintStyle(),l=t.getSuspendedAt(),!t.isSuspendDrawing()){var a=t.getCachedData(this.sourceId),i=a.o,v=a.s,y=t.getCachedData(this.targetId),r=y.o,p=y.s,u=l||t.timestamp(),s=this.endpoints[0].anchor.compute({xy:[i.left,i.top],wh:v,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[r.left,r.top],twh:p,tElement:this.endpoints[1],timestamp:u});this.endpoints[0].paint({anchorLoc:s,timestamp:u});s=this.endpoints[1].anchor.compute({xy:[r.left,r.top],wh:p,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[i.left,i.top],twh:v,tElement:this.endpoints[0],timestamp:u});this.endpoints[1].paint({anchorLoc:s,timestamp:u})}this._jsPlumb.detachable=t.Defaults.ConnectionsDetachable;n.detachable===!1&&(this._jsPlumb.detachable=!1);this.endpoints[0].connectionsDetachable===!1&&(this._jsPlumb.detachable=!1);this.endpoints[1].connectionsDetachable===!1&&(this._jsPlumb.detachable=!1);this._jsPlumb.reattach=n.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||t.Defaults.ReattachConnections;this._jsPlumb.cost=n.cost||this.endpoints[0].getConnectionCost();this._jsPlumb.directed=n.directed;n.directed==null&&(this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected());f=jsPlumb.extend({},this.endpoints[1].getParameters());jsPlumb.extend(f,this.endpoints[0].getParameters());jsPlumb.extend(f,this.getParameters());this.setParameters(f);h=[n.type,this.endpoints[0].connectionType,this.endpoints[1].connectionType].join(" ");/[^\s]/.test(h)&&this.addType(h,n.data,!0)};jsPlumbUtil.extend(jsPlumb.Connection,OverlayCapableJsPlumbUIComponent,{applyType:function(n,t){n.detachable!=null&&this.setDetachable(n.detachable);n.reattach!=null&&this.setReattach(n.reattach);n.scope&&(this.scope=n.scope);this.setConnector(n.connector,t);n.cssClass!=null&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,n.cssClass);n.anchor?(this.endpoints[0].anchor=this._jsPlumb.instance.makeAnchor(n.anchor),this.endpoints[1].anchor=this._jsPlumb.instance.makeAnchor(n.anchor)):n.anchors&&(this.endpoints[0].anchor=this._jsPlumb.instance.makeAnchor(n.anchors[0]),this.endpoints[1].anchor=this._jsPlumb.instance.makeAnchor(n.anchors[1]))},getTypeDescriptor:function(){return"connection"},getAttachedElements:function(){return this.endpoints},addClass:function(n,t){t&&(this.endpoints[0].addClass(n),this.endpoints[1].addClass(n),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(n));this.connector&&this.connector.addClass(n)},removeClass:function(n,t){t&&(this.endpoints[0].removeClass(n),this.endpoints[1].removeClass(n),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(n));this.connector&&this.connector.removeClass(n)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(n){this._jsPlumb.visible=n;this.connector&&this.connector.setVisible(n);this.repaint()},cleanup:function(){this.endpoints=null;this.source=null;this.target=null;this.connector!=null&&(this.connector.cleanup(),this.connector.destroy());this.connector=null},isDetachable:function(){return this._jsPlumb.detachable===!0},setDetachable:function(n){this._jsPlumb.detachable=n===!0},isReattach:function(){return this._jsPlumb.reattach===!0},setReattach:function(n){this._jsPlumb.reattach=n===!0},setHover:function(n){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(n),jsPlumbAdapter[n?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),jsPlumbAdapter[n?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getCost:function(){return this._jsPlumb.cost},setCost:function(n){this._jsPlumb.cost=n},isDirected:function(){return this._jsPlumb.directed===!0},getConnector:function(){return this.connector},setConnector:function(n,i,r){var e=jsPlumbUtil,u,f;this.connector!=null&&(this.connector.cleanup(),this.connector.destroy());u={_jsPlumb:this._jsPlumb.instance,cssClass:this._jsPlumb.params.cssClass,container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"]};f=this._jsPlumb.instance.getRenderMode();e.isString(n)?this.connector=t(this._jsPlumb.instance,f,n,u,this):e.isArray(n)&&(this.connector=n.length==1?t(this._jsPlumb.instance,f,n[0],u,this):t(this._jsPlumb.instance,f,n[0],e.merge(n[1],u),this));this.canvas=this.connector.canvas;this.bgCanvas=this.connector.bgCanvas;this.canvas&&(this.canvas._jsPlumb=this);this.bgCanvas&&(this.bgCanvas._jsPlumb=this);r||this.setListenerComponent(this.connector);i||this.repaint()},paint:function(n){var t,i,s,e,l;if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){n=n||{};var r=n.timestamp,o=!1,b=o?this.sourceId:this.targetId,k=o?this.targetId:this.sourceId,a=o?0:1,v=o?1:0;if(r==null||r!=this._jsPlumb.lastPaintedAt){var u=this._jsPlumb.instance.getOffset(k),f=this._jsPlumb.instance.getOffset(b),y=this.endpoints[v],p=this.endpoints[a],d=y.anchor.getCurrentLocation({xy:[u.left,u.top],wh:[u.width,u.height],element:y,timestamp:r}),g=p.anchor.getCurrentLocation({xy:[f.left,f.top],wh:[f.width,f.height],element:p,timestamp:r});for(this.connector.resetBounds(),this.connector.compute({sourcePos:d,targetPos:g,sourceEndpoint:this.endpoints[v],targetEndpoint:this.endpoints[a],lineWidth:this._jsPlumb.paintStyleInUse.lineWidth,sourceInfo:u,targetInfo:f}),t={minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity},i=0;i<this._jsPlumb.overlays.length;i++)s=this._jsPlumb.overlays[i],s.isVisible()&&(this._jsPlumb.overlayPlacements[i]=s.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(s)),t.minX=Math.min(t.minX,this._jsPlumb.overlayPlacements[i].minX),t.maxX=Math.max(t.maxX,this._jsPlumb.overlayPlacements[i].maxX),t.minY=Math.min(t.minY,this._jsPlumb.overlayPlacements[i].minY),t.maxY=Math.max(t.maxY,this._jsPlumb.overlayPlacements[i].maxY));var h=parseFloat(this._jsPlumb.paintStyleInUse.lineWidth||1)/2,c=parseFloat(this._jsPlumb.paintStyleInUse.lineWidth||0),w={xmin:Math.min(this.connector.bounds.minX-(h+c),t.minX),ymin:Math.min(this.connector.bounds.minY-(h+c),t.minY),xmax:Math.max(this.connector.bounds.maxX+(h+c),t.maxX),ymax:Math.max(this.connector.bounds.maxY+(h+c),t.maxY)};for(this.connector.paint(this._jsPlumb.paintStyleInUse,null,w),e=0;e<this._jsPlumb.overlays.length;e++)l=this._jsPlumb.overlays[e],l.isVisible()&&l.paint(this._jsPlumb.overlayPlacements[e],w)}this._jsPlumb.lastPaintedAt=r}},repaint:function(n){n=n||{};this.paint({elId:this.sourceId,recalc:!(n.recalc===!1),timestamp:n.timestamp})},prepareEndpoint:function(t,i,r,u,f,e,o,s){var l,a,h,c,v,y;return u?(r.endpoints[f]=u,u.addConnection(r)):(e.endpoints||(e.endpoints=[null,null]),a=e.endpoints[f]||e.endpoint||t.Defaults.Endpoints[f]||jsPlumb.Defaults.Endpoints[f]||t.Defaults.Endpoint||jsPlumb.Defaults.Endpoint,e.endpointStyles||(e.endpointStyles=[null,null]),e.endpointHoverStyles||(e.endpointHoverStyles=[null,null]),h=e.endpointStyles[f]||e.endpointStyle||t.Defaults.EndpointStyles[f]||jsPlumb.Defaults.EndpointStyles[f]||t.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle,h.fillStyle==null&&e.paintStyle!=null&&(h.fillStyle=e.paintStyle.strokeStyle),h.outlineColor==null&&e.paintStyle!=null&&(h.outlineColor=e.paintStyle.outlineColor),h.outlineWidth==null&&e.paintStyle!=null&&(h.outlineWidth=e.paintStyle.outlineWidth),c=e.endpointHoverStyles[f]||e.endpointHoverStyle||t.Defaults.EndpointHoverStyles[f]||jsPlumb.Defaults.EndpointHoverStyles[f]||t.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle,e.hoverPaintStyle!=null&&(c==null&&(c={}),c.fillStyle==null&&(c.fillStyle=e.hoverPaintStyle.strokeStyle)),v=e.anchors?e.anchors[f]:e.anchor?e.anchor:n(t.Defaults.Anchors[f],s,t)||n(jsPlumb.Defaults.Anchors[f],s,t)||n(t.Defaults.Anchor,s,t)||n(jsPlumb.Defaults.Anchor,s,t),y=e.uuids?e.uuids[f]:null,l=i({paintStyle:h,hoverPaintStyle:c,endpoint:a,connections:[r],uuid:y,anchor:v,source:o,scope:e.scope,reattach:e.reattach||t.Defaults.ReattachConnections,detachable:e.detachable||t.Defaults.ConnectionsDetachable}),r.endpoints[f]=l,e.drawEndpoints===!1&&l.setVisible(!1,!0,!0)),l}})}(),function(){"use strict";var i,n,t;jsPlumb.AnchorManager=function(n){var r={},h={},e={},a={},p={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},f=["left","top","right","bottom"],t={},o=this,i={},u=n.jsPlumbInstance,l={},w=function(n,t,i,r,u,e){var h,c,l,a,s;if(n===t)return{orientation:p.IDENTITY,a:["top","top"]};var y=Math.atan2(r.centery-i.centery,r.centerx-i.centerx),w=Math.atan2(i.centery-r.centery,i.centerx-r.centerx),o=[],v={};for(function(n,t){for(var i=0;i<n.length;i++)v[n[i]]={left:[t[i].left,t[i].centery],right:[t[i].right,t[i].centery],top:[t[i].centerx,t[i].top],bottom:[t[i].centerx,t[i].bottom]}}(["source","target"],[i,r]),h=0;h<f.length;h++)for(c=0;c<f.length;c++)h!=c&&o.push({source:f[h],target:f[c],dist:Biltong.lineLength(v.source[f[h]],v.target[f[c]])});for(o.sort(function(n,t){return n.dist<t.dist?-1:n.dist>t.dist?1:0}),l=o[0].source,a=o[0].target,s=0;s<o.length;s++)if(l=!u.isContinuous||u.isEdgeSupported(o[s].source)?o[s].source:null,a=!e.isContinuous||e.isEdgeSupported(o[s].target)?o[s].target:null,l!=null&&a!=null)break;return{a:[l,a],theta:y,theta2:w}},b=function(n,t,i,r,u,f,e){for(var s,h,c=[],v=t[u?0:1]/(r.length+1),o=0;o<r.length;o++){s=(o+1)*v;h=f*t[u?1:0];e&&(s=t[u?0:1]-s);var l=u?s:h,y=i[0]+l,p=l/t[0],a=u?h:s,w=i[1]+a,b=a/t[1];c.push([y,w,p,b,r[o][1],r[o][2]])}return c},v=function(n){return function(t,i){var r=!0;return r=n?t[0][0]<i[0][0]:t[0][0]>i[0][0],r===!1?-1:1}},k=function(n,t){var i=n[0][0]<0?-Math.PI-n[0][0]:Math.PI-n[0][0],r=t[0][0]<0?-Math.PI-t[0][0]:Math.PI-t[0][0];return i>r?1:n[0][1]>t[0][1]?1:-1},d={top:function(n,t){return n[0]>t[0]?1:-1},right:v(!0),bottom:v(!0),left:k},g=function(n,t){return n.sort(t)},nt=function(n,t){var e=u.getCachedData(n),r=e.s,i=e.o,f=function(t,i,r,u,f,e,o){var s;if(u.length>0){var y=g(u,d[t]),p=t==="right"||t==="top",c=b(t,i,r,y,f,e,p),v=function(n,t){h[n.id]=[t[0],t[1],t[2],t[3]];a[n.id]=o};for(s=0;s<c.length;s++){var l=c[s][4],w=l.endpoints[0].elementId===n,k=l.endpoints[1].elementId===n;w?v(l.endpoints[0],c[s]):k&&v(l.endpoints[1],c[s])}}};f("bottom",r,[i.left,i.top],t.bottom,!0,1,[0,1]);f("top",r,[i.left,i.top],t.top,!0,0,[0,-1]);f("left",r,[i.left,i.top],t.left,!1,0,[-1,0]);f("right",r,[i.left,i.top],t.right,!1,1,[1,0])},c,s,y;this.reset=function(){r={};t={};i={}};this.addFloatingConnection=function(n,t){l[n]=t};this.removeFloatingConnection=function(n){delete l[n]};this.newConnection=function(n){var r=n.sourceId,u=n.targetId,i=n.endpoints,f=!0,e=function(e,o,s,h,c){r==u&&s.isContinuous&&(n._jsPlumb.instance.removeElement(i[1].canvas),f=!1);jsPlumbUtil.addToList(t,h,[c,o,s.constructor==jsPlumb.DynamicAnchor])};e(0,i[0],i[0].anchor,u,n);f&&e(1,i[1],i[1].anchor,r,n)};c=function(n){(function(n,t){if(n){var i=function(n){return n[4]==t};jsPlumbUtil.removeWithFunction(n.top,i);jsPlumbUtil.removeWithFunction(n.left,i);jsPlumbUtil.removeWithFunction(n.bottom,i);jsPlumbUtil.removeWithFunction(n.right,i)}})(i[n.elementId],n.id)};this.connectionDetached=function(n){var i=n.connection||n,f=n.sourceId,e=n.targetId,r=i.endpoints,u=function(n,i,r,u,f){r!=null&&r.constructor==jsPlumb.FloatingAnchor||jsPlumbUtil.removeWithFunction(t[u],function(n){return n[0].id==f.id})};u(1,r[1],r[1].anchor,f,i);u(0,r[0],r[0].anchor,e,i);c(i.endpoints[0]);c(i.endpoints[1]);o.redraw(i.sourceId);o.redraw(i.targetId)};this.add=function(n,t){jsPlumbUtil.addToList(r,t,n)};this.changeId=function(n,i){t[i]=t[n];r[i]=r[n];delete t[n];delete r[n]};this.getConnectionsFor=function(n){return t[n]||[]};this.getEndpointsFor=function(n){return r[n]||[]};this.deleteEndpoint=function(n){jsPlumbUtil.removeWithFunction(r[n.elementId],function(t){return t.id==n.id});c(n)};this.clearFor=function(n){delete r[n];r[n]=[]};s=function(t,i,r,u,f,e,o,s,h,c,l,a){var g=-1,w=-1,b=u.endpoints[o],nt=b.id,k=[1,0][o],tt=[[i,r],u,f,e,nt],y=t[h],p=b._continuousAnchorEdge?t[b._continuousAnchorEdge]:null,v,d,it;if(p&&(d=jsPlumbUtil.findWithFunction(p,function(n){return n[4]==nt}),d!=-1))for(p.splice(d,1),v=0;v<p.length;v++)jsPlumbUtil.addWithFunction(l,p[v][1],function(n){return n.id==p[v][1].id}),jsPlumbUtil.addWithFunction(a,p[v][1].endpoints[o],function(n){return n.id==p[v][1].endpoints[o].id}),jsPlumbUtil.addWithFunction(a,p[v][1].endpoints[k],function(n){return n.id==p[v][1].endpoints[k].id});for(v=0;v<y.length;v++)n.idx==1&&y[v][3]===e&&w==-1&&(w=v),jsPlumbUtil.addWithFunction(l,y[v][1],function(n){return n.id==y[v][1].id}),jsPlumbUtil.addWithFunction(a,y[v][1].endpoints[o],function(n){return n.id==y[v][1].endpoints[o].id}),jsPlumbUtil.addWithFunction(a,y[v][1].endpoints[k],function(n){return n.id==y[v][1].endpoints[k].id});g!=-1?y[g]=tt:(it=s?w!=-1?w:0:y.length,y.splice(it,0,tt));b._continuousAnchorEdge=h};this.updateOtherEndpoint=function(n,i,r,u){var f=jsPlumbUtil.findWithFunction(t[n],function(n){return n[0].id===u.id}),e=jsPlumbUtil.findWithFunction(t[i],function(n){return n[0].id===u.id});f!=-1&&(t[n][f][0]=u,t[n][f][1]=u.endpoints[1],t[n][f][2]=u.endpoints[1].anchor.constructor==jsPlumb.DynamicAnchor);e>-1&&(t[i].splice(e,1),jsPlumbUtil.addToList(t,r,[u,u.endpoints[0],u.endpoints[0].anchor.constructor==jsPlumb.DynamicAnchor]))};this.sourceChanged=function(n,i,r){if(n!==i){jsPlumbUtil.removeWithFunction(t[n],function(n){return n[0].id===r.id});var u=jsPlumbUtil.findWithFunction(t[r.targetId],function(n){return n[0].id===r.id});u>-1&&(t[r.targetId][u][0]=r,t[r.targetId][u][1]=r.endpoints[0],t[r.targetId][u][2]=r.endpoints[0].anchor.constructor==jsPlumb.DynamicAnchor);jsPlumbUtil.addToList(t,i,[r,r.endpoints[1],r.endpoints[1].anchor.constructor==jsPlumb.DynamicAnchor])}};this.rehomeEndpoint=function(n,t,i){var s=r[t]||[],h=u.getId(i),e,c,f;for(h!==t&&(e=jsPlumbUtil.indexOf(s,n),e>-1&&(c=s.splice(e,1)[0],o.add(c,h))),f=0;f<n.connections.length;f++)n.connections[f].sourceId==t?(n.connections[f].sourceId=n.elementId,n.connections[f].source=n.element,o.sourceChanged(t,n.elementId,n.connections[f])):n.connections[f].targetId==t&&(n.connections[f].targetId=n.elementId,n.connections[f].target=n.element,o.updateOtherEndpoint(n.connections[f].sourceId,t,n.elementId,n.connections[f]))};this.redraw=function(n,f,e,o,h,c){var st,ht,a,vt,yt,ct,tt,et,lt;if(!u.isSuspendDrawing()){var d=r[n]||[],k=t[n]||[],b=[],g=[],rt=[];for(e=e||u.timestamp(),o=o||{left:0,top:0},f&&(f={left:f.left+o.left,top:f.top+o.top}),st=u.updateOffset({elId:n,offset:f,recalc:!1,timestamp:e}),ht={},a=0;a<k.length;a++){var p=k[a][0],v=p.sourceId,y=p.targetId,ut=p.endpoints[0].anchor.isContinuous,ft=p.endpoints[1].anchor.isContinuous;if(ut||ft){var at=v+"_"+y,pt=y+"_"+v,it=ht[at],ot=p.sourceId==n?1:0;ut&&!i[v]&&(i[v]={top:[],right:[],bottom:[],left:[]});ft&&!i[y]&&(i[y]={top:[],right:[],bottom:[],left:[]});n!=y&&u.updateOffset({elId:y,timestamp:e});n!=v&&u.updateOffset({elId:v,timestamp:e});vt=u.getCachedData(y);yt=u.getCachedData(v);y==v&&(ut||ft)?s(i[v],-Math.PI/2,0,p,!1,y,0,!1,"top",v,b,g):(it||(it=w(v,y,yt.o,vt.o,p.endpoints[0].anchor,p.endpoints[1].anchor),ht[at]=it),ut&&s(i[v],it.theta,0,p,!1,y,0,!1,it.a[0],v,b,g),ft&&s(i[y],it.theta2,-1,p,!0,v,1,!0,it.a[1],y,b,g));ut&&jsPlumbUtil.addWithFunction(rt,v,function(n){return n===v});ft&&jsPlumbUtil.addWithFunction(rt,y,function(n){return n===y});jsPlumbUtil.addWithFunction(b,p,function(n){return n.id==p.id});(ut&&ot===0||ft&&ot===1)&&jsPlumbUtil.addWithFunction(g,p.endpoints[ot],function(n){return n.id==p.endpoints[ot].id})}}for(a=0;a<d.length;a++)d[a].connections.length===0&&d[a].anchor.isContinuous&&(i[n]||(i[n]={top:[],right:[],bottom:[],left:[]}),s(i[n],-Math.PI/2,0,{endpoints:[d[a],d[a]],paint:function(){}},!1,n,0,!1,d[a].anchor.getDefaultFace(),n,b,g),jsPlumbUtil.addWithFunction(rt,n,function(t){return t===n}));for(a=0;a<rt.length;a++)nt(rt[a],i[rt[a]]);for(a=0;a<d.length;a++)d[a].paint({timestamp:e,offset:st,dimensions:st.s,recalc:c!==!0});for(a=0;a<g.length;a++)ct=u.getCachedData(g[a].elementId),g[a].paint({timestamp:e,offset:ct,dimensions:ct.s});for(a=0;a<k.length;a++)if(tt=k[a][1],tt.anchor.constructor==jsPlumb.DynamicAnchor)for(tt.paint({elementWithPrecedence:n,timestamp:e}),jsPlumbUtil.addWithFunction(b,k[a][0],function(n){return n.id==k[a][0].id}),et=0;et<tt.connections.length;et++)tt.connections[et]!==k[a][0]&&jsPlumbUtil.addWithFunction(b,tt.connections[et],function(n){return n.id==tt.connections[et].id});else tt.anchor.constructor==jsPlumb.Anchor&&jsPlumbUtil.addWithFunction(b,k[a][0],function(n){return n.id==k[a][0].id});for(lt=l[n],lt&&lt.paint({timestamp:e,recalc:!1,elId:n}),a=0;a<b.length;a++)b[a].paint({elId:n,timestamp:e,recalc:!1,clearEdits:h})}};y=function(n){var r;jsPlumbUtil.EventGenerator.apply(this);this.type="Continuous";this.isDynamic=!0;this.isContinuous=!0;var i=n.faces||["top","right","bottom","left"],u=!(n.clockwise===!1),t={},f={top:"bottom",right:"left",left:"right",bottom:"top"},o={top:"right",right:"bottom",left:"top",bottom:"left"},s={top:"left",right:"top",left:"bottom",bottom:"right"},c=u?o:s,l=u?s:o,v=n.cssClass||"";for(r=0;r<i.length;r++)t[i[r]]=!0;this.getDefaultFace=function(){return i.length===0?"top":i[0]};this.verifyEdge=function(n){return t[n]?n:t[f[n]]?f[n]:t[c[n]]?c[n]:t[l[n]]?l[n]:n};this.isEdgeSupported=function(n){return t[n]===!0};this.compute=function(n){return e[n.element.id]||h[n.element.id]||[0,0]};this.getCurrentLocation=function(n){return e[n.element.id]||h[n.element.id]||[0,0]};this.getOrientation=function(n){return a[n.id]||[0,0]};this.clearUserDefinedLocation=function(){delete e[n.elementId]};this.setUserDefinedLocation=function(t){e[n.elementId]=t};this.getCssClass=function(){return v};this.setCssClass=function(n){v=n}};u.continuousAnchorFactory={get:function(n){return new y(n)},clear:function(n){delete e[n];delete h[n]}}};jsPlumb.Anchor=function(n){this.x=n.x||0;this.y=n.y||0;this.elementId=n.elementId;this.cssClass=n.cssClass||"";this.userDefinedLocation=null;this.orientation=n.orientation||[0,0];jsPlumbUtil.EventGenerator.apply(this);var t=n.jsPlumbInstance;this.lastReturnValue=null;this.offsets=n.offsets||[0,0];this.timestamp=null;this.compute=function(n){var i=n.xy,r=n.wh,u=n.element,t=n.timestamp;return(n.clearUserDefinedLocation&&(this.userDefinedLocation=null),t&&t===self.timestamp)?this.lastReturnValue:(this.lastReturnValue=this.userDefinedLocation!=null?this.userDefinedLocation:[i[0]+this.x*r[0]+this.offsets[0],i[1]+this.y*r[1]+this.offsets[1]],this.timestamp=t,this.lastReturnValue)};this.getCurrentLocation=function(n){return this.lastReturnValue==null||n.timestamp!=null&&this.timestamp!=n.timestamp?this.compute(n):this.lastReturnValue}};jsPlumbUtil.extend(jsPlumb.Anchor,jsPlumbUtil.EventGenerator,{equals:function(n){if(!n)return!1;var t=n.getOrientation(),i=this.getOrientation();return this.x==n.x&&this.y==n.y&&this.offsets[0]==n.offsets[0]&&this.offsets[1]==n.offsets[1]&&i[0]==t[0]&&i[1]==t[1]},getUserDefinedLocation:function(){return this.userDefinedLocation},setUserDefinedLocation:function(n){this.userDefinedLocation=n},clearUserDefinedLocation:function(){this.userDefinedLocation=null},getOrientation:function(){return this.orientation},getCssClass:function(){return this.cssClass}});jsPlumb.FloatingAnchor=function(n){jsPlumb.Anchor.apply(this,arguments);var u=n.reference,s=n.jsPlumbInstance,f=n.referenceCanvas,r=jsPlumb.getSize(f),e=0,o=0,t=null,i=null;this.orientation=null;this.x=0;this.y=0;this.isFloating=!0;this.compute=function(n){var t=n.xy,f=n.element,u=[t[0]+r[0]/2,t[1]+r[1]/2];return i=u,u};this.getOrientation=function(n){if(t)return t;var i=u.getOrientation(n);return[Math.abs(i[0])*e*-1,Math.abs(i[1])*o*-1]};this.over=function(n,i){t=n.getOrientation(i)};this.out=function(){t=null};this.getCurrentLocation=function(n){return i==null?this.compute(n):i}};jsPlumbUtil.extend(jsPlumb.FloatingAnchor,jsPlumb.Anchor);i=function(n,t,i){return n.constructor==jsPlumb.Anchor?n:t.makeAnchor(n,i,t)};jsPlumb.DynamicAnchor=function(n){var r;for(jsPlumb.Anchor.apply(this,arguments),this.isSelective=!0,this.isDynamic=!0,this.anchors=[],this.elementId=n.elementId,this.jsPlumbInstance=n.jsPlumbInstance,r=0;r<n.anchors.length;r++)this.anchors[r]=i(n.anchors[r],this.jsPlumbInstance,this.elementId);this.addAnchor=function(n){this.anchors.push(i(n,this.jsPlumbInstance,this.elementId))};this.getAnchors=function(){return this.anchors};this.locked=!1;var t=this.anchors.length>0?this.anchors[0]:null,s=this.anchors.length>0?0:-1,u=t,f=this,e=function(n,t,i,r,u){var f=r[0]+n.x*u[0],e=r[1]+n.y*u[1],o=r[0]+u[0]/2,s=r[1]+u[1]/2;return Math.sqrt(Math.pow(t-f,2)+Math.pow(i-e,2))+Math.sqrt(Math.pow(o-f,2)+Math.pow(s-e,2))},o=n.selector||function(n,t,i,r,u){for(var o,c=i[0]+r[0]/2,l=i[1]+r[1]/2,s=-1,h=Infinity,f=0;f<u.length;f++)o=e(u[f],c,l,n,t),o<h&&(s=f+0,h=o);return u[s]};this.compute=function(n){var s=n.xy,h=n.wh,c=n.timestamp,r=n.txy,e=n.twh,i;return(this.timestamp=c,i=f.getUserDefinedLocation(),i!=null)?i:this.locked||r==null||e==null?t.compute(n):(n.timestamp=null,t=o(s,h,r,e,this.anchors),this.x=t.x,this.y=t.y,t!=u&&this.fire("anchorChanged",t),u=t,t.compute(n))};this.getCurrentLocation=function(n){return this.getUserDefinedLocation()||(t!=null?t.getCurrentLocation(n):null)};this.getOrientation=function(n){return t!=null?t.getOrientation(n):[0,0]};this.over=function(n,i){t!=null&&t.over(n,i)};this.out=function(){t!=null&&t.out()};this.getCssClass=function(){return t&&t.getCssClass()||""}};jsPlumbUtil.extend(jsPlumb.DynamicAnchor,jsPlumb.Anchor);n=function(n,t,i,r,u,f){jsPlumb.Anchors[u]=function(e){var o=e.jsPlumbInstance.makeAnchor([n,t,i,r,0,0],e.elementId,e.jsPlumbInstance);return o.type=u,f&&f(o,e),o}};n(.5,0,0,-1,"TopCenter");n(.5,1,0,1,"BottomCenter");n(0,.5,-1,0,"LeftMiddle");n(1,.5,1,0,"RightMiddle");n(.5,0,0,-1,"Top");n(.5,1,0,1,"Bottom");n(0,.5,-1,0,"Left");n(1,.5,1,0,"Right");n(.5,.5,0,0,"Center");n(1,0,0,-1,"TopRight");n(1,1,0,1,"BottomRight");n(0,0,0,-1,"TopLeft");n(0,1,0,1,"BottomLeft");jsPlumb.Defaults.DynamicAnchors=function(n){return n.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],n.elementId,n.jsPlumbInstance)};jsPlumb.Anchors.AutoDefault=function(n){var t=n.jsPlumbInstance.makeDynamicAnchor(jsPlumb.Defaults.DynamicAnchors(n));return t.type="AutoDefault",t};t=function(n,t){jsPlumb.Anchors[n]=function(i){var r=i.jsPlumbInstance.makeAnchor(["Continuous",{faces:t}],i.elementId,i.jsPlumbInstance);return r.type=n,r}};jsPlumb.Anchors.Continuous=function(n){return n.jsPlumbInstance.continuousAnchorFactory.get(n)};t("ContinuousLeft",["left"]);t("ContinuousTop",["top"]);t("ContinuousBottom",["bottom"]);t("ContinuousRight",["right"]);n(0,0,0,0,"Assign",function(n,t){var i=t.position||"Fixed";n.positionFinder=i.constructor==String?t.jsPlumbInstance.AnchorPositionFinders[i]:i;n.constructorParams=t});jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(n,t,i){return[(n.left-t.left)/i[0],(n.top-t.top)/i[1]]},Grid:function(n,t,i,r){var e=n.left-t.left,o=n.top-t.top,u=i[0]/r.grid[0],f=i[1]/r.grid[1],s=Math.floor(e/u),h=Math.floor(o/f);return[(s*u+u/2)/i[0],(h*f+f/2)/i[1]]}};jsPlumb.Anchors.Perimeter=function(n){var t,i,r,f;if(n=n||{},t=n.anchorCount||60,i=n.shape,!i)throw new Error("no shape supplied to Perimeter Anchor type");var e=function(){for(var f,e,n=.5,o=Math.PI*2/t,i=0,r=[],u=0;u<t;u++)f=n+n*Math.sin(i),e=n+n*Math.cos(i),r.push([f,e,0,0]),i+=o;return r},o=function(n){for(var i=t/n.length,u=[],f=function(n,r,f,e,o){var h,c,s;for(i=t*o,h=(f-n)/i,c=(e-r)/i,s=0;s<i;s++)u.push([n+h*s,r+c*s,0,0])},r=0;r<n.length;r++)f.apply(null,n[r]);return u},u=function(n){for(var i=[],t=0;t<n.length;t++)i.push([n[t][0],n[t][1],n[t][2],n[t][3],1/n.length]);return o(i)},s=function(){return u([[0,0,1,0],[1,0,1,1],[1,1,0,1],[0,1,0,0]])},h={Circle:e,Ellipse:e,Diamond:function(){return u([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:s,Square:s,Triangle:function(){return u([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(n){for(var f,u,i=n.points,r=[],e=0,t=0;t<i.length-1;t++)f=Math.sqrt(Math.pow(i[t][2]-i[t][0])+Math.pow(i[t][3]-i[t][1])),e+=f,r.push([i[t][0],i[t][1],i[t+1][0],i[t+1][1],f]);for(u=0;u<r.length;u++)r[u][4]=r[u][4]/e;return o(r)}},c=function(n,t){for(var u,f,e=[],r=t/180*Math.PI,i=0;i<n.length;i++)u=n[i][0]-.5,f=n[i][1]-.5,e.push([.5+(u*Math.cos(r)-f*Math.sin(r)),.5+(u*Math.sin(r)+f*Math.cos(r)),n[i][2],n[i][3]]);return e};if(!h[i])throw new Error("Shape ["+i+"] is unknown by Perimeter Anchor type");return r=h[i](n),n.rotation&&(r=c(r,n.rotation)),f=n.jsPlumbInstance.makeDynamicAnchor(r),f.type="Perimeter",f}}(),function(){"use strict";var i,f,t,n,u,r;jsPlumb.Segments={AbstractSegment:function(n){this.params=n;this.findClosestPointOnPath=function(){return{d:Infinity,x:null,y:null,l:null}};this.getBounds=function(){return{minX:Math.min(n.x1,n.x2),minY:Math.min(n.y1,n.y2),maxX:Math.max(n.x1,n.x2),maxY:Math.max(n.y1,n.y2)}}},Straight:function(n){var l=jsPlumb.Segments.AbstractSegment.apply(this,arguments),e,f,h,t,r,i,u,c=function(){e=Math.sqrt(Math.pow(r-t,2)+Math.pow(u-i,2));f=Biltong.gradient({x:t,y:i},{x:r,y:u});h=-1/f},o,s;this.type="Straight";this.getLength=function(){return e};this.getGradient=function(){return f};this.getCoordinates=function(){return{x1:t,y1:i,x2:r,y2:u}};this.setCoordinates=function(n){t=n.x1;i=n.y1;r=n.x2;u=n.y2;c()};this.setCoordinates({x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y2});this.getBounds=function(){return{minX:Math.min(t,r),minY:Math.min(i,u),maxX:Math.max(t,r),maxY:Math.max(i,u)}};this.pointOnPath=function(n,f){if(n!==0||f){if(n!=1||f){var o=f?n>0?n:e+n:n*e;return Biltong.pointOnLine({x:t,y:i},{x:r,y:u},o)}return{x:r,y:u}}return{x:t,y:i}};this.gradientAtPoint=function(){return f};this.pointAlongPathFrom=function(n,f,e){var o=this.pointOnPath(n,e),s=f<=0?{x:t,y:i}:{x:r,y:u};return f<=0&&Math.abs(f)>1&&(f*=-1),Biltong.pointOnLine(o,s,f)};o=function(n,t,i){return i>=Math.min(n,t)&&i<=Math.max(n,t)};s=function(n,t,i){return Math.abs(i-n)<Math.abs(i-t)?n:t};this.findClosestPointOnPath=function(n,c){var l={d:Infinity,x:null,y:null,l:null,x1:t,x2:r,y1:i,y2:u},p;if(f===0)l.y=i,l.x=o(t,r,n)?n:s(t,r,n);else if(f==Infinity||f==-Infinity)l.x=t,l.y=o(i,u,c)?c:s(i,u,c);else{var y=i-f*t,w=c-h*n,a=(w-y)/(f-h),v=f*a+y;l.x=o(t,r,a)?a:s(t,r,a);l.y=o(i,u,v)?v:s(i,u,v)}return p=Biltong.lineLength([l.x,l.y],[t,i]),l.d=Biltong.lineLength([n,c],[l.x,l.y]),l.l=p/e,l}},Arc:function(n){var c=jsPlumb.Segments.AbstractSegment.apply(this,arguments),u=function(t,i){return Biltong.theta([n.cx,n.cy],[t,i])},s=function(n,i){var r,u,f,e;return n.anticlockwise?(r=n.startAngle<n.endAngle?n.startAngle+t:n.startAngle,u=Math.abs(r-n.endAngle),r-u*i):(f=n.endAngle<n.startAngle?n.endAngle+t:n.endAngle,e=Math.abs(f-n.startAngle),n.startAngle+e*i)},t=2*Math.PI,f,i,r;this.radius=n.r;this.anticlockwise=n.ac;this.type="Arc";n.startAngle&&n.endAngle?(this.startAngle=n.startAngle,this.endAngle=n.endAngle,this.x1=n.cx+this.radius*Math.cos(n.startAngle),this.y1=n.cy+this.radius*Math.sin(n.startAngle),this.x2=n.cx+this.radius*Math.cos(n.endAngle),this.y2=n.cy+this.radius*Math.sin(n.endAngle)):(this.startAngle=u(n.x1,n.y1),this.endAngle=u(n.x2,n.y2),this.x1=n.x1,this.y1=n.y1,this.x2=n.x2,this.y2=n.y2);this.endAngle<0&&(this.endAngle+=t);this.startAngle<0&&(this.startAngle+=t);this.segment=Biltong.quadrant([this.x1,this.y1],[this.x2,this.y2]);f=this.endAngle<this.startAngle?this.endAngle+t:this.endAngle;this.sweep=Math.abs(f-this.startAngle);this.anticlockwise&&(this.sweep=t-this.sweep);var e=2*Math.PI*this.radius,h=this.sweep/t,o=e*h;this.getLength=function(){return o};this.getBounds=function(){return{minX:n.cx-n.r,maxX:n.cx+n.r,minY:n.cy-n.r,maxY:n.cy+n.r}};i=1e-10;r=function(n){var t=Math.floor(n),r=Math.ceil(n);return n-t<i?t:r-n<i?r:n};this.pointOnPath=function(t,i){if(t===0)return{x:this.x1,y:this.y1,theta:this.startAngle};if(t==1)return{x:this.x2,y:this.y2,theta:this.endAngle};i&&(t=t/o);var u=s(this,t),f=n.cx+n.r*Math.cos(u),e=n.cy+n.r*Math.sin(u);return{x:r(f),y:r(e),theta:u}};this.gradientAtPoint=function(t,i){var u=this.pointOnPath(t,i),r=Biltong.normal([n.cx,n.cy],[u.x,u.y]);return this.anticlockwise||r!=Infinity&&r!=-Infinity||(r*=-1),r};this.pointAlongPathFrom=function(t,i,r){var f=this.pointOnPath(t,r),o=i/e*2*Math.PI,s=this.anticlockwise?-1:1,u=f.theta+s*o,h=n.cx+this.radius*Math.cos(u),c=n.cy+this.radius*Math.sin(u);return{x:h,y:c}}},Bezier:function(n){var i,t;this.curve=[{x:n.x1,y:n.y1},{x:n.cp1x,y:n.cp1y},{x:n.cp2x,y:n.cp2y},{x:n.x2,y:n.y2}];i=jsPlumb.Segments.AbstractSegment.apply(this,arguments);this.bounds={minX:Math.min(n.x1,n.x2,n.cp1x,n.cp2x),minY:Math.min(n.y1,n.y2,n.cp1y,n.cp2y),maxX:Math.max(n.x1,n.x2,n.cp1x,n.cp2x),maxY:Math.max(n.y1,n.y2,n.cp1y,n.cp2y)};this.type="Bezier";t=function(n,t,i){return i&&(t=jsBezier.locationAlongCurveFrom(n,t>0?0:1,t)),t};this.pointOnPath=function(n,i){return n=t(this.curve,n,i),jsBezier.pointOnCurve(this.curve,n)};this.gradientAtPoint=function(n,i){return n=t(this.curve,n,i),jsBezier.gradientAtPoint(this.curve,n)};this.pointAlongPathFrom=function(n,i,r){return n=t(this.curve,n,r),jsBezier.pointAlongCurveFrom(this.curve,n,i)};this.getLength=function(){return jsBezier.getLength(this.curve)};this.getBounds=function(){return this.bounds}}};i=function(){this.resetBounds=function(){this.bounds={minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}};this.resetBounds()};jsPlumb.Connectors.AbstractConnector=function(n){var y,g;i.apply(this,arguments);var t=[],r=0,u=[],a=[],e=n.stub||0,o=jsPlumbUtil.isArray(e)?e[0]:e,s=jsPlumbUtil.isArray(e)?e[1]:e,h=n.gap||0,c=jsPlumbUtil.isArray(h)?h[0]:h,l=jsPlumbUtil.isArray(h)?h[1]:h,p=null,w=!1,f=null;this.getPath=function(){};this.setPath=function(){};this.findSegmentForPoint=function(n,i){for(var u,r={d:Infinity,s:null,x:null,y:null,l:null},f=0;f<t.length;f++)u=t[f].findClosestPointOnPath(n,i),u.d<r.d&&(r.d=u.d,r.l=u.l,r.x=u.x,r.y=u.y,r.s=t[f],r.x1=u.x1,r.x2=u.x2,r.y1=u.y1,r.y2=u.y2,r.index=f);return r};var b=function(){for(var i,f=0,n=0;n<t.length;n++)i=t[n].getLength(),a[n]=i/r,u[n]=[f,f+=i/r]},v=function(n,i){var e,o,f;for(i&&(n=n>0?n/r:(r+n)/r),e=u.length-1,o=1,f=0;f<u.length;f++)if(u[f][1]>=n){e=f;o=n==1?1:n===0?0:(n-u[f][0])/a[f];break}return{segment:t[e],proportion:o,index:e}},k=function(n,i,u){if(u.x1!=u.x2||u.y1!=u.y2){var f=new jsPlumb.Segments[i](u);t.push(f);r+=f.getLength();n.updateBounds(f)}},d=function(){r=t.length=u.length=a.length=0};return this.setSegments=function(n){p=[];r=0;for(var t=0;t<n.length;t++)p.push(n[t]),r+=n[t].getLength()},y=function(n){var r,b;this.lineWidth=n.lineWidth;var nt=Biltong.quadrant(n.sourcePos,n.targetPos),p=n.targetPos[0]<n.sourcePos[0],w=n.targetPos[1]<n.sourcePos[1],tt=n.lineWidth||1,t=n.sourceEndpoint.anchor.getOrientation(n.sourceEndpoint),i=n.targetEndpoint.anchor.getOrientation(n.targetEndpoint),d=p?n.targetPos[0]:n.sourcePos[0],g=w?n.targetPos[1]:n.sourcePos[1],a=Math.abs(n.targetPos[0]-n.sourcePos[0]),v=Math.abs(n.targetPos[1]-n.sourcePos[1]);(t[0]===0&&t[1]===0||i[0]===0&&i[1]===0)&&(r=a>v?0:1,b=[1,0][r],t=[],i=[],t[r]=n.sourcePos[r]>n.targetPos[r]?-1:1,i[r]=n.sourcePos[r]>n.targetPos[r]?1:-1,t[b]=0,i[b]=0);var u=p?a+c*t[0]:c*t[0],f=w?v+c*t[1]:c*t[1],e=p?l*i[0]:a+l*i[0],h=w?l*i[1]:v+l*i[1],k=t[0]*i[0]+t[1]*i[1],y={sx:u,sy:f,tx:e,ty:h,lw:tt,xSpan:Math.abs(e-u),ySpan:Math.abs(h-f),mx:(u+e)/2,my:(f+h)/2,so:t,to:i,x:d,y:g,w:a,h:v,segment:nt,startStubX:u+t[0]*o,startStubY:f+t[1]*o,endStubX:e+i[0]*s,endStubY:h+i[1]*s,isXGreaterThanStubTimes2:Math.abs(u-e)>o+s,isYGreaterThanStubTimes2:Math.abs(f-h)>o+s,opposite:k==-1,perpendicular:k===0,orthogonal:k==1,sourceAxis:t[0]===0?"y":"x",points:[d,g,a,v,u,f,e,h]};return y.anchorOrientation=y.opposite?"opposite":y.orthogonal?"orthogonal":"perpendicular",y},this.getSegments=function(){return t},this.updateBounds=function(n){var t=n.getBounds();this.bounds.minX=Math.min(this.bounds.minX,t.minX);this.bounds.maxX=Math.max(this.bounds.maxX,t.maxX);this.bounds.minY=Math.min(this.bounds.minY,t.minY);this.bounds.maxY=Math.max(this.bounds.maxY,t.maxY)},g=function(){console.log("SEGMENTS:");for(var n=0;n<t.length;n++)console.log(t[n].type,t[n].getLength(),u[n])},this.pointOnPath=function(n,t){var i=v(n,t);return i.segment&&i.segment.pointOnPath(i.proportion,!1)||[0,0]},this.gradientAtPoint=function(n,t){var i=v(n,t);return i.segment&&i.segment.gradientAtPoint(i.proportion,!1)||0},this.pointAlongPathFrom=function(n,t,i){var r=v(n,i);return r.segment&&r.segment.pointAlongPathFrom(r.proportion,t,!1)||[0,0]},this.compute=function(n){w||(f=y.call(this,n));d();this._compute(f,n);this.x=f.points[0];this.y=f.points[1];this.w=f.points[2];this.h=f.points[3];this.segment=f.segment;b()},{addSegment:k,prepareCompute:y,sourceStub:o,targetStub:s,maxStub:Math.max(o,s),sourceGap:c,targetGap:l,maxGap:Math.max(c,l)}};jsPlumbUtil.extend(jsPlumb.Connectors.AbstractConnector,i);f=jsPlumb.Connectors.Straight=function(){this.type="Straight";var n=jsPlumb.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(t){n.addSegment(this,"Straight",{x1:t.sx,y1:t.sy,x2:t.startStubX,y2:t.startStubY});n.addSegment(this,"Straight",{x1:t.startStubX,y1:t.startStubY,x2:t.endStubX,y2:t.endStubY});n.addSegment(this,"Straight",{x1:t.endStubX,y1:t.endStubY,x2:t.tx,y2:t.ty})}};jsPlumbUtil.extend(jsPlumb.Connectors.Straight,jsPlumb.Connectors.AbstractConnector);jsPlumb.registerConnectorType(f,"Straight");jsPlumb.Endpoints.AbstractEndpoint=function(n){i.apply(this,arguments);var t=this.compute=function(){var n=this._compute.apply(this,arguments);return this.x=n[0],this.y=n[1],this.w=n[2],this.h=n[3],this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.w,this.bounds.maxY=this.y+this.h,n};return{compute:t,cssClass:n.cssClass}};jsPlumbUtil.extend(jsPlumb.Endpoints.AbstractEndpoint,i);jsPlumb.Endpoints.Dot=function(n){this.type="Dot";var t=jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);n=n||{};this.radius=n.radius||10;this.defaultOffset=.5*this.radius;this.defaultInnerRadius=this.radius/3;this._compute=function(n,t,i){var r;this.radius=i.radius||this.radius;var u=n[0]-this.radius,f=n[1]-this.radius,e=this.radius*2,o=this.radius*2;return i.strokeStyle&&(r=i.lineWidth||1,u-=r,f-=r,e+=r*2,o+=r*2),[u,f,e,o,this.radius]}};jsPlumbUtil.extend(jsPlumb.Endpoints.Dot,jsPlumb.Endpoints.AbstractEndpoint);jsPlumb.Endpoints.Rectangle=function(n){this.type="Rectangle";var t=jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);n=n||{};this.width=n.width||20;this.height=n.height||20;this._compute=function(n,t,i){var r=i.width||this.width,u=i.height||this.height,f=n[0]-r/2,e=n[1]-u/2;return[f,e,r,u]}};jsPlumbUtil.extend(jsPlumb.Endpoints.Rectangle,jsPlumb.Endpoints.AbstractEndpoint);t=function(){jsPlumb.jsPlumbUIComponent.apply(this,arguments);this._jsPlumb.displayElements=[]};jsPlumbUtil.extend(t,jsPlumb.jsPlumbUIComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(n){this._jsPlumb.displayElements.push(n)}});jsPlumb.Endpoints.Image=function(n){this.type="Image";t.apply(this,arguments);jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);var i=n.onload,r=n.src||n.url,u=n.cssClass?" "+n.cssClass:"";this._jsPlumb.img=new Image;this._jsPlumb.ready=!1;this._jsPlumb.initialized=!1;this._jsPlumb.deleted=!1;this._jsPlumb.widthToUse=n.width;this._jsPlumb.heightToUse=n.height;this._jsPlumb.endpoint=n.endpoint;this._jsPlumb.img.onload=function(){this._jsPlumb!=null&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,i&&i(this))}.bind(this);this._jsPlumb.endpoint.setImage=function(n,t){var r=n.constructor==String?n:n.src;i=t;this._jsPlumb.img.src=r;this.canvas!=null&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}.bind(this);this._jsPlumb.endpoint.setImage(r,i);this._compute=function(n){return this.anchorPoint=n,this._jsPlumb.ready?[n[0]-this._jsPlumb.widthToUse/2,n[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]:[0,0,0,0]};this.canvas=document.createElement("img");this.canvas.style.margin=0;this.canvas.style.padding=0;this.canvas.style.outline=0;this.canvas.style.position="absolute";this.canvas.className=this._jsPlumb.instance.endpointClass+u;this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse);this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse);this._jsPlumb.instance.appendElement(this.canvas);this.actuallyPaint=function(){if(!this._jsPlumb.deleted){this._jsPlumb.initialized||(this.canvas.setAttribute("src",this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0);var n=this.anchorPoint[0]-this._jsPlumb.widthToUse/2,t=this.anchorPoint[1]-this._jsPlumb.heightToUse/2;jsPlumbUtil.sizeElement(this.canvas,n,t,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}};this.paint=function(n,t){this._jsPlumb!=null&&(this._jsPlumb.ready?this.actuallyPaint(n,t):window.setTimeout(function(){this.paint(n,t)}.bind(this),200))}};jsPlumbUtil.extend(jsPlumb.Endpoints.Image,[t,jsPlumb.Endpoints.AbstractEndpoint],{cleanup:function(){this._jsPlumb.deleted=!0;this.canvas&&this.canvas.parentNode.removeChild(this.canvas);this.canvas=null}});jsPlumb.Endpoints.Blank=function(n){var r=jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments),i;this.type="Blank";t.apply(this,arguments);this._compute=function(n){return[n[0],n[1],10,0]};i=n.cssClass?" "+n.cssClass:"";this.canvas=document.createElement("div");this.canvas.style.display="block";this.canvas.style.width="1px";this.canvas.style.height="1px";this.canvas.style.background="transparent";this.canvas.style.position="absolute";this.canvas.className=this._jsPlumb.instance.endpointClass+i;this._jsPlumb.instance.appendElement(this.canvas);this.paint=function(){jsPlumbUtil.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}};jsPlumbUtil.extend(jsPlumb.Endpoints.Blank,[jsPlumb.Endpoints.AbstractEndpoint,t],{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}});jsPlumb.Endpoints.Triangle=function(n){this.type="Triangle";jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);n=n||{};n.width=n.width||55;n.height=n.height||55;this.width=n.width;this.height=n.height;this._compute=function(n,t,i){var r=i.width||self.width,u=i.height||self.height,f=n[0]-r/2,e=n[1]-u/2;return[f,e,r,u]}};n=jsPlumb.Overlays.AbstractOverlay=function(n){this.visible=!0;this.isAppendedAtTopLevel=!0;this.component=n.component;this.loc=n.location==null?.5:n.location;this.endpointLoc=n.endpointLocation==null?[.5,.5]:n.endpointLocation};n.prototype={cleanup:function(){this.component=null;this.canvas=null;this.endpointLoc=null},setVisible:function(n){this.visible=n;this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(n){this.loc+=n;this.component.repaint()},setLocation:function(n){this.loc=n;this.component.repaint()},getLocation:function(){return this.loc}};jsPlumb.Overlays.Arrow=function(t){var f,i;this.type="Arrow";n.apply(this,arguments);this.isAppendedAtTopLevel=!1;t=t||{};f=jsPlumbUtil;i=Biltong;this.length=t.length||20;this.width=t.width||20;this.id=t.id;var r=(t.direction||1)<0?-1:1,u=t.paintStyle||{lineWidth:1},e=t.foldback||.623;this.computeMaxSize=function(){return self.width*1.5};this.draw=function(n,t){var o,c,s,h,v,l,a,y,p;if(n.pointAlongPathFrom){f.isString(this.loc)||this.loc>1||this.loc<0?(l=parseInt(this.loc,10),a=this.loc<0?1:0,o=n.pointAlongPathFrom(a,l,!1),c=n.pointAlongPathFrom(a,l-r*this.length/2,!1),s=i.pointOnLine(o,c,this.length)):this.loc==1?(o=n.pointOnPath(this.loc),c=n.pointAlongPathFrom(this.loc,-this.length),s=i.pointOnLine(o,c,this.length),r==-1&&(y=s,s=o,o=y)):this.loc===0?(s=n.pointOnPath(this.loc),c=n.pointAlongPathFrom(this.loc,this.length),o=i.pointOnLine(s,c,this.length),r==-1&&(p=s,s=o,o=p)):(o=n.pointAlongPathFrom(this.loc,r*this.length/2),c=n.pointOnPath(this.loc),s=i.pointOnLine(o,c,this.length));h=i.perpendicularLineTo(o,s,this.width);v=i.pointOnLine(o,s,e*this.length);var w={hxy:o,tail:h,cxy:v},b=u.strokeStyle||t.strokeStyle,k=u.fillStyle||t.strokeStyle,d=u.lineWidth||t.lineWidth;return{component:n,d:w,lineWidth:d,strokeStyle:b,fillStyle:k,minX:Math.min(o.x,h[0].x,h[1].x),maxX:Math.max(o.x,h[0].x,h[1].x),minY:Math.min(o.y,h[0].y,h[1].y),maxY:Math.max(o.y,h[0].y,h[1].y)}}return{component:n,minX:0,maxX:0,minY:0,maxY:0}}};jsPlumbUtil.extend(jsPlumb.Overlays.Arrow,n);jsPlumb.Overlays.PlainArrow=function(n){n=n||{};var t=jsPlumb.extend(n,{foldback:1});jsPlumb.Overlays.Arrow.call(this,t);this.type="PlainArrow"};jsPlumbUtil.extend(jsPlumb.Overlays.PlainArrow,jsPlumb.Overlays.Arrow);jsPlumb.Overlays.Diamond=function(n){n=n||{};var t=n.length||40,i=jsPlumb.extend(n,{length:t/2,foldback:2});jsPlumb.Overlays.Arrow.call(this,i);this.type="Diamond"};jsPlumbUtil.extend(jsPlumb.Overlays.Diamond,jsPlumb.Overlays.Arrow);u=function(n,t){return(n._jsPlumb.cachedDimensions==null||t)&&(n._jsPlumb.cachedDimensions=n.getDimensions()),n._jsPlumb.cachedDimensions};r=function(t){jsPlumb.jsPlumbUIComponent.apply(this,arguments);n.apply(this,arguments);var i=this.fire;this.fire=function(){i.apply(this,arguments);this.component&&this.component.fire.apply(this.component,arguments)};this.id=t.id;this._jsPlumb.div=null;this._jsPlumb.initialised=!1;this._jsPlumb.component=t.component;this._jsPlumb.cachedDimensions=null;this._jsPlumb.create=t.create;this._jsPlumb.initiallyInvisible=t.visible===!1;this.getElement=function(){var n,i;return this._jsPlumb.div==null&&(n=this._jsPlumb.div=jsPlumb.getDOMElement(this._jsPlumb.create(this._jsPlumb.component)),n.style.position="absolute",n.className=this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:t.cssClass?t.cssClass:""),this._jsPlumb.instance.appendElement(n),this._jsPlumb.instance.getId(n),this.canvas=n,i="translate(-50%, -50%)",n.style.webkitTransform=i,n.style.mozTransform=i,n.style.msTransform=i,n.style.oTransform=i,n.style.transform=i,n._jsPlumb=this,t.visible===!1&&(n.style.display="none")),this._jsPlumb.div};this.draw=function(n,t,i){var r=u(this),f,s,h,c,e,o;return r!=null&&r.length==2?(f={x:0,y:0},i?f={x:i[0],y:i[1]}:n.pointOnPath?(s=this.loc,h=!1,(jsPlumbUtil.isString(this.loc)||this.loc<0||this.loc>1)&&(s=parseInt(this.loc,10),h=!0),f=n.pointOnPath(s,h)):(c=this.loc.constructor==Array?this.loc:this.endpointLoc,f={x:c[0]*n.w,y:c[1]*n.h}),e=f.x-r[0]/2,o=f.y-r[1]/2,{component:n,d:{minx:e,miny:o,td:r,cxy:f},minX:e,maxX:e+r[0],minY:o,maxY:o+r[1]}):{minX:0,maxX:0,minY:0,maxY:0}}};jsPlumbUtil.extend(r,[jsPlumb.jsPlumbUIComponent,n],{getDimensions:function(){return jsPlumbUtil.oldIE?jsPlumb.getSize(this.getElement()):[1,1]},setVisible:function(n){this._jsPlumb.div.style.display=n?"block":"none";n&&this._jsPlumb.initiallyInvisible&&(u(this,!0),this.component.repaint(),this._jsPlumb.initiallyInvisible=!1)},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(){this._jsPlumb.div!=null&&(this._jsPlumb.div._jsPlumb=null,this._jsPlumb.instance.removeElement(this._jsPlumb.div))},computeMaxSize:function(){var n=u(this);return Math.max(n[0],n[1])},paint:function(n){this._jsPlumb.initialised||(this.getElement(),n.component.appendDisplayElement(this._jsPlumb.div),this._jsPlumb.initialised=!0);this._jsPlumb.div.style.left=n.component.x+n.d.minx+"px";this._jsPlumb.div.style.top=n.component.y+n.d.miny+"px"}});jsPlumb.Overlays.Custom=function(){this.type="Custom";r.apply(this,arguments)};jsPlumbUtil.extend(jsPlumb.Overlays.Custom,r);jsPlumb.Overlays.GuideLines=function(){var t=this;t.length=50;t.lineWidth=5;this.type="GuideLines";n.apply(this,arguments);jsPlumb.jsPlumbUIComponent.apply(this,arguments);this.draw=function(n){var r=n.pointAlongPathFrom(t.loc,t.length/2),f=n.pointOnPath(t.loc),u=Biltong.pointOnLine(r,f,t.length),e=Biltong.perpendicularLineTo(r,u,40),i=Biltong.perpendicularLineTo(u,r,20);return{connector:n,head:r,tail:u,headLine:i,tailLine:e,minX:Math.min(r.x,u.x,i[0].x,i[1].x),minY:Math.min(r.y,u.y,i[0].y,i[1].y),maxX:Math.max(r.x,u.x,i[0].x,i[1].x),maxY:Math.max(r.y,u.y,i[0].y,i[1].y)}}};jsPlumb.Overlays.Label=function(n){var i,t,r;this.labelStyle=n.labelStyle;this.cssClass=this.labelStyle!=null?this.labelStyle.cssClass:null;i=jsPlumb.extend({create:function(){return document.createElement("div")}},n);jsPlumb.Overlays.Custom.call(this,i);this.type="Label";this.label=n.label||"";this.labelText=null;this.labelStyle&&(t=this.getElement(),this.labelStyle.font=this.labelStyle.font||"12px sans-serif",t.style.font=this.labelStyle.font,t.style.color=this.labelStyle.color||"black",this.labelStyle.fillStyle&&(t.style.background=this.labelStyle.fillStyle),this.labelStyle.borderWidth>0&&(r=this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black",t.style.border=this.labelStyle.borderWidth+"px solid "+r),this.labelStyle.padding&&(t.style.padding=this.labelStyle.padding))};jsPlumbUtil.extend(jsPlumb.Overlays.Label,jsPlumb.Overlays.Custom,{cleanup:function(){this.div=null;this.label=null;this.labelText=null;this.cssClass=null;this.labelStyle=null},getLabel:function(){return this.label},setLabel:function(n){this.label=n;this.labelText=null;this.clearCachedDimensions();this.update();this.component.repaint()},getDimensions:function(){return this.update(),r.prototype.getDimensions.apply(this,arguments)},update:function(){if(typeof this.label=="function"){var n=this.label(this);this.getElement().innerHTML=n.replace(/\r\n/g,"<br/>")}else this.labelText==null&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))}})}(),function(){var n=function(n){n=n||{};var r=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),u=n.stub||50,i=n.curviness||150,t=10;this.type="Bezier";this.getCurviness=function(){return i};this._findControlPoint=function(n,r,u,f,e){var s=f.anchor.getOrientation(f),h=e.anchor.getOrientation(e),c=s[0]!=h[0]||s[1]==h[1],o=[];return c?(h[0]===0?o.push(u[0]<r[0]?n[0]+t:n[0]-t):o.push(n[0]+i*h[0]),h[1]===0?o.push(u[1]<r[1]?n[1]+t:n[1]-t):o.push(n[1]+i*s[1])):(s[0]===0?o.push(r[0]<u[0]?n[0]+t:n[0]-t):o.push(n[0]-i*s[0]),s[1]===0?o.push(r[1]<u[1]?n[1]+t:n[1]-t):o.push(n[1]+i*h[1])),o};this._compute=function(n,t){var i=t.sourcePos,u=t.targetPos,f=Math.abs(i[0]-u[0]),e=Math.abs(i[1]-u[1]),o=i[0]<u[0]?f:0,s=i[1]<u[1]?e:0,h=i[0]<u[0]?0:f,c=i[1]<u[1]?0:e,l=this._findControlPoint([o,s],i,u,t.sourceEndpoint,t.targetEndpoint,n.so,n.to),a=this._findControlPoint([h,c],u,i,t.targetEndpoint,t.sourceEndpoint,n.so,n.to);r.addSegment(this,"Bezier",{x1:o,y1:s,x2:h,y2:c,cp1x:l[0],cp1y:l[1],cp2x:a[0],cp2y:a[1]})}};jsPlumbUtil.extend(n,jsPlumb.Connectors.AbstractConnector);jsPlumb.registerConnectorType(n,"Bezier")}(),function(){"use strict";var r=function(n,t,i,r){this.m=(r-t)/(i-n);this.b=-1*(this.m*n-t);this.rectIntersect=function(n,t,i,r){var u=[],f,e,o,s,h,c;return(f=(t-this.b)/this.m,f>=n&&f<=n+i&&u.push([f,this.m*f+this.b]),e=this.m*(n+i)+this.b,e>=t&&e<=t+r&&u.push([(e-this.b)/this.m,e]),f=(t+r-this.b)/this.m,f>=n&&f<=n+i&&u.push([f,this.m*f+this.b]),e=this.m*n+this.b,e>=t&&e<=t+r&&u.push([(e-this.b)/this.m,e]),u.length==2)?(o=(u[0][0]+u[1][0])/2,s=(u[0][1]+u[1][1])/2,u.push([o,s]),h=o<=n+i/2?-1:1,c=s<=t+r/2?-1:1,u.push([h,c]),u):null}},n=function(n,t,i,r){return n<=i&&r<=t?1:n<=i&&t<=r?2:i<=n&&r>=t?3:4},t=function(n,t,i,r,u,f,e,o,s){return o<=s?[n,t]:i===1?r[3]<=0&&u[3]>=1?[n+(r[2]<.5?-1*f:f),t]:r[2]>=1&&u[2]<=0?[n,t+(r[3]<.5?-1*e:e)]:[n+-1*f,t+-1*e]:i===2?r[3]>=1&&u[3]<=0?[n+(r[2]<.5?-1*f:f),t]:r[2]>=1&&u[2]<=0?[n,t+(r[3]<.5?-1*e:e)]:[n+1*f,t+-1*e]:i===3?r[3]>=1&&u[3]<=0?[n+(r[2]<.5?-1*f:f),t]:r[2]<=0&&u[2]>=1?[n,t+(r[3]<.5?-1*e:e)]:[n+-1*f,t+-1*e]:i===4?r[3]<=0&&u[3]>=1?[n+(r[2]<.5?-1*f:f),t]:r[2]<=0&&u[2]>=1?[n,t+(r[3]<.5?-1*e:e)]:[n+1*f,t+-1*e]:void 0},i=function(i){i=i||{};this.type="StateMachine";var c=this,e=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),f=i.curviness||10,r=i.margin||5,o=i.proximityLimit||80,s=i.orientation&&i.orientation==="clockwise",u=i.loopbackRadius||25,h=i.showLoopback!==!1;this._compute=function(i,c){var nt=Math.abs(c.sourcePos[0]-c.targetPos[0]),tt=Math.abs(c.sourcePos[1]-c.targetPos[1]),lt=Math.min(c.sourcePos[0],c.targetPos[0]),at=Math.min(c.sourcePos[1],c.targetPos[1]);if(h&&c.sourceEndpoint.elementId===c.targetEndpoint.elementId){var d=c.sourcePos[0],pt=c.sourcePos[0],g=c.sourcePos[1]-r,wt=c.sourcePos[1]-r,ft=d,et=g-u,ht=2*u,ct=2*u,b=ft-u,k=et-u;i.points[0]=b;i.points[1]=k;i.points[2]=ht;i.points[3]=ct;e.addSegment(this,"Arc",{loopback:!0,x1:d-b+4,y1:g-k,startAngle:0,endAngle:2*Math.PI,r:u,ac:!s,x2:d-b-4,y2:g-k,cx:ft-b,cy:et-k})}else{var l=c.sourcePos[0]<c.targetPos[0]?0:nt,a=c.sourcePos[1]<c.targetPos[1]?0:tt,v=c.sourcePos[0]<c.targetPos[0]?nt:0,y=c.sourcePos[1]<c.targetPos[1]?tt:0;c.sourcePos[2]===0&&(l-=r);c.sourcePos[2]===1&&(l+=r);c.sourcePos[3]===0&&(a-=r);c.sourcePos[3]===1&&(a+=r);c.targetPos[2]===0&&(v-=r);c.targetPos[2]===1&&(v+=r);c.targetPos[3]===0&&(y-=r);c.targetPos[3]===1&&(y+=r);var it=(l+v)/2,rt=(a+y)/2,p=-1*it/rt,ut=Math.atan(p),vt=p==Infinity||p==-Infinity?0:Math.abs(f/2*Math.sin(ut)),yt=p==Infinity||p==-Infinity?0:Math.abs(f/2*Math.cos(ut)),ot=n(l,a,v,y),st=Math.sqrt(Math.pow(v-l,2)+Math.pow(y-a,2)),w=t(it,rt,ot,c.sourcePos,c.targetPos,f,f,st,o);e.addSegment(this,"Bezier",{x1:v,y1:y,x2:l,y2:a,cp1x:w[0],cp1y:w[1],cp2x:w[0],cp2y:w[1]})}}};jsPlumb.registerConnectorType(i,"StateMachine")}(),function(){"use strict";var n=function(n){this.type="Flowchart";n=n||{};n.stub=n.stub==null?30:n.stub;var t=this,u=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),h=n.midpoint==null?.5:n.midpoint,i=[],w=n.grid,y=n.alwaysRespectStubs,r=null,f=null,e=null,p,c=n.cornerRadius!=null?n.cornerRadius:0,o=function(n){return n<0?-1:n===0?0:1},s=function(n,t,i,r){if(f!=t||e!=i){var u=f==null?r.sx:f,s=e==null?r.sy:e,h=u==t?"v":"h",c=o(t-u),l=o(i-s);f=t;e=i;n.push([u,s,t,i,h,c,l])}},l=function(n){return Math.sqrt(Math.pow(n[0]-n[2],2)+Math.pow(n[1]-n[3],2))},a=function(n){var t=[];return t.push.apply(t,n),t},b=function(n){t.bounds.minX=Math.min(t.bounds.minX,n[2]);t.bounds.maxX=Math.max(t.bounds.maxX,n[2]);t.bounds.minY=Math.min(t.bounds.minY,n[3]);t.bounds.maxY=Math.max(t.bounds.maxY,n[3])},v=function(n,t,i){for(var e,v,y,r,f,s=0;s<t.length-1;s++){if(r=r||a(t[s]),f=a(t[s+1]),c>0&&r[4]!=f[4]){e=Math.min(c,l(r),l(f));r[2]-=r[5]*e;r[3]-=r[6]*e;f[0]+=f[5]*e;f[1]+=f[6]*e;var o=r[6]==f[5]&&f[5]==1||r[6]==f[5]&&f[5]===0&&r[5]!=f[6]||r[6]==f[5]&&f[5]==-1,p=f[1]>r[3]?1:-1,w=f[0]>r[2]?1:-1,h=p==w,b=h&&o||!h&&!o?f[0]:r[2],k=h&&o||!h&&!o?r[3]:f[1];u.addSegment(n,"Straight",{x1:r[0],y1:r[1],x2:r[2],y2:r[3]});u.addSegment(n,"Arc",{r:e,x1:r[2],y1:r[3],x2:f[0],y2:f[1],cx:b,cy:k,ac:o})}else v=r[2]==r[0]?0:r[2]>r[0]?i.lw/2:-(i.lw/2),y=r[3]==r[1]?0:r[3]>r[1]?i.lw/2:-(i.lw/2),u.addSegment(n,"Straight",{x1:r[0]-v,y1:r[1]-y,x2:r[2]+v,y2:r[3]+y});r=f}f!=null&&u.addSegment(n,"Straight",{x1:f[0],y1:f[1],x2:f[2],y2:f[3]})};this.setSegments=function(n){r=n};this.isEditable=function(){return!0};this.getOriginalSegments=function(){return r||i};this._compute=function(n,t){var w,b;if(t.clearEdits&&(r=null),r!=null){v(this,r,n);return}i=[];f=null;e=null;p=null;var o=n.startStubX+(n.endStubX-n.startStubX)*h,c=n.startStubY+(n.endStubY-n.startStubY)*h,et=function(n,t,i,r){return n+(t*(1-i)*r+u.maxStub)},k={x:[0,1],y:[1,0]},d=function(){return[n.startStubX,n.startStubY,n.endStubX,n.endStubY]},nt={perpendicular:d,orthogonal:d,opposite:function(t){var i=n,r=t=="x"?0:1,u={x:function(){return i.so[r]==1&&(i.startStubX>i.endStubX&&i.tx>i.startStubX||i.sx>i.endStubX&&i.tx>i.sx)||i.so[r]==-1&&(i.startStubX<i.endStubX&&i.tx<i.startStubX||i.sx<i.endStubX&&i.tx<i.sx)},y:function(){return i.so[r]==1&&(i.startStubY>i.endStubY&&i.ty>i.startStubY||i.sy>i.endStubY&&i.ty>i.sy)||i.so[r]==-1&&(i.startStubY<i.endStubY&&i.ty<i.startStubY||i.sy<i.endStubY&&i.ty<i.sy)}};return!y&&u[t]()?{x:[(n.sx+n.tx)/2,n.startStubY,(n.sx+n.tx)/2,n.endStubY],y:[n.startStubX,(n.sy+n.ty)/2,n.endStubX,(n.sy+n.ty)/2]}[t]:[n.startStubX,n.startStubY,n.endStubX,n.endStubY]}},tt={perpendicular:function(t){var i=n,h={x:[[i.startStubX,i.endStubX],null,[i.endStubX,i.startStubX]],y:[[i.startStubY,i.endStubY],null,[i.endStubY,i.startStubY]]},v={x:[[o,i.startStubY],[o,i.endStubY]],y:[[i.startStubX,c],[i.endStubX,c]]},y={x:[[i.endStubX,i.startStubY]],y:[[i.startStubX,i.endStubY]]},p={x:[[i.startStubX,i.endStubY],[i.endStubX,i.endStubY]],y:[[i.endStubX,i.startStubY],[i.endStubX,i.endStubY]]},w={x:[[i.startStubX,c],[i.endStubX,c],[i.endStubX,i.endStubY]],y:[[o,i.startStubY],[o,i.endStubY],[i.endStubX,i.endStubY]]},u={x:[i.startStubY,i.endStubY],y:[i.startStubX,i.endStubX]},b=k[t][0],f=k[t][1],e=i.so[b]+1,d=i.to[f]+1,s=i.to[f]==-1&&u[t][1]<u[t][0]||i.to[f]==1&&u[t][1]>u[t][0],l=h[t][e][0],a=h[t][e][1],r={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]}[t][e][d];return i.segment==r[3]||i.segment==r[2]&&s?v[t]:i.segment==r[2]&&a<l?y[t]:i.segment==r[2]&&a>=l||i.segment==r[1]&&!s?w[t]:i.segment==r[0]||i.segment==r[1]&&s?p[t]:void 0},orthogonal:function(t,i,r,u,f){var o=n,e={x:o.so[0]==-1?Math.min(i,u):Math.max(i,u),y:o.so[1]==-1?Math.min(i,u):Math.max(i,u)}[t];return{x:[[e,r],[e,f],[u,f]],y:[[r,e],[f,e],[f,u]]}[t]},opposite:function(i,r,f,e){var s=n,l={x:"y",y:"x"}[i],v={x:"height",y:"width"}[i],y=s["is"+i.toUpperCase()+"GreaterThanStubTimes2"],h;return t.sourceEndpoint.elementId==t.targetEndpoint.elementId?(h=f+(1-t.sourceEndpoint.anchor[l])*t.sourceInfo[v]+u.maxStub,{x:[[r,h],[e,h]],y:[[h,r],[h,e]]}[i]):!y||s.so[a]==1&&r>e||s.so[a]==-1&&r<e?{x:[[r,c],[e,c]],y:[[o,r],[o,e]]}[i]:s.so[a]==1&&r<e||s.so[a]==-1&&r>e?{x:[[o,s.sy],[o,s.ty]],y:[[s.sx,c],[s.tx,c]]}[i]:void 0}},l=nt[n.anchorOrientation](n.sourceAxis),a=n.sourceAxis=="x"?0:1,g=n.sourceAxis=="x"?1:0,it=l[a],rt=l[g],ut=l[a+2],ft=l[g+2];if(s(i,l[0],l[1],n),w=tt[n.anchorOrientation](n.sourceAxis,it,rt,ut,ft),w)for(b=0;b<w.length;b++)s(i,w[b][0],w[b][1],n);s(i,l[2],l[3],n);s(i,n.tx,n.ty,n);v(this,i,n)};this.getPath=function(){for(var t=null,f=null,e=[],o=r||i,u=0;u<o.length;u++){var n=o[u],s=n[4],h=s=="v"?3:2;t!=null&&f===s?t[h]=n[h]:(n[0]!=n[2]||n[1]!=n[3])&&(e.push({start:[n[0],n[1]],end:[n[2],n[3]]}),t=n,f=n[4])}return e};this.setPath=function(n){var t;for(r=[],t=0;t<n.length;t++){var i=n[t].start[0],f=n[t].start[1],u=n[t].end[0],e=n[t].end[1],s=i==u?"v":"h",h=o(u-i),c=o(e-f);r.push([i,f,u,e,s,h,c])}}};jsPlumbUtil.extend(n,jsPlumb.Connectors.AbstractConnector);jsPlumb.registerConnectorType(n,"Flowchart")}(),function(){var r=function(){var n=this},n="ontouchstart"in document.documentElement,u=n?"touchstart":"mousedown",t=n?"touchend":"mouseup",i=n?"touchmove":"mousemove",f=function(n,t,i,r){var f=n[0]==n[2]?Infinity:0,s=-1/f,u={s:n,m:f,i:r,x:-1,y:-1,d:Infinity};if(f==0)(n[0]<=t&&t<=n[2]||n[2]<=t&&t<=n[0])&&(u.x=t,u.y=n[1],u.d=Math.abs(i-n[1]));else if(f==Infinity||f==-Infinity)(n[1]<=i&&i<=n[3]||n[3]<=i&&i<=n[1])&&(u.x=n[0],u.y=i,u.d=Math.abs(t-n[0]));else{var h=n[1]-f*n[0],c=i-s*t,e=(c-h)/(f-s),o=f*e+h,l=Biltong.lineLength([t,i],[e,o]),a=Biltong.lineLength([e,o],[n[0],n[1]]);u.d=l;u.x=e;u.y=o;u.l=a/length}return u};jsPlumb.ConnectorEditors={Flowchart:function(n){r.apply(this,arguments);var b=function(n){n._jsPlumb.afterEditClick=function(){return console.log("after edit click"),n.unbind("click",n._jsPlumb.afterEditClick),n._jsPlumb.afterEditClick=null,!1};n.bind("click",n._jsPlumb.afterEditClick,!0)},a=function(r){jsPlumbAdapter.removeClass(document.body,n.connection._jsPlumb.instance.dragSelectClass);n.connection._jsPlumb.instance.setConnectionBeingDragged(!1);r.stopPropagation();r.preventDefault();jsPlumb.off(document,t,a);jsPlumb.off(document,i,y);c=null;e=null;o=null;s=null;n.connection.setHover(!1);n.connector.setSuspendEvents(!1);n.connection.endpoints[0].setSuspendEvents(!1);n.connection.endpoints[1].setSuspendEvents(!1);n.connection.editCompleted();n.connector.justEdited=h;h=!1},c=null,e=null,o=null,s=null,h=!1,p=!0,k=function(n,t){return n[0]==t[0]?n[1]<t[1]?1:-1:n[0]<t[0]?1:-1},w=function(){for(var t=null,r=null,u=[],i=0;i<e.length;i++){var n=e[i],f=n[4],o=f=="v"?3:2;t!=null&&r===f?t[o]=n[o]:(u.push(n),t=n,r=n[4])}e=u},v=function(t,i,r){var h=jsPlumb.getSize(t.element),o=h[i?1:0],c=jsPlumb.getElementObject(t.element),l=jsPlumb.getOffset(c),a=jsPlumb.getElementObject(n.connector.canvas.parentNode),v=jsPlumb.getOffset(a),u=l[i?"top":"left"]-v[i?"top":"left"],f=t.anchor.getCurrentLocation({element:t}),e=i?n.connector.y+r:n.connector.x+r,y,s;return p?u<e&&e<u+o?(y=[f[0],f[1]],f[i?1:0]=e,t.anchor.setUserDefinedLocation(f),r):(s=e<u?u:u+o,s-(i?n.connector.y:n.connector.x)):f[i?1:0]-n.connector[i?"y":"x"]},l=function(n){n[0]!=n[2]&&(n[5]=n[0]<n[2]?1:-1);n[1]!=n[3]&&(n[6]=n[1]<n[3]?1:-1)},y=function(t){var f;if(o!=null){h||(n.connection.setHover(!0),n.connector.setSuspendEvents(!0),n.connection.endpoints[0].setSuspendEvents(!0),n.connection.endpoints[1].setSuspendEvents(!0));h=!0;var w=o.m,a=o.s,d=t.pageX||t.page.x,g=t.pageY||t.page.y,b=w==0?0:d-c[0],k=w==0?g-c[1]:0,i=s[0]+b,r=s[1]+k,y=s[2]+b,p=s[3]+k,u=a[4]=="h";o.i==0?(f=v(n.connection.endpoints[0],u,u?r:i),u?r=p=f:i=y=f,e[1][0]=y,e[1][1]=p,l(e[1])):o.i==e.length-1?(f=v(n.connection.endpoints[1],u,u?r:i),u?r=p=f:i=y=f,e[e.length-2][2]=i,e[e.length-2][3]=r,l(e[e.length-2])):(u?(e[o.i-1][3]=r,e[o.i+1][1]=p):(e[o.i-1][2]=i,e[o.i+1][0]=y),l(e[o.i+1]),l(e[o.i-1]));a[0]=i;a[1]=r;a[2]=y;a[3]=p;n.connector.setSegments(e);n.connection.repaint();n.connection.endpoints[0].repaint();n.connection.endpoints[1].repaint();n.connector.setEdited(!0)}else h=!1};n.connector.bind(u,function(r,u){var p=u.pageX||u.page.x,b=u.pageY||u.page.y,d=jsPlumb.getElementObject(n.connection.getConnector().canvas),v=jsPlumbAdapter.getOffset(d,n.connection._jsPlumb.instance),k=Infinity,g=n.connector.findSegmentForPoint(p-v.left,b-v.top),l,h;for(console.log(g),e=n.connector.getOriginalSegments(),w(),l=0;l<e.length;l++)h=f(e[l],p-v.left,b-v.top,l,n.connector.bounds),h.d<k&&(o=h,s=[h.s[0],h.s[1],h.s[2],h.s[3]],k=h.d);if(c=[p,b],o!=null){jsPlumb.on(document,t,a);jsPlumb.on(document,i,y);return jsPlumbAdapter.addClass(document.body,n.connection._jsPlumb.instance.dragSelectClass),n.connection._jsPlumb.instance.setConnectionBeingDragged(!0),n.connection.editStarted(),!1}},!0)}};jsPlumb.Connectors.AbstractConnector.prototype.shouldFireEvent=function(n){var t=!this.justEdited;return n=="click"&&(this.justEdited=!1),t};var e="editStarted",o="editCompleted",s="editCanceled";jsPlumb.Connection.prototype.setEditable=function(n){return this.connector&&this.connector.isEditable()&&(this._jsPlumb.editable=n),this._jsPlumb.editable};jsPlumb.Connection.prototype.isEditable=function(){return this._jsPlumb.editable};jsPlumb.Connection.prototype.editStarted=function(){this.setSuspendEvents(!0);this.fire(e,{path:this.connector.getPath()});this._jsPlumb.instance.setHoverSuspended(!0)};jsPlumb.Connection.prototype.editCompleted=function(){this.fire(o,{path:this.connector.getPath()});this.setSuspendEvents(!1);this._jsPlumb.instance.setHoverSuspended(!1);this.setHover(!1)};jsPlumb.Connection.prototype.editCanceled=function(){this.fire(s,{path:this.connector.getPath()});this._jsPlumb.instance.setHoverSuspended(!1);this.setHover(!1)}}(),function(){"use strict";var h={joinstyle:"stroke-linejoin","stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},f="stroke-dasharray",o="dashstyle",c="linearGradient",l="radialGradient",a="defs",v="fill",d="stop",y="stroke",g="stroke-width",nt="style",p="none",tt="jsplumb_gradient_",it="lineWidth",w={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml"},t=function(n,t){for(var i in t)n.setAttribute(i,""+t[i])},n=function(n,i){var r=document.createElementNS(w.svg,n);return i=i||{},i.version="1.1",i.xmlns=w.xhtml,t(r,i),r},e=function(n){return"position:absolute;left:"+n[0]+"px;top:"+n[1]+"px"},b=function(n){for(var t=0;t<n.childNodes.length;t++)(n.childNodes[t].tagName==a||n.childNodes[t].tagName==c||n.childNodes[t].tagName==l)&&n.removeChild(n.childNodes[t])},rt=function(t,i,r,u,f){var o=tt+f._jsPlumb.instance.idstamp(),s,h,e,p;for(b(t),s=r.gradient.offset?n(l,{id:o}):n(c,{id:o,gradientUnits:"userSpaceOnUse"}),h=n(a),t.appendChild(h),h.appendChild(s),e=0;e<r.gradient.stops.length;e++){var w=f.segment==1||f.segment==2?e:r.gradient.stops.length-1-e,k=jsPlumbUtil.convertStyle(r.gradient.stops[w][1],!0),g=n(d,{offset:Math.floor(r.gradient.stops[e][0]*100)+"%","stop-color":k});s.appendChild(g)}p=r.strokeStyle?y:v;i.setAttribute(p,"url(#"+o+")")},s=function(n,t,i,r,u){var e;if(t.setAttribute(v,i.fillStyle?jsPlumbUtil.convertStyle(i.fillStyle,!0):p),t.setAttribute(y,i.strokeStyle?jsPlumbUtil.convertStyle(i.strokeStyle,!0):p),i.gradient?rt(n,t,i,r,u):(b(n),t.setAttribute(nt,"")),i.lineWidth&&t.setAttribute(g,i.lineWidth),i[o]&&i[it]&&!i[f]){var s=i[o].indexOf(",")==-1?" ":",",l=i[o].split(s),c="";l.forEach(function(n){c+=Math.floor(n*i.lineWidth)+s});t.setAttribute(f,c)}else i[f]&&t.setAttribute(f,i[f]);for(e in h)i[e]&&t.setAttribute(h[e],i[e])},ut=function(n){var t=n.match(/([0-9].)(p[xt])\s(.*)/);return{size:t[1]+t[2],font:t[3]}},k=function(n,t,i){n.childNodes.length>i?n.insertBefore(t,n.childNodes[i]):n.appendChild(t)},r,u,i;jsPlumbUtil.svg={node:n,attr:t,pos:e};r=function(i){var s=i.pointerEventsSpec||"all",f={},r,o,u;return jsPlumb.jsPlumbUIComponent.apply(this,i.originalArgs),this.canvas=null,this.path=null,this.svg=null,this.bgCanvas=null,r=i.cssClass+" "+(i.originalArgs[0].cssClass||""),o={style:"",width:0,height:0,"pointer-events":s,position:"absolute"},this.svg=n("svg",o),i.useDivWrapper?(this.canvas=document.createElement("div"),this.canvas.style.position="absolute",jsPlumbUtil.sizeElement(this.canvas,0,0,1,1),this.canvas.className=r):(t(this.svg,{"class":r}),this.canvas=this.svg),i._jsPlumb.appendElement(this.canvas,i.originalArgs[0].parent),i.useDivWrapper&&this.canvas.appendChild(this.svg),u=[this.canvas],this.getDisplayElements=function(){return u},this.appendDisplayElement=function(n){u.push(n)},this.paint=function(n,r,u){if(n!=null){var o=[this.x,this.y],s=[this.w,this.h],h;u!=null&&(u.xmin<0&&(o[0]+=u.xmin),u.ymin<0&&(o[1]+=u.ymin),s[0]=u.xmax+(u.xmin<0?-u.xmin:0),s[1]=u.ymax+(u.ymin<0?-u.ymin:0));i.useDivWrapper?(jsPlumbUtil.sizeElement(this.canvas,o[0],o[1],s[0],s[1]),o[0]=0,o[1]=0,h=e([0,0])):h=e([o[0],o[1]]);f.paint.apply(this,arguments);t(this.svg,{style:h,width:s[0],height:s[1]})}},{renderer:f}};jsPlumbUtil.extend(r,jsPlumb.jsPlumbUIComponent,{cleanup:function(){this.canvas&&(this.canvas._jsPlumb=null);this.svg&&(this.svg._jsPlumb=null);this.bgCanvas&&(this.bgCanvas._jsPlumb=null);this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);this.bgCanvas&&this.bgCanvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);this.svg=null;this.canvas=null;this.path=null;this.group=null},setVisible:function(n){this.canvas&&(this.canvas.style.display=n?"block":"none")}});jsPlumb.ConnectorRenderers.svg=function(i){var u=this,f=r.apply(this,[{cssClass:i._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:i._jsPlumb}]);f.renderer.paint=function(r,f,e){var a=u.getSegments(),v="",h=[0,0],c,p,w;if(e.xmin<0&&(h[0]=-e.xmin),e.ymin<0&&(h[1]=-e.ymin),a.length>0){for(c=0;c<a.length;c++)v+=jsPlumb.Segments.svg.SegmentRenderer.getPath(a[c]),v+=" ";var l={d:v,transform:"translate("+h[0]+","+h[1]+")","pointer-events":i["pointer-events"]||"visibleStroke"},o=null,y=[u.x,u.y,u.w,u.h];r.outlineColor&&(p=r.outlineWidth||1,w=r.lineWidth+2*p,o=jsPlumb.extend({},r),delete o.gradient,o.strokeStyle=jsPlumbUtil.convertStyle(r.outlineColor),o.lineWidth=w,u.bgPath==null?(u.bgPath=n("path",l),k(u.svg,u.bgPath,0)):t(u.bgPath,l),s(u.svg,u.bgPath,o,y,u));u.path==null?(u.path=n("path",l),k(u.svg,u.path,r.outlineColor?1:0)):t(u.path,l);s(u.svg,u.path,r,y,u)}}};jsPlumbUtil.extend(jsPlumb.ConnectorRenderers.svg,r);jsPlumb.Segments.svg={SegmentRenderer:{getPath:function(n){return{Straight:function(){var t=n.getCoordinates();return"M "+t.x1+" "+t.y1+" L "+t.x2+" "+t.y2},Bezier:function(){var t=n.params;return"M "+t.x1+" "+t.y1+" C "+t.cp1x+" "+t.cp1y+" "+t.cp2x+" "+t.cp2y+" "+t.x2+" "+t.y2},Arc:function(){var t=n.params,i=n.sweep>Math.PI?1:0,r=n.anticlockwise?0:1;return"M"+n.x1+" "+n.y1+" A "+n.radius+" "+t.r+" 0 "+i+","+r+" "+n.x2+" "+n.y2}}[n.type]()}}};u=window.SvgEndpoint=function(n){var t=r.apply(this,[{cssClass:n._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:n._jsPlumb}]);t.renderer.paint=function(n){var t=jsPlumb.extend({},n);t.outlineColor&&(t.strokeWidth=t.outlineWidth,t.strokeStyle=jsPlumbUtil.convertStyle(t.outlineColor,!0));this.node==null?(this.node=this.makeNode(t),this.svg.appendChild(this.node)):this.updateNode!=null&&this.updateNode(this.node);s(this.svg,this.node,t,[this.x,this.y,this.w,this.h],this);e(this.node,[this.x,this.y])}.bind(this)};jsPlumbUtil.extend(u,r);jsPlumb.Endpoints.svg.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments);u.apply(this,arguments);this.makeNode=function(){return n("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})};this.updateNode=function(n){t(n,{cx:this.w/2,cy:this.h/2,r:this.radius})}};jsPlumbUtil.extend(jsPlumb.Endpoints.svg.Dot,[jsPlumb.Endpoints.Dot,u]);jsPlumb.Endpoints.svg.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments);u.apply(this,arguments);this.makeNode=function(){return n("rect",{width:this.w,height:this.h})};this.updateNode=function(n){t(n,{width:this.w,height:this.h})}};jsPlumbUtil.extend(jsPlumb.Endpoints.svg.Rectangle,[jsPlumb.Endpoints.Rectangle,u]);jsPlumb.Endpoints.svg.Image=jsPlumb.Endpoints.Image;jsPlumb.Endpoints.svg.Blank=jsPlumb.Endpoints.Blank;jsPlumb.Overlays.svg.Label=jsPlumb.Overlays.Label;jsPlumb.Overlays.svg.Custom=jsPlumb.Overlays.Custom;i=function(i,r){var f,u;i.apply(this,r);jsPlumb.jsPlumbUIComponent.apply(this,r);this.isAppendedAtTopLevel=!1;f=this;this.path=null;this.paint=function(i,f){if(i.component.svg&&f){this.path==null&&(this.path=n("path",{"pointer-events":"all"}),i.component.svg.appendChild(this.path),this.canvas=i.component.svg);var o=r&&r.length==1?r[0].cssClass||"":"",e=[0,0];f.xmin<0&&(e[0]=-f.xmin);f.ymin<0&&(e[1]=-f.ymin);t(this.path,{d:u(i.d),"class":o,stroke:i.strokeStyle?i.strokeStyle:null,fill:i.fillStyle?i.fillStyle:null,transform:"translate("+e[0]+","+e[1]+")"})}};u=function(n){return"M"+n.hxy.x+","+n.hxy.y+" L"+n.tail[0].x+","+n.tail[0].y+" L"+n.cxy.x+","+n.cxy.y+" L"+n.tail[1].x+","+n.tail[1].y+" L"+n.hxy.x+","+n.hxy.y}};jsPlumbUtil.extend(i,[jsPlumb.jsPlumbUIComponent,jsPlumb.Overlays.AbstractOverlay],{cleanup:function(){this.path!=null&&this._jsPlumb.instance.removeElement(this.path)},setVisible:function(n){this.path!=null&&(this.path.style.display=n?"block":"none")}});jsPlumb.Overlays.svg.Arrow=function(){i.apply(this,[jsPlumb.Overlays.Arrow,arguments])};jsPlumbUtil.extend(jsPlumb.Overlays.svg.Arrow,[jsPlumb.Overlays.Arrow,i]);jsPlumb.Overlays.svg.PlainArrow=function(){i.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])};jsPlumbUtil.extend(jsPlumb.Overlays.svg.PlainArrow,[jsPlumb.Overlays.PlainArrow,i]);jsPlumb.Overlays.svg.Diamond=function(){i.apply(this,[jsPlumb.Overlays.Diamond,arguments])};jsPlumbUtil.extend(jsPlumb.Overlays.svg.Diamond,[jsPlumb.Overlays.Diamond,i]);jsPlumb.Overlays.svg.GuideLines=function(){var r=null,i=this,u,f,e;jsPlumb.Overlays.GuideLines.apply(this,arguments);this.paint=function(o,s){r==null&&(r=n("path"),o.connector.svg.appendChild(r),i.attachListeners(r,o.connector),i.attachListeners(r,i),u=n("path"),o.connector.svg.appendChild(u),i.attachListeners(u,o.connector),i.attachListeners(u,i),f=n("path"),o.connector.svg.appendChild(f),i.attachListeners(f,o.connector),i.attachListeners(f,i));var h=[0,0];s.xmin<0&&(h[0]=-s.xmin);s.ymin<0&&(h[1]=-s.ymin);t(r,{d:e(o.head,o.tail),stroke:"red",fill:null,transform:"translate("+h[0]+","+h[1]+")"});t(u,{d:e(o.tailLine[0],o.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+h[0]+","+h[1]+")"});t(f,{d:e(o.headLine[0],o.headLine[1]),stroke:"green",fill:null,transform:"translate("+h[0]+","+h[1]+")"})};e=function(n,t){return"M "+n.x+","+n.y+" L"+t.x+","+t.y}};jsPlumbUtil.extend(jsPlumb.Overlays.svg.GuideLines,jsPlumb.Overlays.GuideLines)}(),function(){"use strict";var p={"stroke-linejoin":"joinstyle",joinstyle:"joinstyle",endcap:"endcap",miterlimit:"miterlimit"},l=null,h,a,s,y,o,r;if(document.createStyleSheet&&document.namespaces){for(h=[".jsplumb_vml","jsplumb\\:textbox","jsplumb\\:oval","jsplumb\\:rect","jsplumb\\:stroke","jsplumb\\:shape","jsplumb\\:group"],a="behavior:url(#default#VML);position:absolute;",l=document.createStyleSheet(),s=0;s<h.length;s++)l.addRule(h[s],a);document.namespaces.add("jsplumb","urn:schemas-microsoft-com:vml")}jsPlumb.vml={};var t=1e3,f=function(n,t){for(var i in t)n[i]=t[i]},i=function(n,t,i,r,u,o){i=i||{};var s=document.createElement("jsplumb:"+n);return o?u.appendElement(s,r):r.appendChild(s),s.className=(i["class"]?i["class"]+" ":"")+"jsplumb_vml",e(s,t),f(s,i),s},e=function(n,t,i){n.style.left=t[0]+"px";n.style.top=t[1]+"px";n.style.width=t[2]+"px";n.style.height=t[3]+"px";n.style.position="absolute";i&&(n.style.zIndex=i)},n=jsPlumb.vml.convertValue=function(n){return Math.floor(n*t)},v=function(n,t,i,r){"transparent"===t?r.setOpacity(i,"0.0"):r.setOpacity(i,"1.0")},c=function(n,t,r,u){var e={},s,h,o;if(t.strokeStyle?(e.stroked="true",s=jsPlumbUtil.convertStyle(t.strokeStyle,!0),e.strokecolor=s,v(e,s,"stroke",r),e.strokeweight=t.lineWidth+"px"):e.stroked="false",t.fillStyle?(e.filled="true",h=jsPlumbUtil.convertStyle(t.fillStyle,!0),e.fillcolor=h,v(e,h,"fill",r)):e.filled="false",t.dashstyle)r.strokeNode==null?r.strokeNode=i("stroke",[0,0,0,0],{dashstyle:t.dashstyle},n,u):r.strokeNode.dashstyle=t.dashstyle;else if(t["stroke-dasharray"]&&t.lineWidth){var l=t["stroke-dasharray"].indexOf(",")==-1?" ":",",a=t["stroke-dasharray"].split(l),c="";for(o=0;o<a.length;o++)c+=Math.floor(a[o]/t.lineWidth)+l;r.strokeNode==null?r.strokeNode=i("stroke",[0,0,0,0],{dashstyle:c},n,u):r.strokeNode.dashstyle=c}f(n,e)},u=function(){var n=this,t;jsPlumb.jsPlumbUIComponent.apply(this,arguments);this.opacityNodes={stroke:null,fill:null};this.initOpacityNodes=function(t){n.opacityNodes.stroke=i("stroke",[0,0,1,1],{opacity:"0.0"},t,n._jsPlumb.instance);n.opacityNodes.fill=i("fill",[0,0,1,1],{opacity:"0.0"},t,n._jsPlumb.instance)};this.setOpacity=function(t,i){var r=n.opacityNodes[t];r&&(r.opacity=""+i)};t=[];this.getDisplayElements=function(){return t};this.appendDisplayElement=function(i,r){r||n.canvas.parentNode.appendChild(i);t.push(i)}};jsPlumbUtil.extend(u,jsPlumb.jsPlumbUIComponent,{cleanup:function(){this.bgCanvas&&this.bgCanvas.parentNode.removeChild(this.bgCanvas);this.canvas&&this.canvas.parentNode.removeChild(this.canvas)}});y=jsPlumb.ConnectorRenderers.vml=function(n,r){this.strokeNode=null;this.canvas=null;u.apply(this,arguments);var o=this._jsPlumb.instance.connectorClass+(n.cssClass?" "+n.cssClass:"");this.paint=function(u){var l,a;if(u!==null){this.w=Math.max(this.w,1);this.h=Math.max(this.h,1);var v=this.getSegments(),h={path:""},s=[this.x,this.y,this.w,this.h];for(l=0;l<v.length;l++)h.path+=jsPlumb.Segments.vml.SegmentRenderer.getPath(v[l]),h.path+=" ";if(u.outlineColor){var w=u.outlineWidth||1,b=u.lineWidth+2*w,y={strokeStyle:jsPlumbUtil.convertStyle(u.outlineColor),lineWidth:b};for(a in p)y[a]=u[a];this.bgCanvas==null?(h["class"]=o,h.coordsize=s[2]*t+","+s[3]*t,this.bgCanvas=i("shape",s,h,n.parent,this._jsPlumb.instance,!0),e(this.bgCanvas,s),this.appendDisplayElement(this.bgCanvas,!0),this.initOpacityNodes(this.bgCanvas,["stroke"]),this.bgCanvas._jsPlumb=r):(h.coordsize=s[2]*t+","+s[3]*t,e(this.bgCanvas,s),f(this.bgCanvas,h));c(this.bgCanvas,y,this)}this.canvas==null?(h["class"]=o,h.coordsize=s[2]*t+","+s[3]*t,this.canvas=i("shape",s,h,n.parent,this._jsPlumb.instance,!0),this.appendDisplayElement(this.canvas,!0),this.initOpacityNodes(this.canvas,["stroke"]),this.canvas._jsPlumb=r):(h.coordsize=s[2]*t+","+s[3]*t,e(this.canvas,s),f(this.canvas,h));c(this.canvas,u,this,this._jsPlumb.instance)}}};jsPlumbUtil.extend(y,u,{setVisible:function(n){this.canvas&&(this.canvas.style.display=n?"block":"none");this.bgCanvas&&(this.bgCanvas.style.display=n?"block":"none")}});o=window.VmlEndpoint=function(n){u.apply(this,arguments);this._jsPlumb.vml=null;this.canvas=document.createElement("div");this.canvas.style.position="absolute";this._jsPlumb.clazz=this._jsPlumb.instance.endpointClass+(n.cssClass?" "+n.cssClass:"");n._jsPlumb.appendElement(this.canvas,n.parent);this.paint=function(n,t){var r={},i=this._jsPlumb.vml;jsPlumbUtil.sizeElement(this.canvas,this.x,this.y,this.w,this.h);this._jsPlumb.vml==null?(r["class"]=this._jsPlumb.clazz,i=this._jsPlumb.vml=this.getVml([0,0,this.w,this.h],r,t,this.canvas,this._jsPlumb.instance),this.appendDisplayElement(i,!0),this.appendDisplayElement(this.canvas,!0),this.initOpacityNodes(i,["fill"])):(e(i,[0,0,this.w,this.h]),f(i,r));c(i,n,this)}};jsPlumbUtil.extend(o,u);jsPlumb.Segments.vml={SegmentRenderer:{getPath:function(t){return{Straight:function(t){var i=t.params;return"m"+n(i.x1)+","+n(i.y1)+" l"+n(i.x2)+","+n(i.y2)+" e"},Bezier:function(t){var i=t.params;return"m"+n(i.x1)+","+n(i.y1)+" c"+n(i.cp1x)+","+n(i.cp1y)+","+n(i.cp2x)+","+n(i.cp2y)+","+n(i.x2)+","+n(i.y2)+" e"},Arc:function(t){var i=t.params,r=Math.min(i.x1,i.x2),s=Math.max(i.x1,i.x2),u=Math.min(i.y1,i.y2),h=Math.max(i.y1,i.y2),f=t.anticlockwise?1:0,e=t.anticlockwise?"at ":"wa ",o=function(){if(i.loopback)return"0,0,"+n(2*i.r)+","+n(2*i.r);var e=[null,[function(){return[r,u]},function(){return[r-i.r,u-i.r]}],[function(){return[r-i.r,u]},function(){return[r,u-i.r]}],[function(){return[r-i.r,u-i.r]},function(){return[r,u]}],[function(){return[r,u-i.r]},function(){return[r-i.r,u]}]][t.segment][f]();return n(e[0])+","+n(e[1])+","+n(e[0]+2*i.r)+","+n(e[1]+2*i.r)};return e+" "+o()+","+n(i.x1)+","+n(i.y1)+","+n(i.x2)+","+n(i.y2)+" e"}}[t.type](t)}}};jsPlumb.Endpoints.vml.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments);o.apply(this,arguments);this.getVml=function(n,t,r,u,f){return i("oval",n,t,u,f)}};jsPlumbUtil.extend(jsPlumb.Endpoints.vml.Dot,o);jsPlumb.Endpoints.vml.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments);o.apply(this,arguments);this.getVml=function(n,t,r,u,f){return i("rect",n,t,u,f)}};jsPlumbUtil.extend(jsPlumb.Endpoints.vml.Rectangle,o);jsPlumb.Endpoints.vml.Image=jsPlumb.Endpoints.Image;jsPlumb.Endpoints.vml.Blank=jsPlumb.Endpoints.Blank;jsPlumb.Overlays.vml.Label=jsPlumb.Overlays.Label;jsPlumb.Overlays.vml.Custom=jsPlumb.Overlays.Custom;r=function(r,o){var s,c,h;r.apply(this,o);u.apply(this,o);s=this;c=null;this.canvas=null;this.isAppendedAtTopLevel=!0;h=function(t){return"m "+n(t.hxy.x)+","+n(t.hxy.y)+" l "+n(t.tail[0].x)+","+n(t.tail[0].y)+" "+n(t.cxy.x)+","+n(t.cxy.y)+" "+n(t.tail[1].x)+","+n(t.tail[1].y)+" x e"};this.paint=function(n,r){var p,w;if(n.component.canvas&&r){var c={},u=n.d,l=n.component;n.strokeStyle&&(c.stroked="true",c.strokecolor=jsPlumbUtil.convertStyle(n.strokeStyle,!0));n.lineWidth&&(c.strokeweight=n.lineWidth+"px");n.fillStyle&&(c.filled="true",c.fillcolor=n.fillStyle);var v=Math.min(u.hxy.x,u.tail[0].x,u.tail[1].x,u.cxy.x),y=Math.min(u.hxy.y,u.tail[0].y,u.tail[1].y,u.cxy.y),b=Math.max(u.hxy.x,u.tail[0].x,u.tail[1].x,u.cxy.x),k=Math.max(u.hxy.y,u.tail[0].y,u.tail[1].y,u.cxy.y),d=Math.abs(b-v),g=Math.abs(k-y),a=[v,y,d,g];c.path=h(u);c.coordsize=l.w*t+","+l.h*t;a[0]=l.x;a[1]=l.y;a[2]=l.w;a[3]=l.h;s.canvas==null?(p=l._jsPlumb.overlayClass||"",w=o&&o.length==1?o[0].cssClass||"":"",c["class"]=w+" "+p,s.canvas=i("shape",a,c,l.canvas.parentNode,l._jsPlumb.instance,!0),l.appendDisplayElement(s.canvas,!0)):(e(s.canvas,a),f(s.canvas,c))}};this.cleanup=function(){this.canvas!=null&&this._jsPlumb.instance.removeElement(this.canvas)}};jsPlumbUtil.extend(r,[u,jsPlumb.Overlays.AbstractOverlay],{setVisible:function(n){this.canvas.style.display=n?"block":"none"}});jsPlumb.Overlays.vml.Arrow=function(){r.apply(this,[jsPlumb.Overlays.Arrow,arguments])};jsPlumbUtil.extend(jsPlumb.Overlays.vml.Arrow,[jsPlumb.Overlays.Arrow,r]);jsPlumb.Overlays.vml.PlainArrow=function(){r.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])};jsPlumbUtil.extend(jsPlumb.Overlays.vml.PlainArrow,[jsPlumb.Overlays.PlainArrow,r]);jsPlumb.Overlays.vml.Diamond=function(){r.apply(this,[jsPlumb.Overlays.Diamond,arguments])};jsPlumbUtil.extend(jsPlumb.Overlays.vml.Diamond,[jsPlumb.Overlays.Diamond,r])}(),function(){"use strict";var n=function(n){var t=n._mottle;return t||(t=n._mottle=new Mottle),t};jsPlumb.extend(jsPlumbInstance.prototype,{getEventManager:function(){return n(this)},on:function(){this.getEventManager().on.apply(this,arguments)},off:function(){this.getEventManager().off.apply(this,arguments)}})}.call(this),function(){"use strict";var n=function(n,t){t=t||"main";var r="_katavorio_"+t,i=n[r],u=n.getEventManager();return i||(i=new Katavorio({bind:u.on,unbind:u.off,getSize:jsPlumb.getSize,getPosition:function(t){var i=jsPlumbAdapter.getOffset(t,n);return[i.left,i.top]},setPosition:function(n,t){n.style.left=t[0]+"px";n.style.top=t[1]+"px"},addClass:jsPlumbAdapter.addClass,removeClass:jsPlumbAdapter.removeClass,intersects:Biltong.intersects,indexOf:jsPlumbUtil.indexOf,css:{noSelect:n.dragSelectClass,droppable:"jsplumb-droppable",draggable:"jsplumb-draggable",drag:"jsplumb-drag",selected:"jsplumb-drag-selected",active:"jsplumb-drag-active",hover:"jsplumb-drag-hover"}}),n[r]=i,n.bind("zoom",i.setZoom)),i},i=function(n,t){var i=function(i){if(t[i]){if(jsPlumbUtil.isString(t[i])){var r=t[i].match(/-=/)?-1:1,u=t[i].substring(2);return n[i]+r*u}return t[i]}return n[i]};return[i("left"),i("top")]},t;jsPlumb.extend(jsPlumbInstance.prototype,{scopeChange:function(){},getDOMElement:function(n){return n==null?null:(n=typeof n=="string"?n:n.length!=null?n[0]:n,typeof n=="string"?document.getElementById(n):n)},getElementObject:function(n){return n},removeElement:function(t){n(this).elementRemoved(t);this.getEventManager().remove(t)},doAnimate:function(n,t,r){r=r||{};var u=jsPlumbAdapter.getOffset(n,this),s=i(u,t),h=s[0]-u.left,c=s[1]-u.top,o=r.duration||250,f=15,l=o/f,a=f/o*h,v=f/o*c,e=0,y=setInterval(function(){jsPlumbAdapter.setPosition(n,{left:u.left+a*(e+1),top:u.top+v*(e+1)});r.step!=null&&r.step();e++;e>=l&&(window.clearInterval(y),r.complete!=null&&r.complete())},f)},getSelector:function(n,t){return arguments.length==1?n.nodeType!=null?n:document.querySelectorAll(n):n.querySelectorAll(t)},destroyDraggable:function(t,i){n(this,i).destroyDraggable(t)},destroyDroppable:function(t,i){n(this,i).destroyDroppable(t)},initDraggable:function(t,i,r){n(this,r).draggable(t,i)},initDroppable:function(t,i,r){n(this,r).droppable(t,i)},isAlreadyDraggable:function(n){return n._katavorioDrag!=null},isDragSupported:function(){return!0},isDropSupported:function(){return!0},getDragObject:function(n){return n[0].drag.getDragElement()},getDragScope:function(n){return n._katavorioDrag&&n._katavorioDrag.scopes.join(" ")||""},getDropEvent:function(n){return n[0].e},getDropScope:function(n){return n._katavorioDrop&&n._katavorioDrop.scopes.join(" ")||""},getUIPosition:function(n){return{left:n[0].pos[0],top:n[0].pos[1]}},isDragFilterSupported:function(){return!0},setDragFilter:function(n,t){n._katavorioDrag&&n._katavorioDrag.setFilter(t)},setElementDraggable:function(n,t){n=jsPlumb.getDOMElement(n);n._katavorioDrag&&n._katavorioDrag.setEnabled(t)},setDragScope:function(n,t){n._katavorioDrag&&n._katavorioDrag.k.setDragScope(n,t)},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete"},animEvents:{step:"step",complete:"complete"},stopDrag:function(n){n._katavorioDrag&&n._katavorioDrag.abort()},addToDragSelection:function(t){n(this).select(t)},removeFromDragSelection:function(t){n(this).deselect(t)},clearDragSelection:function(){n(this).deselectAll()},getOriginalEvent:function(n){return n},trigger:function(n,t,i){this.getEventManager().trigger(n,t,i)}});t=function(n){var t=function(){/complete|loaded|interactive/.test(document.readyState)&&typeof document.body!="undefined"&&document.body!=null?n():setTimeout(t,9)};t()};t(jsPlumb.init)}.call(this);
//# sourceMappingURL=jsplumbfull.min.js.map
