(function(){var r=function(){var n=this},n="ontouchstart"in document.documentElement,u=n?"touchstart":"mousedown",t=n?"touchend":"mouseup",i=n?"touchmove":"mousemove",f=function(n,t,i,r){var f=n[0]==n[2]?Infinity:0,s=-1/f,u={s:n,m:f,i:r,x:-1,y:-1,d:Infinity};if(f==0)(n[0]<=t&&t<=n[2]||n[2]<=t&&t<=n[0])&&(u.x=t,u.y=n[1],u.d=Math.abs(i-n[1]));else if(f==Infinity||f==-Infinity)(n[1]<=i&&i<=n[3]||n[3]<=i&&i<=n[1])&&(u.x=n[0],u.y=i,u.d=Math.abs(t-n[0]));else{var h=n[1]-f*n[0],c=i-s*t,e=(c-h)/(f-s),o=f*e+h,l=Biltong.lineLength([t,i],[e,o]),a=Biltong.lineLength([e,o],[n[0],n[1]]);u.d=l;u.x=e;u.y=o;u.l=a/length}return u};jsPlumb.ConnectorEditors={Flowchart:function(n){r.apply(this,arguments);var b=function(n){n._jsPlumb.afterEditClick=function(){return console.log("after edit click"),n.unbind("click",n._jsPlumb.afterEditClick),n._jsPlumb.afterEditClick=null,!1};n.bind("click",n._jsPlumb.afterEditClick,!0)},a=function(r){jsPlumbAdapter.removeClass(document.body,n.connection._jsPlumb.instance.dragSelectClass);n.connection._jsPlumb.instance.setConnectionBeingDragged(!1);r.stopPropagation();r.preventDefault();jsPlumb.off(document,t,a);jsPlumb.off(document,i,y);c=null;e=null;o=null;s=null;n.connection.setHover(!1);n.connector.setSuspendEvents(!1);n.connection.endpoints[0].setSuspendEvents(!1);n.connection.endpoints[1].setSuspendEvents(!1);n.connection.editCompleted();n.connector.justEdited=h;h=!1},c=null,e=null,o=null,s=null,h=!1,p=!0,k=function(n,t){return n[0]==t[0]?n[1]<t[1]?1:-1:n[0]<t[0]?1:-1},w=function(){for(var t=null,r=null,u=[],i=0;i<e.length;i++){var n=e[i],f=n[4],o=f=="v"?3:2;t!=null&&r===f?t[o]=n[o]:(u.push(n),t=n,r=n[4])}e=u},v=function(t,i,r){var h=jsPlumb.getSize(t.element),o=h[i?1:0],c=jsPlumb.getElementObject(t.element),l=jsPlumb.getOffset(c),a=jsPlumb.getElementObject(n.connector.canvas.parentNode),v=jsPlumb.getOffset(a),u=l[i?"top":"left"]-v[i?"top":"left"],f=t.anchor.getCurrentLocation({element:t}),e=i?n.connector.y+r:n.connector.x+r,y,s;return p?u<e&&e<u+o?(y=[f[0],f[1]],f[i?1:0]=e,t.anchor.setUserDefinedLocation(f),r):(s=e<u?u:u+o,s-(i?n.connector.y:n.connector.x)):f[i?1:0]-n.connector[i?"y":"x"]},l=function(n){n[0]!=n[2]&&(n[5]=n[0]<n[2]?1:-1);n[1]!=n[3]&&(n[6]=n[1]<n[3]?1:-1)},y=function(t){var f;if(o!=null){h||(n.connection.setHover(!0),n.connector.setSuspendEvents(!0),n.connection.endpoints[0].setSuspendEvents(!0),n.connection.endpoints[1].setSuspendEvents(!0));h=!0;var w=o.m,a=o.s,d=t.pageX||t.page.x,g=t.pageY||t.page.y,b=w==0?0:d-c[0],k=w==0?g-c[1]:0,i=s[0]+b,r=s[1]+k,y=s[2]+b,p=s[3]+k,u=a[4]=="h";o.i==0?(f=v(n.connection.endpoints[0],u,u?r:i),u?r=p=f:i=y=f,e[1][0]=y,e[1][1]=p,l(e[1])):o.i==e.length-1?(f=v(n.connection.endpoints[1],u,u?r:i),u?r=p=f:i=y=f,e[e.length-2][2]=i,e[e.length-2][3]=r,l(e[e.length-2])):(u?(e[o.i-1][3]=r,e[o.i+1][1]=p):(e[o.i-1][2]=i,e[o.i+1][0]=y),l(e[o.i+1]),l(e[o.i-1]));a[0]=i;a[1]=r;a[2]=y;a[3]=p;n.connector.setSegments(e);n.connection.repaint();n.connection.endpoints[0].repaint();n.connection.endpoints[1].repaint();n.connector.setEdited(!0)}else h=!1};n.connector.bind(u,function(r,u){var p=u.pageX||u.page.x,b=u.pageY||u.page.y,d=jsPlumb.getElementObject(n.connection.getConnector().canvas),v=jsPlumbAdapter.getOffset(d,n.connection._jsPlumb.instance),k=Infinity,g=n.connector.findSegmentForPoint(p-v.left,b-v.top),l,h;for(console.log(g),e=n.connector.getOriginalSegments(),w(),l=0;l<e.length;l++)h=f(e[l],p-v.left,b-v.top,l,n.connector.bounds),h.d<k&&(o=h,s=[h.s[0],h.s[1],h.s[2],h.s[3]],k=h.d);if(c=[p,b],o!=null){jsPlumb.on(document,t,a);jsPlumb.on(document,i,y);return jsPlumbAdapter.addClass(document.body,n.connection._jsPlumb.instance.dragSelectClass),n.connection._jsPlumb.instance.setConnectionBeingDragged(!0),n.connection.editStarted(),!1}},!0)}};jsPlumb.Connectors.AbstractConnector.prototype.shouldFireEvent=function(n){var t=!this.justEdited;return n=="click"&&(this.justEdited=!1),t};var e="editStarted",o="editCompleted",s="editCanceled";jsPlumb.Connection.prototype.setEditable=function(n){return this.connector&&this.connector.isEditable()&&(this._jsPlumb.editable=n),this._jsPlumb.editable};jsPlumb.Connection.prototype.isEditable=function(){return this._jsPlumb.editable};jsPlumb.Connection.prototype.editStarted=function(){this.setSuspendEvents(!0);this.fire(e,{path:this.connector.getPath()});this._jsPlumb.instance.setHoverSuspended(!0)};jsPlumb.Connection.prototype.editCompleted=function(){this.fire(o,{path:this.connector.getPath()});this.setSuspendEvents(!1);this._jsPlumb.instance.setHoverSuspended(!1);this.setHover(!1)};jsPlumb.Connection.prototype.editCanceled=function(){this.fire(s,{path:this.connector.getPath()});this._jsPlumb.instance.setHoverSuspended(!1);this.setHover(!1)}})();
//# sourceMappingURL=connector-editors.min.js.map
