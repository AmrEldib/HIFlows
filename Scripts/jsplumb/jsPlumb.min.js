(function(){"use strict";var t=jsPlumbUtil,o=function(n,t,i){return jsPlumbAdapter.getOffset(n,t,i)},r=function(){return""+(new Date).getTime()},c=function(t){if(t._jsPlumb.paintStyle&&t._jsPlumb.hoverPaintStyle){var i={};n.extend(i,t._jsPlumb.paintStyle);n.extend(i,t._jsPlumb.hoverPaintStyle);delete t._jsPlumb.hoverPaintStyle;i.gradient&&t._jsPlumb.paintStyle.fillStyle&&delete i.gradient;t._jsPlumb.hoverPaintStyle=i}},l=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu"],w=function(n,t,i,r){var f=n.getAttachedElements(),u,e;if(f)for(u=0,e=f.length;u<e;u++)r&&r==f[u]||f[u].setHover(t,!0,i)},f=function(n){return n==null?null:n.split(" ")},i=function(n,i,r){var e,u,f,o;if(n.getDefaultType){for(e=n.getTypeDescriptor(),u=t.merge({},n.getDefaultType()),f=0,o=n._jsPlumb.types.length;f<o;f++)u=t.merge(u,n._jsPlumb.instance.getType(n._jsPlumb.types[f],e),["cssClass"]);i&&(u=t.populate(u,i));n.applyType(u,r);r||n.repaint()}},u=window.jsPlumbUIComponent=function(n){var i;jsPlumbUtil.EventGenerator.apply(this,arguments);var r=this,f=arguments,e=r.idPrefix,o=e+(new Date).getTime();if(this._jsPlumb={instance:n._jsPlumb,parameters:n.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:n.beforeDetach,beforeDrop:n.beforeDrop,overlayPlacements:[],hoverClass:n.hoverClass||n._jsPlumb.Defaults.HoverClass,types:[]},this.getId=function(){return o},n.events)for(i in n.events)r.bind(i,n.events[i]);this.clone=function(){var n={};return this.constructor.apply(n,f),n}.bind(this);this.isDetachAllowed=function(n){var i=!0;if(this._jsPlumb.beforeDetach)try{i=this._jsPlumb.beforeDetach(n)}catch(r){t.log("jsPlumb: beforeDetach callback failed",r)}return i};this.isDropAllowed=function(n,i,r,u,f,e,o){var s=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:n,targetId:i,scope:r,connection:u,dropEndpoint:f,source:e,target:o});if(this._jsPlumb.beforeDrop)try{s=this._jsPlumb.beforeDrop({sourceId:n,targetId:i,scope:r,connection:u,dropEndpoint:f,source:e,target:o})}catch(h){t.log("jsPlumb: beforeDrop callback failed",h)}return s};var s=[],h=function(n,t,i){s.push([n,t,i]);n.bind(t,i)},u=[];this.setListenerComponent=function(n){for(var t=0;t<u.length;t++)u[t][3]=n}},s=function(n,t){var r=n._jsPlumb.types[t],i=n._jsPlumb.instance.getType(r,n.getTypeDescriptor());i!=null&&i.cssClass&&n.canvas&&n._jsPlumb.instance.removeClass(n.canvas,i.cssClass)},n;jsPlumbUtil.extend(u,jsPlumbUtil.EventGenerator,{getParameter:function(n){return this._jsPlumb.parameters[n]},setParameter:function(n,t){this._jsPlumb.parameters[n]=t},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(n){this._jsPlumb.parameters=n},addClass:function(n){jsPlumbAdapter.addClass(this.canvas,n)},removeClass:function(n){jsPlumbAdapter.removeClass(this.canvas,n)},updateClasses:function(n,t){jsPlumbAdapter.updateClasses(this.canvas,n,t)},setType:function(n,t,r){this.clearTypes();this._jsPlumb.types=f(n)||[];i(this,t,r)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(n,t){i(this,n,t)},hasType:function(n){return jsPlumbUtil.indexOf(this._jsPlumb.types,n)!=-1},addType:function(n,t,r){var e=f(n),o=!1,u,s;if(e!=null){for(u=0,s=e.length;u<s;u++)this.hasType(e[u])||(this._jsPlumb.types.push(e[u]),o=!0);o&&i(this,t,r)}},removeType:function(n,r){var e=f(n),o=!1,c=function(n){var i=t.indexOf(this._jsPlumb.types,n);return i!=-1?(s(this,i),this._jsPlumb.types.splice(i,1),!0):!1}.bind(this),u,h;if(e!=null){for(u=0,h=e.length;u<h;u++)o=c(e[u])||o;o&&i(this,null,r)}},clearTypes:function(n){for(var r=this._jsPlumb.types.length,t=0;t<r;t++)s(this,0),this._jsPlumb.types.splice(0,1);i(this,{},n)},toggleType:function(n,t,r){var e=f(n),u,h,o;if(e!=null){for(u=0,h=e.length;u<h;u++)o=jsPlumbUtil.indexOf(this._jsPlumb.types,e[u]),o!=-1?(s(this,o),this._jsPlumb.types.splice(o,1)):this._jsPlumb.types.push(e[u]);i(this,t,r)}},applyType:function(n,t){if(this.setPaintStyle(n.paintStyle,t),this.setHoverPaintStyle(n.hoverPaintStyle,t),n.parameters)for(var i in n.parameters)this.setParameter(i,n.parameters[i])},setPaintStyle:function(n,t){this._jsPlumb.paintStyle=n;this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle;c(this);t||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(n,t){this._jsPlumb.hoverPaintStyle=n;c(this);t||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},destroy:function(){this.cleanupListeners();this.clone=null;this._jsPlumb=null},isHover:function(){return this._jsPlumb.hover},setHover:function(n,t,i){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){if(this._jsPlumb.hover=n,this.canvas!=null){if(this._jsPlumb.instance.hoverClass!=null){var u=n?"addClass":"removeClass";this._jsPlumb.instance[u](this.canvas,this._jsPlumb.instance.hoverClass)}this._jsPlumb.hoverClass!=null&&this._jsPlumb.instance[u](this.canvas,this._jsPlumb.hoverClass)}this._jsPlumb.hoverPaintStyle!=null&&(this._jsPlumb.paintStyleInUse=n?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(i=i||r(),this.repaint({timestamp:i,recalc:!1})));this.getAttachedElements&&!t&&w(this,n,r(),this)}}});var e="__label",a=function(n,t){for(var r=-1,i=0,u=n._jsPlumb.overlays.length;i<u;i++)if(t===n._jsPlumb.overlays[i].id){r=i;break}return r},v=function(t,i){var r={cssClass:i.cssClass,labelStyle:t.labelStyle,id:e,component:t,_jsPlumb:t._jsPlumb.instance},u=n.extend(r,i);return new n.Overlays[t._jsPlumb.instance.getRenderMode()].Label(u)},y=function(i,r){var u=null,e,f;t.isArray(r)?(e=r[0],f=n.extend({component:i,_jsPlumb:i._jsPlumb.instance},r[1]),r.length==3&&n.extend(f,r[2]),u=new n.Overlays[i._jsPlumb.instance.getRenderMode()][e](f)):u=r.constructor==String?new n.Overlays[i._jsPlumb.instance.getRenderMode()][r]({component:i,_jsPlumb:i._jsPlumb.instance}):r;i._jsPlumb.overlays.push(u)},b=function(t,i){var f=t.defaultOverlayKeys||[],r=i.overlays,o=function(i){return t._jsPlumb.instance.Defaults[i]||n.Defaults[i]||[]},u,e;for(r||(r=[]),u=0,e=f.length;u<e;u++)r.unshift.apply(r,o(f[u]));return r},k=window.OverlayCapableJsPlumbUIComponent=function(n){var t,i,r,f,e;if(u.apply(this,arguments),this._jsPlumb.overlays=[],t=b(this,n),t)for(i=0,r=t.length;i<r;i++)y(this,t[i]);n.label&&(f=n.labelLocation||this.defaultLabelLocation||.5,e=n.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle,this._jsPlumb.overlays.push(v(this,{label:n.label,location:f,labelStyle:e})));this.setListenerComponent=function(n){if(this._jsPlumb)for(var t=0;t<this._jsPlumb.overlays.length;t++)this._jsPlumb.overlays[t].setListenerComponent(n)}};jsPlumbUtil.extend(k,u,{applyType:function(n,t){if(this.removeAllOverlays(t),n.overlays)for(var i=0,r=n.overlays.length;i<r;i++)this.addOverlay(n.overlays[i],!0)},setHover:function(n){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged())for(var t=0,i=this._jsPlumb.overlays.length;t<i;t++)this._jsPlumb.overlays[t][n?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)},addOverlay:function(n,t){y(this,n);t||this.repaint()},getOverlay:function(n){var t=a(this,n);return t>=0?this._jsPlumb.overlays[t]:null},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(n){var t=this.getOverlay(n);t&&t.hide()},hideOverlays:function(){for(var n=0,t=this._jsPlumb.overlays.length;n<t;n++)this._jsPlumb.overlays[n].hide()},showOverlay:function(n){var t=this.getOverlay(n);t&&t.show()},showOverlays:function(){for(var n=0,t=this._jsPlumb.overlays.length;n<t;n++)this._jsPlumb.overlays[n].show()},removeAllOverlays:function(n){for(var t=0,i=this._jsPlumb.overlays.length;t<i;t++)this._jsPlumb.overlays[t].cleanup&&this._jsPlumb.overlays[t].cleanup();this._jsPlumb.overlays.splice(0,this._jsPlumb.overlays.length);this._jsPlumb.overlayPositions=null;n||this.repaint()},removeOverlay:function(n){var t=a(this,n),i;t!=-1&&(i=this._jsPlumb.overlays[t],i.cleanup&&i.cleanup(),this._jsPlumb.overlays.splice(t,1),this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[n])},removeOverlays:function(){for(var n=0,t=arguments.length;n<t;n++)this.removeOverlay(arguments[n])},moveParent:function(n){this.bgCanvas&&(this.bgCanvas.parentNode.removeChild(this.bgCanvas),n.appendChild(this.bgCanvas));this.canvas.parentNode.removeChild(this.canvas);n.appendChild(this.canvas);for(var t=0;t<this._jsPlumb.overlays.length;t++)this._jsPlumb.overlays[t].isAppendedAtTopLevel&&(this._jsPlumb.overlays[t].canvas.parentNode.removeChild(this._jsPlumb.overlays[t].canvas),n.appendChild(this._jsPlumb.overlays[t].canvas))},getLabel:function(){var n=this.getOverlay(e);return n!=null?n.getLabel():null},getLabelOverlay:function(){return this.getOverlay(e)},setLabel:function(n){var t=this.getOverlay(e),i;t?n.constructor==String||n.constructor==Function?t.setLabel(n):(n.label&&t.setLabel(n.label),n.location&&t.setLocation(n.location)):(i=n.constructor==String||n.constructor==Function?{label:n}:n,t=v(this,i),this._jsPlumb.overlays.push(t));this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(){for(var n=0;n<this._jsPlumb.overlays.length;n++)this._jsPlumb.overlays[n].cleanup(),this._jsPlumb.overlays[n].destroy();this._jsPlumb.overlays.length=0;this._jsPlumb.overlayPositions=null},setVisible:function(n){this[n?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(n,t){this._jsPlumb.overlayPositions=this._jsPlumb.overlayPositions||{};this._jsPlumb.overlayPositions[n.id]=t},getAbsoluteOverlayPosition:function(n){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[n.id]:null}});var p=0,d=function(){var n=p+1;return p++,n},h=window.jsPlumbInstance=function(i){var bt,y,gi,ri,ui,nr,fi,ei,ot,oi,hi,ir,pt,wt,ht,ct,rr,ci;this.Defaults={Anchor:"Bottom",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fillStyle:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{lineWidth:4,strokeStyle:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"};i&&n.extend(this.Defaults,i);this.logEnabled=this.Defaults.LogEnabled;this._connectionTypes={};this._endpointTypes={};jsPlumbUtil.EventGenerator.apply(this);var f=this,li=d(),ur=f.bind,ai={},lt=1,h=function(n){var t=f.getDOMElement(n);return{el:t,id:jsPlumbUtil.isString(n)&&t==null?n:c(t)}};this.getInstanceIndex=function(){return li};this.setZoom=function(n,t){return jsPlumbUtil.oldIE||(lt=n,f.fire("zoom",lt),t&&f.repaintEverything()),!jsPlumbUtil.oldIE};this.getZoom=function(){return lt};for(bt in this.Defaults)ai[bt]=this.Defaults[bt];this.setContainer=function(n){var t,r,i;for(n=this.getDOMElement(n),this.select().each(function(t){t.moveParent(n)}),this.selectEndpoints().each(function(t){t.moveParent(n)}),y=n,t=function(n,t){var i=t.srcElement||t.target,r=(i&&i.parentNode?i.parentNode._jsPlumb:null)||(i?i._jsPlumb:null)||(i&&i.parentNode&&i.parentNode.parentNode?i.parentNode.parentNode._jsPlumb:null);r&&(r.fire(n,r,t),f.fire(n,r,t))},r=function(n){f.on(y,n,"._jsPlumb_connector, ._jsPlumb_connector > *",function(i){t(n,i)});f.on(y,n,"._jsPlumb_endpoint, ._jsPlumb_endpoint > *, ._jsPlumb_endpoint svg *",function(i){t(n,i)});f.on(y,n,"._jsPlumb_overlay, ._jsPlumb_overlay *",function(i){t(n,i)})},i=0;i<l.length;i++)r(l[i])};this.getContainer=function(){return y};this.bind=function(n,t){"ready"===n&&kt?t():ur.apply(f,[n,t])};f.importDefaults=function(n){for(var t in n)f.Defaults[t]=n[t];return n.Container&&f.setContainer(n.Container),f};f.restoreDefaults=function(){return f.Defaults=n.extend({},ai),f};var vi=null,kt=!1,p=[],e={},w={},a={},s={},dt={},nt={},yi=!1,v=[],tt=!1,b=null,pi=this.Defaults.Scope,gt=null,fr=1,ut=function(){return""+fr++},er=function(n,t){y?y.appendChild(n):t?this.getDOMElement(t).appendChild(n):this.appendToRoot(n)}.bind(this),it=function(n,t,i,u){var o,e,h,s,l;if(!jsPlumbAdapter.headless&&!tt){if(o=c(n),e=f.dragManager.getElementsForDraggable(o),i==null&&(i=r()),h=st({elId:o,offset:t,recalc:!1,timestamp:i}),e)for(s in e)st({elId:e[s].id,offset:{left:h.o.left+e[s].offset.left,top:h.o.top+e[s].offset.top},recalc:!1,timestamp:i});if(f.anchorManager.redraw(o,t,i,null,u),e)for(l in e)f.anchorManager.redraw(e[l].id,t,i,e[l].offset,u,!0)}},wi=function(n,i){var u=null,r,e,s,o,h;if(t.isArray(n))for(u=[],o=0,h=n.length;o<h;o++)r=f.getElementObject(n[o]),s=f.getDOMElement(r),e=f.getAttribute(s,"id"),u.push(i.apply(f,[s,e]));else r=f.getDOMElement(n),e=f.getId(r),u=i.apply(f,[r,e]);return u},ft=function(n){return w[n]},bi=function(i,r,u,e){var v,o,l,a;if(!jsPlumbAdapter.headless&&(v=r==null?!1:r,v&&n.isDragSupported(i,f)&&!n.isAlreadyDraggable(i,f))){o=u||f.Defaults.DragOptions;o=n.extend({},o);var y=n.dragEvents.drag,p=n.dragEvents.stop,w=n.dragEvents.start,d=f.getDOMElement(i),b=f.dragManager.getDragAncestor(d),k={left:0,top:0},s=k,h=!1;si(e,i);o[w]=t.wrap(o[w],function(){return s=b!=null?jsPlumbAdapter.getOffset(b,f):k,f.setHoverSuspended(!0),f.select({source:i}).addClass(f.elementDraggingClass+" "+f.sourceElementDraggingClass,!0),f.select({target:i}).addClass(f.elementDraggingClass+" "+f.targetElementDraggingClass,!0),f.setConnectionBeingDragged(!0),o.canDrag?u.canDrag():void 0},!1);o[y]=t.wrap(o[y],function(){var n=f.getUIPosition(arguments,f.getZoom());n.left+=s.left;n.top+=s.top;it(i,n,null,!0);h&&f.addClass(i,"jsPlumb_dragged");h=!0});o[p]=t.wrap(o[p],function(){var n=f.getUIPosition(arguments,f.getZoom(),!0);it(i,n);h=!1;f.removeClass(i,"jsPlumb_dragged");f.setHoverSuspended(!1);f.select({source:i}).removeClass(f.elementDraggingClass+" "+f.sourceElementDraggingClass,!0);f.select({target:i}).removeClass(f.elementDraggingClass+" "+f.targetElementDraggingClass,!0);f.setConnectionBeingDragged(!1);f.dragManager.dragEnded(i)});l=c(i);nt[l]=!0;a=nt[l];o.disabled=a==null?!1:!a;f.initDraggable(i,o);f.dragManager.register(i)}},or=function(n,t){for(var i,u=n.scope.split(/\s/),f=t.scope.split(/\s/),r=0;r<u.length;r++)for(i=0;i<f.length;i++)if(f[i]==u[r])return!0;return!1},sr=function(i,r){var u=n.extend({},i),e,o;if(r&&n.extend(u,r),u.source&&(u.source.endpoint?u.sourceEndpoint=u.source:u.source=f.getDOMElement(u.source)),u.target&&(u.target.endpoint?u.targetEndpoint=u.target:u.target=f.getDOMElement(u.target)),i.uuids&&(u.sourceEndpoint=ft(i.uuids[0]),u.targetEndpoint=ft(i.uuids[1])),u.sourceEndpoint&&u.sourceEndpoint.isFull()){t.log(f,"could not add connection; source endpoint is full");return}if(u.targetEndpoint&&u.targetEndpoint.isFull()){t.log(f,"could not add connection; target endpoint is full");return}if(!u.type&&u.sourceEndpoint&&(u.type=u.sourceEndpoint.connectionType),u.sourceEndpoint&&u.sourceEndpoint.connectorOverlays)for(u.overlays=u.overlays||[],e=0,o=u.sourceEndpoint.connectorOverlays.length;e<o;e++)u.overlays.push(u.sourceEndpoint.connectorOverlays[e]);!u["pointer-events"]&&u.sourceEndpoint&&u.sourceEndpoint.connectorPointerEvents&&(u["pointer-events"]=u.sourceEndpoint.connectorPointerEvents);var h=function(t,i){var u=n.extend({},t);for(var r in i)i[r]&&(u[r]=i[r]);return u},l=function(n,t,i){return f.addEndpoint(n,h(t,{anchor:u.anchors?u.anchors[i]:u.anchor,endpoint:u.endpoints?u.endpoints[i]:u.endpoint,paintStyle:u.endpointStyles?u.endpointStyles[i]:u.endpointStyle,hoverPaintStyle:u.endpointHoverStyles?u.endpointHoverStyles[i]:u.endpointHoverStyle}))},s=function(n,t,i){var e,r,f;if(u[n]&&!u[n].endpoint&&!u[n+"Endpoint"]&&!u.newConnection&&(e=c(u[n]),r=i[e],r)){if(!r.enabled||(f=r.endpoint!=null&&r.endpoint._jsPlumb?r.endpoint:l(u[n],r.def,t),r.uniqueEndpoint&&(r.endpoint=f),f.isFull()))return!1;u[n+"Endpoint"]=f;f._doNotDeleteOnDetach=!1;f._deleteOnDetach=!0}};if(s("source",0,this.sourceEndpointDefinitions)!==!1)return s("target",1,this.targetEndpointDefinitions)===!1?void 0:(u.sourceEndpoint&&u.targetEndpoint&&(or(u.sourceEndpoint,u.targetEndpoint)||(u=null)),u)}.bind(f),ni=function(n){var i=f.Defaults.ConnectionType||f.getDefaultConnectionType(),t;return n._jsPlumb=f,n.newConnection=ni,n.newEndpoint=ti,n.endpointsByUUID=w,n.endpointsByElement=e,n.finaliseConnection=ki,t=new i(n),t.id="con_"+ut(),t.isDetachable()&&(t.endpoints[0].initDraggable(),t.endpoints[1].initDraggable()),t},ki=f.finaliseConnection=function(n,t,i,r){if(t=t||{},n.suspendedEndpoint||p.push(n),n.endpoints[0].isTemporarySource=!1,(n.suspendedEndpoint==null||r)&&f.anchorManager.newConnection(n),it(n.source),!t.doNotFireConnectionEvent&&t.fireEvent!==!1){var u={connection:n,source:n.source,target:n.target,sourceId:n.sourceId,targetId:n.targetId,sourceEndpoint:n.endpoints[0],targetEndpoint:n.endpoints[1]};f.fire("connection",u,i)}},ti=function(t,i){var o=f.Defaults.EndpointType||n.Endpoint,r=n.extend({},t),u;return r._jsPlumb=f,r.newConnection=ni,r.newEndpoint=ti,r.endpointsByUUID=w,r.endpointsByElement=e,r.fireDetachEvent=ui,r.elementId=i||c(r.source),u=new o(r),u.id="ep_"+ut(),si(r.elementId,r.source),jsPlumbAdapter.headless||f.dragManager.endpointAdded(r.source,i),u},ii=function(n,t,i){var r=e[n],u,o,f,s,h;if(r&&r.length)for(u=0,o=r.length;u<o;u++){for(f=0,s=r[u].connections.length;f<s;f++)if(h=t(r[u].connections[f]),h)return;i&&i(r[u])}},hr=function(n,t){return wi(n,function(n,i){nt[i]=t;this.isDragSupported(n)&&this.setElementDraggable(n,t)})},di=function(n,t,i){var r,u;t=t==="block";r=null;i&&(r=t?function(n){n.setVisible(!0,!0,!0)}:function(n){n.setVisible(!1,!0,!0)});u=h(n);ii(u.id,function(n){if(t&&i){var r=n.sourceId===u.id?1:0;n.endpoints[r].isVisible()&&n.setVisible(!0)}else n.setVisible(t)},r)},cr=function(n){return wi(n,function(n,t){var i=nt[t]==null?!1:nt[t];return i=!i,nt[t]=i,this.setDraggable(n,i),i}.bind(this))},lr=function(n,t){var i=null;t&&(i=function(n){var t=n.isVisible();n.setVisible(!t)});ii(n,function(n){var t=n.isVisible();n.setVisible(!t)},i)},ar=function(n){var t=s[n];return t?{o:t,s:v[n]}:st({elId:n})},c=function(n,t,i){if(jsPlumbUtil.isString(n))return n;if(n==null)return null;var r=f.getAttribute(n,"id");return r&&r!=="undefined"||(arguments.length==2&&arguments[1]!==undefined?r=t:arguments.length!=1&&(arguments.length!=3||arguments[2])||(r="jsPlumb_"+li+"_"+ut()),i||f.setAttribute(n,"id",r)),r};this.setConnectionBeingDragged=function(n){yi=n};this.isConnectionBeingDragged=function(){return yi};this.connectorClass="_jsPlumb_connector";this.hoverClass="_jsPlumb_hover";this.endpointClass="_jsPlumb_endpoint";this.endpointConnectedClass="_jsPlumb_endpoint_connected";this.endpointFullClass="_jsPlumb_endpoint_full";this.endpointDropAllowedClass="_jsPlumb_endpoint_drop_allowed";this.endpointDropForbiddenClass="_jsPlumb_endpoint_drop_forbidden";this.overlayClass="_jsPlumb_overlay";this.draggingClass="_jsPlumb_dragging";this.elementDraggingClass="_jsPlumb_element_dragging";this.sourceElementDraggingClass="_jsPlumb_source_element_dragging";this.targetElementDraggingClass="_jsPlumb_target_element_dragging";this.endpointAnchorClassPrefix="_jsPlumb_endpoint_anchor";this.hoverSourceClass="_jsPlumb_source_hover";this.hoverTargetClass="_jsPlumb_target_hover";this.dragSelectClass="_jsPlumb_drag_select";this.Anchors={};this.Connectors={svg:{},vml:{}};this.Endpoints={svg:{},vml:{}};this.Overlays={svg:{},vml:{}};this.ConnectorRenderers={};this.SVG="svg";this.VML="vml";this.addEndpoint=function(i,r,u){var o,h,y,l,p;for(u=u||{},o=n.extend({},u),n.extend(o,r),o.endpoint=o.endpoint||f.Defaults.Endpoint,o.paintStyle=o.paintStyle||f.Defaults.EndpointStyle,h=[],y=t.isArray(i)||i.length!=null&&!t.isString(i)?i:[i],l=0,p=y.length;l<p;l++){o.source=f.getDOMElement(y[l]);yt(o.source);var a=c(o.source),s=ti(o,a),w=si(a,o.source).info.o;t.addToList(e,a,s);tt||s.paint({anchorLoc:s.anchor.compute({xy:[w.left,w.top],wh:v[a],element:s,timestamp:b}),timestamp:b});h.push(s);s._doNotDeleteOnDetach=!0}return h.length==1?h[0]:h};this.addEndpoints=function(n,i,r){for(var u,e=[],o=0,s=i.length;o<s;o++)u=f.addEndpoint(n,i[o],r),t.isArray(u)?Array.prototype.push.apply(e,u):e.push(u);return e};this.animate=function(i,r,u){u=u||{};var h=f.getElementObject(i),l=f.getDOMElement(i),e=c(l),o=n.animEvents.step,s=n.animEvents.complete;u[o]=t.wrap(u[o],function(){f.revalidate(e)});u[s]=t.wrap(u[s],function(){f.revalidate(e)});f.doAnimate(h,r,u)};this.checkCondition=function(n,i){var r=f.getListener(n),e=!0,u,o;if(r&&r.length>0)try{for(u=0,o=r.length;u<o;u++)e=e&&r[u](i)}catch(s){t.log(f,"cannot check condition ["+n+"]"+s)}return e};this.connect=function(n,t){var i=sr(n,t),r;if(i){if(i.source==null&&i.sourceEndpoint==null){jsPlumbUtil.log("Cannot establish connection - source does not exist");return}if(i.target==null&&i.targetEndpoint==null){jsPlumbUtil.log("Cannot establish connection - target does not exist");return}yt(i.source);r=ni(i);ki(r,i)}return r};gi=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}];ri=function(t,i,r,u){var f,o=gi[r],l=t[o.elId],v=t[o.el],s,e,a=t.endpoints[r],h={index:r,originalSourceId:r===0?l:t.sourceId,newSourceId:t.sourceId,originalTargetId:r==1?l:t.targetId,newTargetId:t.targetId,connection:t};if(i.constructor==n.Endpoint)f=i,f.addConnection(t);else if(s=c(i),e=this[o.epDefs][s],s===t[o.elId])f=null;else if(e){if(!e.enabled)return;f=e.endpoint!=null&&e.endpoint._jsPlumb?e.endpoint:this.addEndpoint(i,e.def);e.uniqueEndpoint&&(e.endpoint=f);f._doNotDeleteOnDetach=!1;f._deleteOnDetach=!0;f.addConnection(t)}else f=t.makeEndpoint(r===0,i,s),f._doNotDeleteOnDetach=!1,f._deleteOnDetach=!0;return f!=null&&(a.detachFromConnection(t),t.endpoints[r]=f,t[o.el]=f.element,t[o.elId]=f.elementId,h[r===0?"newSourceId":"newTargetId"]=f.elementId,nr(h),u||t.repaint()),h}.bind(this);this.setSource=function(n,t,i){var r=ri(n,t,0,i);this.anchorManager.sourceChanged(r.originalSourceId,r.newSourceId,n)};this.setTarget=function(n,t,i){var r=ri(n,t,1,i);this.anchorManager.updateOtherEndpoint(r.originalSourceId,r.originalTargetId,r.newTargetId,n)};this.deleteEndpoint=function(n,t){var i=typeof n=="string"?w[n]:n;return i&&f.deleteObject({endpoint:i,dontUpdateHover:t}),f};this.deleteEveryEndpoint=function(){var u=f.setSuspendDrawing(!0),i,n,t,r;for(i in e)if(n=e[i],n&&n.length)for(t=0,r=n.length;t<r;t++)f.deleteEndpoint(n[t],!0);return e={},a={},w={},f.anchorManager.reset(),f.dragManager.reset(),u||f.setSuspendDrawing(!1),f};ui=function(n,t,i){var u=f.Defaults.ConnectionType||f.getDefaultConnectionType(),e=n.constructor==u,r=e?{connection:n,source:n.source,target:n.target,sourceId:n.sourceId,targetId:n.targetId,sourceEndpoint:n.endpoints[0],targetEndpoint:n.endpoints[1]}:n;t&&f.fire("connectionDetached",r,i);f.anchorManager.connectionDetached(r)};nr=f.fireMoveEvent=function(n,t){f.fire("connectionMoved",n,t)};this.unregisterEndpoint=function(n){var t,i,u,r,o;n._jsPlumb.uuid&&(w[n._jsPlumb.uuid]=null);f.anchorManager.deleteEndpoint(n);for(t in e){if(i=e[t],i){for(u=[],r=0,o=i.length;r<o;r++)i[r]!=n&&u.push(i[r]);e[t]=u}e[t].length<1&&delete e[t]}};this.detach=function(){var i,u,o;if(arguments.length!==0){var h=f.Defaults.ConnectionType||f.getDefaultConnectionType(),s=arguments[0].constructor==h,r=arguments.length==2?s?arguments[1]||{}:arguments[0]:arguments[0],e=r.fireEvent!==!1,l=r.forceDetach,t=s?arguments[0]:r.connection;t?(l||jsPlumbUtil.functionChain(!0,!1,[[t.endpoints[0],"isDetachAllowed",[t]],[t.endpoints[1],"isDetachAllowed",[t]],[t,"isDetachAllowed",[t]],[f,"checkCondition",["beforeDetach",t]]]))&&t.endpoints[0].detach(t,!1,!0,e):(i=n.extend({},r),i.uuids?ft(i.uuids[0]).detachFrom(ft(i.uuids[1]),e):i.sourceEndpoint&&i.targetEndpoint?i.sourceEndpoint.detachFrom(i.targetEndpoint):(u=c(f.getDOMElement(i.source)),o=c(f.getDOMElement(i.target)),ii(u,function(n){(n.sourceId==u&&n.targetId==o||n.targetId==u&&n.sourceId==o)&&f.checkCondition("beforeDetach",n)&&n.endpoints[0].detach(n,!1,!0,e)})))}};this.detachAllConnections=function(n,t){var u,i,r,o;if(t=t||{},n=f.getDOMElement(n),u=c(n),i=e[u],i&&i.length)for(r=0,o=i.length;r<o;r++)i[r].detachAll(t.fireEvent!==!1);return f};this.detachEveryConnection=function(n){return n=n||{},f.doWhileSuspended(function(){var r,t,i,u;for(r in e)if(t=e[r],t&&t.length)for(i=0,u=t.length;i<u;i++)t[i].detachAll(n.fireEvent!==!1);p.length=0}),f};this.deleteObject=function(n){var t={endpoints:{},connections:{},endpointCount:0,connectionCount:0},c=n.fireEvent!==!1,u=n.deleteAttachedObjects!==!1,e=function(i){if(i!=null&&t.connections[i.id]==null&&(n.dontUpdateHover||i._jsPlumb==null||i.setHover(!1),t.connections[i.id]=i,t.connectionCount++,u))for(var r=0;r<i.endpoints.length;r++)i.endpoints[r]._deleteOnDetach&&o(i.endpoints[r])},o=function(i){var r,f;if(i!=null&&t.endpoints[i.id]==null&&(n.dontUpdateHover||i._jsPlumb==null||i.setHover(!1),t.endpoints[i.id]=i,t.endpointCount++,u))for(r=0;r<i.connections.length;r++)f=i.connections[r],e(f)},s,i,h,r;n.connection?e(n.connection):o(n.endpoint);for(s in t.connections)i=t.connections[s],i._jsPlumb&&(jsPlumbUtil.removeWithFunction(p,function(n){return i.id==n.id}),ui(i,c,n.originalEvent),i.endpoints[0].detachFromConnection(i),i.endpoints[1].detachFromConnection(i),i.cleanup(),i.destroy());for(h in t.endpoints)r=t.endpoints[h],r._jsPlumb&&(f.unregisterEndpoint(r),r.cleanup(),r.destroy());return t};this.draggable=function(n,t){var r,u,i;if(typeof n=="object"&&n.length)for(r=0,u=n.length;r<u;r++)i=h(n[r]),i.el&&bi(i.el,!0,t,i.id);else i=h(n),i.el&&bi(i.el,!0,t,i.id);return f};var vr=function(n,t,i,r){for(var u=0,f=n.length;u<f;u++)n[u][t].apply(n[u],i);return r(n)},yr=function(n,t,i){for(var u=[],r=0,f=n.length;r<f;r++)u.push([n[r][t].apply(n[r],i),n[r]]);return u},rt=function(n,t,i){return function(){return vr(n,t,arguments,i)}},at=function(n,t){return function(){return yr(n,t,arguments)}},k=function(n,t){var i=[],r,u;if(n)if(typeof n=="string"){if(n==="*")return n;i.push(n)}else if(t)i=n;else if(n.length)for(r=0,u=n.length;r<u;r++)i.push(h(n[r]).id);else i.push(h(n).id);return i},g=function(n,t,i){return n==="*"?!0:n.length>0?jsPlumbUtil.indexOf(n,t)!=-1:!i};this.getConnections=function(n,t){var u,o,i;n?n.constructor==String&&(n={scope:n}):n={};var s=n.scope||f.getDefaultScope(),e=k(s,!0),h=k(n.source),c=k(n.target),r=!t&&e.length>1?{}:[],l=function(n,i){if(!t&&e.length>1){var u=r[n];u==null&&(u=r[n]=[]);u.push(i)}else r.push(i)};for(u=0,o=p.length;u<o;u++)i=p[u],g(e,i.scope)&&g(h,i.sourceId)&&g(c,i.targetId)&&l(i.scope,i);return r};var pr=function(n,t){return function(i){for(var r=0,u=n.length;r<u;r++)i(n[r]);return t(n)}},wr=function(n){return function(t){return n[t]}},tr=function(n,t){for(var u={length:n.length,each:pr(n,t),get:wr(n)},f=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],e=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"],i=0,r=f.length;i<r;i++)u[f[i]]=rt(n,f[i],t);for(i=0,r=e.length;i<r;i++)u[e[i]]=at(n,e[i]);return u},et=function(t){var i=tr(t,et);return n.extend(i,{setDetachable:rt(t,"setDetachable",et),setReattach:rt(t,"setReattach",et),setConnector:rt(t,"setConnector",et),detach:function(){for(var n=0,i=t.length;n<i;n++)f.detach(t[n])},isDetachable:at(t,"isDetachable"),isReattach:at(t,"isReattach")})},vt=function(t){var i=tr(t,vt);return n.extend(i,{setEnabled:rt(t,"setEnabled",vt),setAnchor:rt(t,"setAnchor",vt),isEnabled:at(t,"isEnabled"),detachAll:function(){for(var n=0,i=t.length;n<i;n++)t[n].detachAll()},remove:function(){for(var n=0,i=t.length;n<i;n++)f.deleteObject({endpoint:t[n]})}})};this.select=function(n){return n=n||{},n.scope=n.scope||"*",et(n.connections||f.getConnections(n,!0))};this.selectEndpoints=function(n){var t,r,h,i,c,l;n=n||{};n.scope=n.scope||"*";var u=!n.element&&!n.source&&!n.target,a=u?"*":k(n.element),f=u?"*":k(n.source),o=u?"*":k(n.target),v=k(n.scope,!0),s=[];for(t in e){var y=g(a,t,!0),p=g(f,t,!0),w=f!="*",b=g(o,t,!0),d=o!="*";if(y||p||b)n:for(r=0,h=e[t].length;r<h;r++)if(i=e[t][r],g(v,i.scope,!0)){if(c=w&&f.length>0&&!i.isSource,l=d&&o.length>0&&!i.isTarget,c||l)continue n;s.push(i)}}return vt(s)};this.getAllConnections=function(){return p};this.getDefaultScope=function(){return pi};this.getEndpoint=ft;this.getEndpoints=function(n){return e[h(n).id]};this.getDefaultEndpointType=function(){return n.Endpoint};this.getDefaultConnectionType=function(){return n.Connection};this.getId=c;this.getOffset=function(n){return st({elId:n}).o};this.appendElement=er;fi=!1;this.isHoverSuspended=function(){return fi};this.setHoverSuspended=function(n){fi=n};ei=function(n){return function(){return jsPlumbAdapter.isRenderModeAvailable(n)}};this.isSVGAvailable=ei("svg");this.isVMLAvailable=ei("vml");this.hide=function(n,t){return di(n,"none",t),f};this.idstamp=ut;this.connectorsInitialized=!1;ot=[];oi=["svg","vml"];this.registerConnectorType=function(n,t){ot.push([n,t])};var yt=function(n){if(!y&&n){var t=f.getDOMElement(n);t.offsetParent&&f.setContainer(t.offsetParent)}},br=function(){f.Defaults.Container&&f.setContainer(f.Defaults.Container)},si=f.manage=function(n,t){return a[n]||(a[n]={el:t,endpoints:[],connections:[]},a[n].info=st({elId:n,timestamp:b})),a[n]},kr=function(n){delete a[n]},st=this.updateOffset=function(n){var r=n.timestamp,u=n.recalc,e=n.offset,t=n.elId,i;return(tt&&!r&&(r=b),!u&&r&&r===dt[t])?{o:n.offset||s[t],s:v[t]}:(u||!e&&s[t]==null?(i=a[t]?a[t].el:null,i!=null&&(v[t]=f.getSize(i),s[t]=o(i,f),dt[t]=r)):(s[t]=e||s[t],v[t]==null&&(i=a[t].el,i!=null&&(v[t]=f.getSize(i))),dt[t]=r),s[t]&&!s[t].right&&(s[t].right=s[t].left+v[t][0],s[t].bottom=s[t].top+v[t][1],s[t].width=v[t][0],s[t].height=v[t][1],s[t].centerx=s[t].left+s[t].width/2,s[t].centery=s[t].top+s[t].height/2),{o:s[t],s:v[t]})};this.init=function(){var r=function(t,i,r){n.Connectors[t][i]=function(){r.apply(this,arguments);n.ConnectorRenderers[t].apply(this,arguments)};jsPlumbUtil.extend(n.Connectors[t][i],[r,n.ConnectorRenderers[t]])},t,i;if(!n.connectorsInitialized){for(t=0;t<ot.length;t++)for(i=0;i<oi.length;i++)r(oi[i],ot[t][1],ot[t][0]);n.connectorsInitialized=!0}kt||(br(),f.anchorManager=new n.AnchorManager({jsPlumbInstance:f}),f.setRenderMode(f.Defaults.RenderMode),kt=!0,f.fire("ready",f))}.bind(this);this.log=vi;this.jsPlumbUIComponent=u;this.makeAnchor=function(){var e,s=function(t,i){if(n.Anchors[t])return new n.Anchors[t](i);if(!f.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+t+"'"};},o;if(arguments.length===0)return null;var i=arguments[0],u=arguments[1],h=arguments[2],r=null;return i.compute&&i.getOrientation?i:(typeof i=="string"?r=s(arguments[0],{elementId:u,jsPlumbInstance:f}):t.isArray(i)&&(t.isArray(i[0])||t.isString(i[0])?i.length==2&&t.isObject(i[1])?t.isString(i[0])?(e=n.extend({elementId:u,jsPlumbInstance:f},i[1]),r=s(i[0],e)):(e=n.extend({elementId:u,jsPlumbInstance:f,anchors:i[0]},i[1]),r=new n.DynamicAnchor(e)):r=new n.DynamicAnchor({anchors:i,selector:null,elementId:u,jsPlumbInstance:f}):(o={x:i[0],y:i[1],orientation:i.length>=4?[i[2],i[3]]:[0,0],offsets:i.length>=6?[i[4],i[5]]:[0,0],elementId:u,jsPlumbInstance:f,cssClass:i.length==7?i[6]:null},r=new n.Anchor(o),r.clone=function(){return new n.Anchor(o)})),r.id||(r.id="anchor_"+ut()),r)};this.makeAnchors=function(i,r,u){for(var o=[],e=0,s=i.length;e<s;e++)typeof i[e]=="string"?o.push(n.Anchors[i[e]]({elementId:r,jsPlumbInstance:u})):t.isArray(i[e])&&o.push(f.makeAnchor(i[e],r,u));return o};this.makeDynamicAnchor=function(t,i){return new n.DynamicAnchor({anchors:t,selector:i,elementId:null,jsPlumbInstance:f})};this.targetEndpointDefinitions={};hi=function(n,t,i){n.paintStyle=n.paintStyle||i.Defaults.EndpointStyles[t]||i.Defaults.EndpointStyle;n.hoverPaintStyle=n.hoverPaintStyle||i.Defaults.EndpointHoverStyles[t]||i.Defaults.EndpointHoverStyle;n.anchor=n.anchor||i.Defaults.Anchors[t]||i.Defaults.Anchor;n.endpoint=n.endpoint||i.Defaults.Endpoints[t]||i.Defaults.Endpoint};this.sourceEndpointDefinitions={};ir=function(n,t,i,r,u){for(var s=n.target||n.srcElement,f=!1,o=r.getSelector(t,i),e=0;e<o.length;e++)if(o[e]==s){f=!0;break}return u?!f:f};this.makeTarget=function(i,r,e){var s=n.extend({_jsPlumb:this},e),c,v;n.extend(s,r);hi(s,1,this);var y=s.scope||f.Defaults.Scope,b=!(s.deleteEndpointsOnDetach===!1),p=s.maxConnections||-1,l=s.onMaxConnections,w=function(i){var r=h(i),c=r.id,w=new u(s),e=n.extend({},s.dropOptions||{}),a,b,v;yt(c);a={def:s,uniqueEndpoint:s.uniqueEndpoint,maxConnections:p,enabled:!0};r.el._jsPlumbTarget=a;this.targetEndpointDefinitions[c]=a;b=s._jsPlumb.EndpointDropHandler({jsPlumb:f,enabled:function(){return r.el._jsPlumbTarget.enabled},isFull:function(n){var u=f.select({target:c}).length,t=r.el._jsPlumbTarget,i=t.maxConnections>0&&u>=t.maxConnections;return i&&l&&l({element:r.el,connection:jpc},n),i},element:r.el,elementId:c,isSource:!1,isTarget:!0,addClass:function(n){f.addClass(r.el,n)},removeClass:function(n){f.removeClass(r.el,n)},onDrop:function(n){var t=n.endpoints[0];t.anchor.locked=!1},isDropAllowed:function(){return w.isDropAllowed.apply(w,arguments)},getEndpoint:function(n){var i=f.getElementObject(r.el),u=r.el._jsPlumbTarget,t=u.endpoint;if((t==null||t._jsPlumb==null)&&(t=f.addEndpoint(i,s)),s.uniqueEndpoint&&(u.endpoint=t),t._doNotDeleteOnDetach=!1,t._deleteOnDetach=!0,n.isDetachable()&&t.initDraggable(),t.anchor.positionFinder!=null){var h=f.getUIPosition(arguments,this.getZoom()),c=o(i,this),l=f.getSize(i),e=t.anchor.positionFinder(h,c,l,t.anchor.constructorParams);t.anchor.x=e[0];t.anchor.y=e[1]}return t}});v=n.dragEvents.drop;e.scope=e.scope||y;e[v]=t.wrap(e[v],b);s.allowLoopback===!1&&(e.canDrop=function(n){var t=n.getDragElement()._jsPlumbRelatedElement;return t!=r.el});this.initDroppable(this.getElementObject(r.el),e,"internal")}.bind(this),a=i.length&&i.constructor!=String?i:[i];for(c=0,v=a.length;c<v;c++)w(a[c]);return this};this.unmakeTarget=function(t,i){var r=h(t);return n.destroyDroppable(r.el),i||delete this.targetEndpointDefinitions[r.id],this};this.makeSource=function(i,r,u){var e=n.extend({},u),s,v;n.extend(e,r);hi(e,0,this);var c=e.maxConnections||1,l=e.onMaxConnections,p=function(i){var a=i.id,u=this.getElementObject(i.el),nt=this.getDOMElement(u),p=function(){return e.parent==null?null:e.parent==="parent"?i.el.parentNode:f.getDOMElement(e.parent)},h=e.parent!=null?this.getId(p()):a,w;yt(h);this.sourceEndpointDefinitions[h]={def:e,uniqueEndpoint:e.uniqueEndpoint,maxConnections:c,enabled:!0};var b=n.dragEvents.stop,k=n.dragEvents.drag,s=n.extend({},e.dragOptions||{}),d=s.drag,g=s.stop,r=null,v=!1;s.scope=s.scope||e.scope;s[k]=t.wrap(s[k],function(){d&&d.apply(this,arguments);v=!1});s[b]=t.wrap(s[b],function(){var u,c;if(g&&g.apply(this,arguments),this.currentlyDragging=!1,r._jsPlumb!=null){var l=e.anchor||this.Defaults.Anchor,f=r.anchor,v=r.connections[0],n=this.makeAnchor(l,a,this),s=r.element;if(n.positionFinder!=null){var t=o(s,this),i=this.getSize(s),w={left:t.left+f.x*i[0],top:t.top+f.y*i[1]},h=n.positionFinder(w,t,i,n.constructorParams);n.x=h[0];n.y=h[1]}r.setAnchor(n,!0);e.parent&&(u=p(),u&&(c=e.container||y,r.setElement(u,c)));r.repaint();this.repaint(r.elementId);this.repaint(v.targetId)}}.bind(this));w=function(t){var w=this.getOriginalEvent(t),i,k,d,y;if(t.which!==3&&t.button!==2&&(i=this.sourceEndpointDefinitions[h],a=this.getId(this.getDOMElement(u)),i.enabled)&&(!e.filter||(k=jsPlumbUtil.isString(e.filter)?ir(w,u,e.filter,this,e.filterExclude):e.filter(w,u),k!==!1))){if(d=this.select({source:h}).length,i.maxConnections>=0&&i.uniqueEndpoint&&d>=i.maxConnections)return l&&l({element:u,maxConnections:c},t),!1;var b=jsPlumbAdapter.getPositionOnElement(w,nt,lt),g=b,o={};n.extend(o,e);o.isTemporarySource=!0;o.anchor=[b[0],b[1],0,0];o.dragOptions=s;r=this.addEndpoint(a,o);v=!0;r.endpointWillMoveTo=e.parent?p():null;i.uniqueEndpoint&&(i.endpoint?r.finalEndpoint=i.endpoint:i.endpoint=r);r._doNotDeleteOnDetach=!1;r._deleteOnDetach=!0;y=function(){f.off(r.canvas,"mouseup",y);f.off(u,"mouseup",y);v&&(v=!1,f.deleteEndpoint(r))};f.on(r.canvas,"mouseup",y);f.on(u,"mouseup",y);f.trigger(r.canvas,"mousedown",t);jsPlumbUtil.consume(t)}}.bind(this);this.on(u,"mousedown",w);this.sourceEndpointDefinitions[h].trigger=w;e.filter&&jsPlumbUtil.isString(e.filter)&&f.setDragFilter(u,e.filter)}.bind(this),a=i.length&&i.constructor!=String?i:[i];for(s=0,v=a.length;s<v;s++)p(h(a[s]));return this};this.unmakeSource=function(n,t){var i=h(n),r=this.sourceEndpointDefinitions[i.id].trigger;return r&&f.off(i.el,"mousedown",r),t||delete this.sourceEndpointDefinitions[i.id],this};this.unmakeEverySource=function(){for(var n in this.sourceEndpointDefinitions)f.unmakeSource(n,!0);return this.sourceEndpointDefinitions={},this};pt=function(n,t){var u,i,r;for(t=jsPlumbUtil.isArray(t)?t:[t],u=c(n),i=0;i<t.length;i++)if(r=this[t[i]][u],r)return r.def.scope||this.Defaults.Scope}.bind(this);wt=function(n,t,i){var u,r,f;for(i=jsPlumbUtil.isArray(i)?i:[i],u=c(n),r=0;r<i.length;r++)f=this[i[r]][u],f&&(f.def.scope=t,this.scopeChange!=null&&this.scopeChange(n,u,e[u],t,i[r]))}.bind(this);this.getScope=function(n){return pt(n,["sourceEndpointDefinitions","targetEndpointDefinitions"])};this.getSourceScope=function(n){return pt(n,"sourceEndpointDefinitions")};this.getTargetScope=function(n){return pt(n,"targetEndpointDefinitions")};this.setScope=function(n,t){wt(n,t,["sourceEndpointDefinitions","targetEndpointDefinitions"])};this.setSourceScope=function(n,t){wt(n,t,"sourceEndpointDefinitions")};this.setTargetScope=function(n,t){wt(n,t,"targetEndpointDefinitions")};this.unmakeEveryTarget=function(){for(var n in this.targetEndpointDefinitions)f.unmakeTarget(n,!0);return this.targetEndpointDefinitions={},this};ht=function(n,i,r,u){var f=n=="source"?this.sourceEndpointDefinitions:this.targetEndpointDefinitions,e,c,o,s;if(t.isString(i))f[i].enabled=u?!f[i].enabled:r;else if(i.length)for(e=0,c=i.length;e<c;e++)o=h(i[e]),f[o.id]&&(f[o.id].enabled=u?!f[o.id].enabled:r);else s=h(i).id,f[s].enabled=u?!f[s].enabled:r;return this}.bind(this);ct=function(n,i){return t.isString(n)||!n.length?i.apply(this,[n]):n.length?i.apply(this,[n[0]]):void 0}.bind(this);this.toggleSourceEnabled=function(n){return ht("source",n,null,!0),this.isSourceEnabled(n)};this.setSourceEnabled=function(n,t){return ht("source",n,t)};this.isSource=function(n){return ct(n,function(n){return this.sourceEndpointDefinitions[h(n).id]!=null}.bind(this))};this.isSourceEnabled=function(n){return ct(n,function(n){var t=this.sourceEndpointDefinitions[h(n).id];return t&&t.enabled===!0}.bind(this))};this.toggleTargetEnabled=function(n){return ht("target",n,null,!0),this.isTargetEnabled(n)};this.isTarget=function(n){return ct(n,function(n){return this.targetEndpointDefinitions[h(n).id]!=null}.bind(this))};this.isTargetEnabled=function(n){return ct(n,function(n){var t=this.targetEndpointDefinitions[h(n).id];return t&&t.enabled===!0}.bind(this))};this.setTargetEnabled=function(n,t){return ht("target",n,t)};this.ready=function(n){f.bind("ready",n)};this.repaint=function(n,t,i){if(typeof n=="object"&&n.length)for(var r=0,u=n.length;r<u;r++)it(n[r],t,i);else it(n,t,i);return f};this.revalidate=function(n){var t=f.getId(n);return f.updateOffset({elId:t,recalc:!0}),f.repaint(n)};this.repaintEverything=function(n){var i=r();for(var t in e)f.updateOffset({elId:t,recalc:!0,timestamp:i});for(t in e)it(t,null,i,n);return this};this.removeAllEndpoints=function(n,t){var i=function(n){var u=h(n),s=e[u.id],r,o;if(s)for(r=0,o=s.length;r<o;r++)f.deleteEndpoint(s[r]);if(delete e[u.id],t&&u.el&&u.el.nodeType!=3&&u.el.nodeType!=8)for(r=0,o=u.el.childNodes.length;r<o;r++)i(u.el.childNodes[r])};return i(n),this};this.remove=function(n,t){var i=h(n);return f.doWhileSuspended(function(){f.removeAllEndpoints(i.id,!0);f.dragManager.elementRemoved(i.id);delete f.floatingConnections[i.id];f.anchorManager.clearFor(i.id);f.anchorManager.removeFloatingConnection(i.id)},t===!1),kr(i.id),i.el&&(f.removeElement(i.el),i.el._jsPlumb=null),f};this.reset=function(){f.setSuspendEvents(!0);f.deleteEveryEndpoint();f.unbind();this.targetEndpointDefinitions={};this.sourceEndpointDefinitions={};p.length=0;f.setSuspendEvents(!1)};rr=function(n){n.canvas&&n.canvas.parentNode&&n.canvas.parentNode.removeChild(n.canvas);n.cleanup();n.destroy()};ci=function(n){rr(n)};this.clear=function(){f.select().each(ci);f.selectEndpoints().each(ci);e={};w={}};this.setDefaultScope=function(n){return pi=n,f};this.setDraggable=hr;this.setId=function(n,t,i){var r,o,s,u,h,f;for(jsPlumbUtil.isString(n)?r=n:(n=this.getDOMElement(n),r=this.getId(n)),o=this.getConnections({source:r,scope:"*"},!0),s=this.getConnections({target:r,scope:"*"},!0),t=""+t,i?n=this.getDOMElement(t):(n=this.getDOMElement(r),this.setAttribute(n,"id",t)),e[t]=e[r]||[],u=0,h=e[t].length;u<h;u++)e[t][u].setElementId(t),e[t][u].setReferenceElement(n);delete e[r];this.anchorManager.changeId(r,t);this.dragManager&&this.dragManager.changeId(r,t);a[t]=a[r];delete a[r];f=function(i,r,u){for(var f=0,e=i.length;f<e;f++)i[f].endpoints[r].setElementId(t),i[f].endpoints[r].setReferenceElement(n),i[f][u+"Id"]=t,i[f][u]=n};f(o,0,"source");f(s,1,"target");this.repaint(t)};this.setDebugLog=function(n){vi=n};this.setSuspendDrawing=function(n,t){var i=tt;return tt=n,b=n?(new Date).getTime():null,t&&this.repaintEverything(),i};this.isSuspendDrawing=function(){return tt};this.getSuspendedAt=function(){return b};this.doWhileSuspended=function(n,i){var r=this.isSuspendDrawing();r||this.setSuspendDrawing(!0);try{n()}catch(u){t.log("Function run while suspended failed",u)}r||this.setSuspendDrawing(!1,!i)};this.getOffset=function(n){return s[n]};this.getCachedData=ar;this.timestamp=r;this.setRenderMode=function(t){if(t!==n.SVG&&t!==n.VML)throw new TypeError("Render mode ["+t+"] not supported");return gt=jsPlumbAdapter.setRenderMode(t)};this.getRenderMode=function(){return gt};this.show=function(n,t){return di(n,"block",t),f};this.toggleVisible=lr;this.toggleDraggable=cr;this.addListener=this.bind;jsPlumbAdapter.headless||(f.dragManager=jsPlumbAdapter.getDragManager(f),f.recalculateOffsets=f.dragManager.updateOffsets)};jsPlumbUtil.extend(h,jsPlumbUtil.EventGenerator,{setAttribute:function(n,t,i){this.setAttribute(n,t,i)},getAttribute:function(t,i){return this.getAttribute(n.getDOMElement(t),i)},registerConnectionType:function(t,i){this._connectionTypes[t]=n.extend({},i)},registerConnectionTypes:function(t){for(var i in t)this._connectionTypes[i]=n.extend({},t[i])},registerEndpointType:function(t,i){this._endpointTypes[t]=n.extend({},i)},registerEndpointTypes:function(t){for(var i in t)this._endpointTypes[i]=n.extend({},t[i])},getType:function(n,t){return t==="connection"?this._connectionTypes[n]:this._endpointTypes[n]},setIdChanged:function(n,t){this.setId(n,t,!0)},setParent:function(n,t){var r=this.getElementObject(n),i=this.getDOMElement(r),e=this.getId(i),u=this.getElementObject(t),f=this.getDOMElement(u),o=this.getId(f);i.parentNode.removeChild(i);f.appendChild(i);this.dragManager.setParent(r,e,u,o)},getSize:function(n){return[n.offsetWidth,n.offsetHeight]},getWidth:function(n){return n.offsetWidth},getHeight:function(n){return n.offsetHeight},extend:function(n,t,i){var r;if(i)for(r=0;r<i.length;r++)n[i[r]]=t[i[r]];else for(r in t)n[r]=t[r];return n},floatingConnections:{},getFloatingAnchorIndex:function(n){return n.endpoints[0].isFloating()?0:1}},jsPlumbAdapter);n=new h;typeof window!="undefined"&&(window.jsPlumb=n);n.getInstance=function(n){var t=new h(n);return t.init(),t};typeof define=="function"&&(define("jsplumb",[],function(){return n}),define("jsplumbinstance",[],function(){return n.getInstance()}));typeof exports!="undefined"&&(exports.jsPlumb=n)})();
//# sourceMappingURL=jsPlumb.min.js.map
